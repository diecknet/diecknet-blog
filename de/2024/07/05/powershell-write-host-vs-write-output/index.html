<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Write-Host VS. Write-Output | diecknet</title>
<meta name=keywords content="powershell"><meta name=description content="In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Write-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Write-Host VS. Write-Output"><meta property="og:description" content="In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Write-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Write-Host VS. Write-Output"><meta name=twitter:description content="In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Write-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Write-Host VS. Write-Output","item":"https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Write-Host VS. Write-Output","name":"PowerShell Write-Host VS. Write-Output","description":"In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nWrite-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden.","keywords":["powershell"],"articleBody":"In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nWrite-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden.\nWrite-Host kann die Art und Weise beeinflussen, wie die Daten vom PowerShell Host ausgegeben werden. Zum Beispiel kann mit -ForegroundColor die Textfarbe und mit -BackgroundColor die Hintergrundfarbe angepasst werden. Also wenn ihr ein Skript interaktiv in einer Konsole ausf√ºhrt, dann kann Write-Host durchaus n√ºtzlich sein um eine ansprechendere Ausgabe zu erm√∂glichen. Ein ganz gro√üer Nachteil ist allerdings: Daten die per Write-Host ausgegeben werden, k√∂nnen dann nicht in der Pipeline weiterverarbeitet werden.\nAlso das Ergebnis kann z.B. nicht in eine Variable gespeichert werden:\n1 2 3 4 5 $Variable = Write-Host \"Hallo PowerShell\" # R√ºckgabe: Hallo PowerShell $Variable # = keine sichtbare R√ºckgabe Und auch nicht an andere Cmdlets gepiped werden:\n1 2 Write-Host \"C:\\temp\" | Get-ChildItem # R√ºckgabe: C:\\temp (und nicht der Inhalt von C:\\temp !) Write-Output Write-Output hingegen kann weiterverarbeitet werden:\n1 2 3 4 5 6 $Variable = Write-Output \"Hallo PowerShell\" $Variable # R√ºckgabe: Hallo PowerShell Write-Output \"C:\\temp\" | Get-ChildItem # R√ºckgabe: \u003c Inhalt von C:\\temp ... \u003e Daf√ºr fehlen dann aber die M√∂glichkeiten zur Formatierung, die Write-Host hat.\nWann was verwenden? Es ist vorteilhaft die Unterschiede zwischen Write-Host und Write-Output zu kennen und zu nutzen. Also z.B. wenn ihr in einem Skript die R√ºckgabe von einem ScriptBlock wie z.B. aus einer Schleife in eine Variable speichert, dann w√ºrden Ausgaben per Write-Output h√∂chstwahrscheinlich euer Ergebnis-Array mit unn√∂tigen Eintr√§gen verunreinigen. Wenn ihr dann aber Write-Host verwendet, dann k√∂nnt ihr eine Ausgabe erzeugen, ohne dass diese im Ergebnis-Array landet.\n1 2 3 4 5 6 $Ps1Files = Get-ChildItem *.ps1 -Recurse $Ergebnis = foreach($File in $Ps1Files) { $File.FullName # Das wird an die Schleife ausgegeben Write-Host \"$($File.Name)\" -NoNewLine -ForeGroundColor Yellow Write-Host \" gefunden...\" } Oder wenn ihr ein Skript in Azure Automation ausf√ºhrt, dann landen Ausgaben die per Write-Host erzeugt werden nicht in den Logs. Wenn ihr Skripte f√ºr Azure Automation erzeugt, dann m√ºsst ihr also Write-Output statt Write-Host verwenden.\n1 2 3 4 5 # Azure Automation Beispielcode Write-Output \"Azure Automation verwendet √ºbrigens einen weiteren PowerShell Host\" Get-Host Write-Host \"Ausgaben per Write-Host sind in Azure Automation nicht sichtbar\" Write-Output ist eigentlich optional Wenn ihr jetzt denkt, dass tendenziell Write-Output zu bevorzugen ist: Ihr m√ºsst eigentlich auch nicht mal Write-Output verwenden. Ihr k√∂nnt n√§mlich auch einfach direkt euer gew√ºnschtes Objekt - sei es aus einer Variable oder einem Cmdlet oder sonst wie - im Code referenzieren und dann wird es ausgegeben. Also vorteilhaft ist dann vielleicht nur, dass ein kleines bisschen einfacher ersichtlich ist ‚ÄúHey hier wird ganz bewusst eine Ausgabe im Code erzeugt‚Äù.\n1 2 Write-Output \"Hallo :)\" # R√ºckgabe: Hallo :) Hinweis zu Output Streams Abgesehen von Write-Output und Write-Host gibt es auch noch weitere Ausgabe Cmdlets, wie z.B. Write-Information, Write-Error, Write-Warning und so weiter. Ihr k√∂nntet damit Ausgaben erzeugen und sie in verschiedene Output Streams leiten. Die Person die das Skript dann am Ende ausf√ºhrt kann dann selbst entscheiden welche Infos (sprich: welche Streams) sie sehen m√∂chte. Interessanterweise schreibt Write-Host nicht nur direkt in den Konsolenhost, sondern auch in den Information Stream. Wenn ihr mehr zu dem Thema wissen wollt, dann schaut mal dieses Video hier zu PowerShell Output Streams an.\nFazit Zusammengefasst w√ºrde ich sagen: Write-Host gibt Infos vorallem visuell aus f√ºr den User in der Konsole. Write-Output ist unabh√§ngig davon und gibt Infos innerhalb der PowerShell Pipeline weiter. Wenn Write-Output der letzte Befehl in einer Pipeline ist, dann wird die Info sichtbar ausgegeben und kann dann durch andere Logging-Funktionalit√§ten besser aufgefangen werden.\n","wordCount":"653","inLanguage":"de","datePublished":"2024-07-05T00:00:00Z","dateModified":"2024-07-05T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell Write-Host VS. Write-Output</h1><div class=post-meta><span title='2024-07-05 00:00:00 +0000 UTC'>2024-07-05</span>&nbsp;¬∑&nbsp;4 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-07-05-PowerShell-Write-Host-vs-Write-Output.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#write-host aria-label=Write-Host>Write-Host</a></li><li><a href=#write-output aria-label=Write-Output>Write-Output</a></li><li><a href=#wann-was-verwenden aria-label="Wann was verwenden?">Wann was verwenden?</a><ul><li><a href=#write-output-ist-eigentlich-optional aria-label="Write-Output ist eigentlich optional">Write-Output ist eigentlich optional</a></li></ul></li><li><a href=#hinweis-zu-output-streams aria-label="Hinweis zu Output Streams">Hinweis zu Output Streams</a></li><li><a href=#fazit aria-label=Fazit>Fazit</a></li></ul></div></details></div><div class=post-content><p>In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet <code>Write-Host</code> ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative <code>Write-Output</code>. In diesem Post erkl√§re ich euch die Unterschiede.</p><p><strong>üé¨ Ich habe √ºbrigens auch ein <a href="https://www.youtube.com/watch?v=eHBO4b_Riho" target=_blank>Video zu dem Thema erstellt.</a></strong></p><h2 id=write-host>Write-Host<a hidden class=anchor aria-hidden=true href=#write-host>#</a></h2><p><code>Write-Host</code> gibt Daten auf dem PowerShell <strong>Host</strong> aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der <code>ConsoleHost</code>, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden.</p><p><a href=/images/2024/2024-07-05_Other_PSHosts.jpg><img loading=lazy src=/images/2024/2024-07-05_Other_PSHosts.jpg alt="Beispiel f√ºr andere PowerShell Hosts: Visual Studio Code und PowerShell ISE" title="Beispiel f√ºr andere PowerShell Hosts: Visual Studio Code und PowerShell ISE"></a></p><p><code>Write-Host</code> kann die Art und Weise beeinflussen, wie die Daten vom PowerShell Host ausgegeben werden. Zum Beispiel kann mit <code>-ForegroundColor</code> die Textfarbe und mit <code>-BackgroundColor</code> die Hintergrundfarbe angepasst werden.
Also wenn ihr ein Skript interaktiv in einer Konsole ausf√ºhrt, dann kann <code>Write-Host</code> durchaus n√ºtzlich sein um eine ansprechendere Ausgabe zu erm√∂glichen.
Ein ganz gro√üer Nachteil ist allerdings: Daten die per <code>Write-Host</code> ausgegeben werden, k√∂nnen dann nicht in der Pipeline weiterverarbeitet werden.</p><p>Also das Ergebnis kann z.B. nicht in eine Variable gespeichert werden:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Variable</span> = <span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># R√ºckgabe: Hallo PowerShell</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Variable</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># = keine sichtbare R√ºckgabe</span>
</span></span></code></pre></td></tr></table></div></div><p>Und auch nicht an andere Cmdlets gepiped werden:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;C:\temp&#34;</span> | <span style=color:#d0a8ff>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># R√ºckgabe: C:\temp (und nicht der Inhalt von C:\temp !)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=write-output>Write-Output<a hidden class=anchor aria-hidden=true href=#write-output>#</a></h2><p><code>Write-Output</code> hingegen <em>kann</em> weiterverarbeitet werden:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Variable</span> = <span style=color:#d0a8ff>Write-Output</span> <span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Variable</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># R√ºckgabe: Hallo PowerShell</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Write-Output</span> <span style=color:#fc6a5d>&#34;C:\temp&#34;</span> | <span style=color:#d0a8ff>Get-ChildItem</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># R√ºckgabe: &lt; Inhalt von C:\temp ... &gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Daf√ºr fehlen dann aber die M√∂glichkeiten zur Formatierung, die <code>Write-Host</code> hat.</p><h2 id=wann-was-verwenden>Wann was verwenden?<a hidden class=anchor aria-hidden=true href=#wann-was-verwenden>#</a></h2><p>Es ist vorteilhaft die Unterschiede zwischen <code>Write-Host</code> und <code>Write-Output</code> zu kennen und zu nutzen. Also z.B. wenn ihr in einem Skript die R√ºckgabe von einem ScriptBlock wie z.B. aus einer Schleife in eine Variable speichert, dann w√ºrden Ausgaben per <code>Write-Output</code> h√∂chstwahrscheinlich euer Ergebnis-Array mit unn√∂tigen Eintr√§gen verunreinigen. Wenn ihr dann aber <code>Write-Host</code> verwendet, dann k√∂nnt ihr eine Ausgabe erzeugen, ohne dass diese im Ergebnis-Array landet.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Ps1Files</span> = <span style=color:#d0a8ff>Get-ChildItem</span> *.ps1 -Recurse
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Ergebnis</span> = <span style=color:#fc5fa3>foreach</span>(<span style=color:#41a1c0>$File</span> <span style=color:#fc5fa3>in</span> <span style=color:#41a1c0>$Ps1Files</span>) {
</span></span><span style=display:flex><span>    <span style=color:#41a1c0>$File</span>.FullName <span style=color:#6c7986># Das wird an die Schleife ausgegeben</span>
</span></span><span style=display:flex><span>    <span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$File</span>.Name)<span style=color:#fc6a5d>&#34;</span> -NoNewLine -ForeGroundColor Yellow
</span></span><span style=display:flex><span>    <span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34; gefunden...&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-07-05_Write-Host-in-a-Loop.jpg><img loading=lazy src=/images/2024/2024-07-05_Write-Host-in-a-Loop.jpg alt="Ergebnis des vorangegangenem Codes: Bunte Ausgabe per Write-Host und Bef√ºllung einer Variable" title="Ergebnis des vorangegangenem Codes: Bunte Ausgabe per Write-Host und Bef√ºllung einer Variable"></a></p><p>Oder wenn ihr ein Skript in Azure Automation ausf√ºhrt, dann landen Ausgaben die per <code>Write-Host</code> erzeugt werden <strong>nicht</strong> in den Logs. Wenn ihr Skripte f√ºr Azure Automation erzeugt, dann m√ºsst ihr also <code>Write-Output</code> statt <code>Write-Host</code> verwenden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Azure Automation Beispielcode</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Write-Output</span> <span style=color:#fc6a5d>&#34;Azure Automation verwendet √ºbrigens einen weiteren PowerShell Host&#34;</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Host</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Ausgaben per Write-Host sind in Azure Automation nicht sichtbar&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-07-05_Write-Output-in-Azure-Automation.jpg><img loading=lazy src=/images/2024/2024-07-05_Write-Output-in-Azure-Automation.jpg alt="Ausf√ºhrung des vorangegangenem PowerShell Runbooks in Azure Automation: Ausgabe wird per Write-Output bzw. durch ein beliebiges Cmdlet erzeugt. Ausgabe per Write-Host ist nicht sichtbar" title="Ausf√ºhrung des vorangegangenem PowerShell Runbooks in Azure Automation: Ausgabe wird per Write-Output bzw. durch ein beliebiges Cmdlet erzeugt. Ausgabe per Write-Host ist nicht sichtbar"></a></p><h3 id=write-output-ist-eigentlich-optional>Write-Output ist eigentlich optional<a hidden class=anchor aria-hidden=true href=#write-output-ist-eigentlich-optional>#</a></h3><p>Wenn ihr jetzt denkt, dass tendenziell <code>Write-Output</code> zu bevorzugen ist: Ihr m√ºsst eigentlich auch nicht mal <code>Write-Output</code> verwenden. Ihr k√∂nnt n√§mlich auch einfach direkt euer gew√ºnschtes Objekt - sei es aus einer Variable oder einem Cmdlet oder sonst wie - im Code referenzieren und dann wird es ausgegeben. Also vorteilhaft ist dann vielleicht nur, dass ein kleines bisschen einfacher ersichtlich ist &ldquo;Hey hier wird ganz bewusst eine Ausgabe im Code erzeugt&rdquo;.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Write-Output</span> <span style=color:#fc6a5d>&#34;Hallo :)&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># R√ºckgabe: Hallo :)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=hinweis-zu-output-streams>Hinweis zu Output Streams<a hidden class=anchor aria-hidden=true href=#hinweis-zu-output-streams>#</a></h2><p>Abgesehen von <code>Write-Output</code> und <code>Write-Host</code> gibt es auch noch weitere Ausgabe Cmdlets, wie z.B. <code>Write-Information</code>, <code>Write-Error</code>, <code>Write-Warning</code> und so weiter. Ihr k√∂nntet damit Ausgaben erzeugen und sie in verschiedene Output Streams leiten. Die Person die das Skript dann am Ende ausf√ºhrt kann dann selbst entscheiden welche Infos (sprich: welche Streams) sie sehen m√∂chte. Interessanterweise schreibt <code>Write-Host</code> nicht nur direkt in den Konsolenhost, sondern auch in den Information Stream.
Wenn ihr mehr zu dem Thema wissen wollt, dann schaut mal <a href="https://www.youtube.com/watch?v=tpzQA3F9O_s" target=_blank>dieses Video hier zu PowerShell Output Streams an</a>.</p><h2 id=fazit>Fazit<a hidden class=anchor aria-hidden=true href=#fazit>#</a></h2><p>Zusammengefasst w√ºrde ich sagen:
<code>Write-Host</code> gibt Infos vorallem visuell aus f√ºr den User in der Konsole. <code>Write-Output</code> ist unabh√§ngig davon und gibt Infos innerhalb der PowerShell Pipeline weiter. Wenn <code>Write-Output</code> der letzte Befehl in einer Pipeline ist, dann wird die Info sichtbar ausgegeben und kann dann durch andere Logging-Funktionalit√§ten besser aufgefangen werden.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>