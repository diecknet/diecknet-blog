<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Calculated Properties | diecknet</title>
<meta name=keywords content="powershell"><meta name=description content="Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte &ldquo;Calculcated Properties&rdquo; und das Cmdlet Select-Object verwendet werden.
Damit können zum Beispiel:
Eigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets) Objekte normal ausgeben Zur Erinnerung: Die Auswahl von Objekteigenschaften bei Select-Object ist mit dem Parameter -Property möglich."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Calculated Properties"><meta property="og:description" content="Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte &ldquo;Calculcated Properties&rdquo; und das Cmdlet Select-Object verwendet werden.
Damit können zum Beispiel:
Eigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets) Objekte normal ausgeben Zur Erinnerung: Die Auswahl von Objekteigenschaften bei Select-Object ist mit dem Parameter -Property möglich."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/08/21/powershell-calculated-properties/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-21T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-21T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Calculated Properties"><meta name=twitter:description content="Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte &ldquo;Calculcated Properties&rdquo; und das Cmdlet Select-Object verwendet werden.
Damit können zum Beispiel:
Eigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets) Objekte normal ausgeben Zur Erinnerung: Die Auswahl von Objekteigenschaften bei Select-Object ist mit dem Parameter -Property möglich."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Calculated Properties","item":"https://diecknet.de/de/2024/08/21/powershell-calculated-properties/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Calculated Properties","name":"PowerShell Calculated Properties","description":"Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte \u0026ldquo;Calculcated Properties\u0026rdquo; und das Cmdlet Select-Object verwendet werden.\nDamit können zum Beispiel:\nEigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets) Objekte normal ausgeben Zur Erinnerung: Die Auswahl von Objekteigenschaften bei Select-Object ist mit dem Parameter -Property möglich.","keywords":["powershell"],"articleBody":"Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte “Calculcated Properties” und das Cmdlet Select-Object verwendet werden.\nDamit können zum Beispiel:\nEigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets) Objekte normal ausgeben Zur Erinnerung: Die Auswahl von Objekteigenschaften bei Select-Object ist mit dem Parameter -Property möglich. Wobei der Parameter in der Regel auch nicht explizit benannt werden muss.\n1 2 3 4 5 # Alle Windows Dienste auflisten; nur die Eigenschaften Name und Status zeigen Get-Service | Select-Object -Property Name, Status # Alternativ ohne -Property explizit zu nennen Get-Service | Select-Object Name, Status Eigenschaft umbenennen Um eine Eigenschaft umzubennen, müssen wir eine Hashtable statt eines einfachen Parameternamens angeben. Die Hashtable hat zwei Einträge:\nBezeichner Bedeutung Name (oder Label) Name der neuen Eigenschaft Expression Scriptblock, der den Wert erzeugt Beispielsweise um die Eigenschaft “Dienstname” zu erzeugen, die den Namen eines Windows Dienstes enthält:\n1 2 3 4 5 6 7 8 Get-Service | Select-Object @{Name = \"Dienstname\"; Expression = { $_.Name } }, Status # Rückgabe Dienstname Status ---------- ------ [...] wuauserv Stopped [...] Zusätzlich können normale Parameter auch verwendet werden. In diesem Beispiel habe ich auch noch die Eigenschaft “Status” mit ausgegeben.\nString Eigenschaft formatieren / mehrere Eigenschaften zusammenfassen Aber wir können Eigenschaften nicht nur umbenennen, sondern auch beliebig formatieren. Zum Beispiel, wenn ich möchte, dass in einer Eigenschaft sowohl der Anzeigename, als auch der interne Name eines Windows Dienstes angezeigt wird.\n1 2 3 4 5 6 7 8 Get-Service | Select-Object -Property @{Name = \"Dienstname\"; Expression = { \"$($_.DisplayName) ($($_.Name))\" } }, Status # Rückgabe: Dienstname Status ---------- ------ [...] Windows Update (wuauserv) Stopped [...] If-Abfrage einbauen Es ist auch möglich, Logik mit einer If-Abfrage zu integrieren. Zum Beispiel wird hier geprüft, ob ein Active Directory User Mitglied in einer Sicherheitsgruppe ist, die dem Wildcard Muster *VIP-User* entspricht. Falls dem so ist, wird “Ja” in die neue Eigenschaft “VIP” hineingeschrieben. Falls nicht, wird stattdessen “Nein” hineingeschrieben.\n1 2 3 4 5 6 7 8 9 10 11 12 $User = Get-ADUser -Property MemberOf -Filter * $User | Select-Object -Property UserPrincipalName, @{Name = \"VIP\"; Expression = { if ($_.MemberOf -like \"*VIP-User*\") { \"Ja\" } else { \"Nein\" } } } # Rückgabe UserPrincipalName VIP ----------------- --- [...] testuser12345@demotenant.de Nein alexw@demotenant.de Ja andreas.dieckmann@demotenant.de Nein soenderzoichuenss@demotenant.de Ja [...] Zusätzliche Cmdlets verwenden Abgesehen von If-Abfragen können wir auch ganze Cmdlets verwenden, um zusätzliche Informationen abzufragen. In diesem Beispiel verwende ich erstmal Get-ADUser, um alle User in einer Organisationseinheit im Active Directory aufzulisten. Anschließend möchte ich den jeweiligen Manager (Vorgesetzten) von den Usern auflisten.\n1 2 3 4 5 6 7 8 9 10 11 12 $User = Get-ADUser -Property Manager -Filter * -Searchbase \"OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de\" # Normale Auflistung der Manager $User | Select-Object -Property Name, Manager # Rückgabe Name Manager ---- ------- Adam Steward CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de Charles Walker CN=Andreas Dieckmann,OU=User,OU=DemoTenant,DC=lan,DC=demotenant... Alex Wilber CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de Andreas Dieckmann Söndèr Zöichünß CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de Im Standard wird uns hier der “Distinguished Name” (DN) des Managers aufgelistet. Nicht besonders ansehlich. Aber wir können in der Expression für die Calculated Property ein weiteres mal Get-ADUser ausführen, um Infos zu dem Manager zu erhalten.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $User = Get-ADUser -Property Manager -Filter * -Searchbase \"OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de\" $User | Select-Object -Property Name, @{Name = \"Manager\"; Expression = { if ($_.Manager) { (Get-ADUser $_.Manager).Name } else { \"*niemand*\" } } } # Rückgabe Name Manager ---- ------- Adam Steward Charles Walker Charles Walker Andreas Dieckmann Alex Wilber Charles Walker Andreas Dieckmann *niemand* Söndèr Zöichünß Charles Walker In diesem Beispiel habe ich die Expression auch auf mehrere Zeilen aufgeteilt. Das ist problemlos möglich, da sie eindeutig erkennbar mit {geschweiften Klammern} umschlossen ist.\nÜbrigens: Falls ihr in der Konsole arbeitet, könnt ihr auch [Umschalt] + [Enter] drücken, um in einer neuen Zeile weiter zu schreiben, ohne den Befehl bereits auszuführen.\nArray zu String umwandeln Falls ihr eine Objekteigenschaft exportieren wollt, die aus einem Array besteht, funktioniert der Export normalerweise nicht so gut. In der Konsole sind die Werte in der Array-Eigenschaft mit {geschweiften Klammern} umschlossen. Zum Beispiel frage ich hier alle Domain Controller in meinem Active Directory ab und lasse die FSMO-Rollen auflisten.\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,OperationMasterRoles # Rückgabe Name OperationMasterRoles ---- -------------------- DC2 {SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster...} In meiner Konsole wurde die Ausgabe sogar ein bisschen abgeschnitten, sodass ich gar nicht alle Rollen sehe. Wenn ich versuche ein derartiges Array per Export-CSV zu exportieren, ist das Ergebnis im Standard komplett unbrauchbar:\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,OperationMasterRoles | Export-Csv c:\\diecknet\\ad.csv Get-Content C:\\diecknet\\ad.csv # Rückgabe \"Name\",\"OperationMasterRoles\" \"DC2\",\"Microsoft.ActiveDirectory.Management.ADPropertyValueCollection\" Das Array wurde also nicht zu einem String umgewandelt, sondern stattdessen steht dort Microsoft.ActiveDirectory.Management.ADPropertyValueCollection.\nDie Lösung: Calculated Properties und der -join Operator. Im folgenden Beispiel werden die Einträge im Array zu einem String zusammengeführt und jeweils mit einem Leerzeichen und Komma getrennt (, ).\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,@{Label=\"FSMO-Rollen\";Expression={$_.OperationMasterRoles -join \", \"}} # Rückgabe Name FSMO-Rollen ---- ----------- DC2 SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster Weitere Tipps und Hinweise Hier noch ein paar allgemeine Tipps und Hinweise zu Calculated Properties.\nName VS. Label Vielleicht ist euch im vorherigen Beispiel aufgefallen, dass ich auf einmal @{Label= statt @{Name= in der Hashtable verwendet habe. Tatsächlich sind hier Name und Label beliebig miteinander austauschbar. Es geht beides, macht keinen Unterschied.\n1 2 3 # Beides Varianten erzeugen das gleiche Ergebnis Get-ADDomainController | Select-Object Name,@{Label=\"FSMO-Rollen\"; Expression={$_.OperationMasterRoles -join \", \"}} Get-ADDomainController | Select-Object Name,@{Name=\"FSMO-Rollen\"; Expression={$_.OperationMasterRoles -join \", \"}} Lesbarkeit erhöhen mit Hashtable Splatting Im Abschnitt “Zusätzliche Cmdlets verwenden” hatte ich ja den Expression Scriptblock auch schon mal aufgeteilt auf mehrere Zeilen. Eine weitere Möglichkeit die Lesbarkeit zu erhöhen ist das Splatting. Dabei werden die Cmdlet Parameter in eine Hashtable geschrieben.\nIm folgenden Beispiel habe ich die Hashtable-Variable für die Formatierung der Einfachheit halber auch $Formatierung genannt. Der Name ist aber natürlich frei wählbar. In der Hashtable gibt es dann den Key Property, der wiederum ein Array ist. In diesem Array müssen die Properties stehen, die ausgegeben werden sollen. Ich habe hier zwei weitere Hashtables verwendet (Calculated Properties) und einen String (normale Property vom Objekt).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $Formatierung = @{ Property = ( @{ Name = \"Dienstname\" Expression = { $_.Name } }, @{ Name = \"Dienststatus\" Expression = { $_.Status } }, # Wichtig: Normale Eigenschaften müssen in der Hashtable in Anführungszeichen stehen! \"StartType\" # Beispiel für normale Eigenschaft (keine Calculated Property) ) } Get-Service | Select-Object @Formatierung # Rückgabe Dienstname Dienststatus StartType ---------- ------------ --------- [...] wuauserv Running Manual [...] Kurzform der Hashtable Namen erlaubt Statt der vollständig ausgeschriebenen Hashtable-Keys Name/Label und Expression können auch die Kurzschreibweisen N,L und E verwendet werden.\n1 2 3 4 5 # Normale Schreibweise Get-Service | Select-Object -Property @{Name = \"Dienstname\"; Expression = { $_.Name } }, Status # Kurze Schreibweise Get-Service | Select-Object -Property @{N = \"Dienstname\"; E = { $_.Name } }, Status Get-Service | Select-Object -Property @{L = \"Dienstname\"; E = { $_.Name } }, Status Das Label ist eigentlich optional Tatsächlich ist das Label beziehungsweise der Name optional. Es wäre auch möglich keine Hashtable zu verwenden, sondern einfach nur einen Scriptblock für die Calculated Property anzugeben. In dem Fall erhält die Calculated Property aber den ScriptBlock als Namen, was komisch aussieht. Ich würde das nicht empfehlen.\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,{$_.OperationMasterRoles -join \", \"} # Rückgabe Name $_.OperationMasterRoles -join \", \" ---- ---------------------------------- DC2 SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster ","wordCount":"1304","inLanguage":"de","datePublished":"2024-08-21T00:00:00Z","dateModified":"2024-08-21T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/08/21/powershell-calculated-properties/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell Calculated Properties</h1><div class=post-meta><span title='2024-08-21 00:00:00 +0000 UTC'>2024-08-21</span>&nbsp;·&nbsp;7 Minuten&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-08-21-PowerShell-Calculated-Properties.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#objekte-normal-ausgeben aria-label="Objekte normal ausgeben">Objekte normal ausgeben</a></li><li><a href=#eigenschaft-umbenennen aria-label="Eigenschaft umbenennen">Eigenschaft umbenennen</a></li><li><a href=#string-eigenschaft-formatieren--mehrere-eigenschaften-zusammenfassen aria-label="String Eigenschaft formatieren / mehrere Eigenschaften zusammenfassen">String Eigenschaft formatieren / mehrere Eigenschaften zusammenfassen</a></li><li><a href=#if-abfrage-einbauen aria-label="If-Abfrage einbauen">If-Abfrage einbauen</a></li><li><a href=#zus%c3%a4tzliche-cmdlets-verwenden aria-label="Zusätzliche Cmdlets verwenden">Zusätzliche Cmdlets verwenden</a></li><li><a href=#array-zu-string-umwandeln aria-label="Array zu String umwandeln">Array zu String umwandeln</a></li><li><a href=#weitere-tipps-und-hinweise aria-label="Weitere Tipps und Hinweise">Weitere Tipps und Hinweise</a><ul><li><a href=#name-vs-label aria-label="Name VS. Label">Name VS. Label</a></li><li><a href=#lesbarkeit-erh%c3%b6hen-mit-hashtable-splatting aria-label="Lesbarkeit erhöhen mit Hashtable Splatting">Lesbarkeit erhöhen mit Hashtable Splatting</a></li><li><a href=#kurzform-der-hashtable-namen-erlaubt aria-label="Kurzform der Hashtable Namen erlaubt">Kurzform der Hashtable Namen erlaubt</a></li><li><a href=#das-label-ist-eigentlich-optional aria-label="Das Label ist eigentlich optional">Das Label ist eigentlich optional</a></li></ul></li></ul></div></details></div><div class=post-content><p>Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per <code>Export-CSV</code>), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend für euren Zweck sind, dann könnt ihr sie auch anpassen. Dafür können sogenannte &ldquo;Calculcated Properties&rdquo; und das Cmdlet <code>Select-Object</code> verwendet werden.</p><p>Damit können zum Beispiel:</p><ul><li>Eigenschaften umbenannt werden</li><li>Eigenschaftswerte formatiert werden</li><li>Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zusätzlicher Cmdlets)</li></ul><h2 id=objekte-normal-ausgeben>Objekte normal ausgeben<a hidden class=anchor aria-hidden=true href=#objekte-normal-ausgeben>#</a></h2><p>Zur Erinnerung: Die Auswahl von Objekteigenschaften bei <code>Select-Object</code> ist mit dem Parameter <code>-Property</code> möglich. Wobei der Parameter in der Regel auch nicht explizit benannt werden muss.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Alle Windows Dienste auflisten; nur die Eigenschaften Name und Status zeigen</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Alternativ ohne -Property explizit zu nennen</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> Name, Status
</span></span></code></pre></td></tr></table></div></div><h2 id=eigenschaft-umbenennen>Eigenschaft umbenennen<a hidden class=anchor aria-hidden=true href=#eigenschaft-umbenennen>#</a></h2><p>Um eine Eigenschaft umzubennen, müssen wir eine Hashtable statt eines einfachen Parameternamens angeben.
Die Hashtable hat zwei Einträge:</p><table><thead><tr><th>Bezeichner</th><th>Bedeutung</th></tr></thead><tbody><tr><td><code>Name</code> (oder <code>Label</code>)</td><td>Name der neuen Eigenschaft</td></tr><tr><td><code>Expression</code></td><td>Scriptblock, der den Wert erzeugt</td></tr></tbody></table><p>Beispielsweise um die Eigenschaft &ldquo;Dienstname&rdquo; zu erzeugen, die den Namen eines Windows Dienstes enthält:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> @{Name = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>; Expression = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Dienstname      Status
</span></span><span style=display:flex><span>----------      ------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>wuauserv        Stopped
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><p>Zusätzlich können normale Parameter auch verwendet werden. In diesem Beispiel habe ich auch noch die Eigenschaft &ldquo;Status&rdquo; mit ausgegeben.</p><h2 id=string-eigenschaft-formatieren--mehrere-eigenschaften-zusammenfassen>String Eigenschaft formatieren / mehrere Eigenschaften zusammenfassen<a hidden class=anchor aria-hidden=true href=#string-eigenschaft-formatieren--mehrere-eigenschaften-zusammenfassen>#</a></h2><p>Aber wir können Eigenschaften nicht nur umbenennen, sondern auch beliebig formatieren. Zum Beispiel, wenn ich möchte, dass in einer Eigenschaft sowohl der Anzeigename, als auch der interne Name eines Windows Dienstes angezeigt wird.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{Name = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>; Expression = { <span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$_</span>.DisplayName)<span style=color:#fc6a5d> (</span>$(<span style=color:#41a1c0>$_</span>.Name)<span style=color:#fc6a5d>)&#34;</span> } }, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe:</span>
</span></span><span style=display:flex><span>Dienstname                                      Status
</span></span><span style=display:flex><span>----------                                      ------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>Windows Update (wuauserv)                      Stopped
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h2 id=if-abfrage-einbauen>If-Abfrage einbauen<a hidden class=anchor aria-hidden=true href=#if-abfrage-einbauen>#</a></h2><p>Es ist auch möglich, Logik mit einer If-Abfrage zu integrieren. Zum Beispiel wird hier geprüft, ob ein Active Directory User Mitglied in einer Sicherheitsgruppe ist, die dem Wildcard Muster <code>*VIP-User*</code> entspricht. Falls dem so ist, wird &ldquo;Ja&rdquo; in die neue Eigenschaft &ldquo;VIP&rdquo; hineingeschrieben. Falls nicht, wird stattdessen &ldquo;Nein&rdquo; hineingeschrieben.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property MemberOf -Filter *
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property UserPrincipalName, @{Name = <span style=color:#fc6a5d>&#34;VIP&#34;</span>; Expression = { <span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$_</span>.MemberOf -like <span style=color:#fc6a5d>&#34;*VIP-User*&#34;</span>) { <span style=color:#fc6a5d>&#34;Ja&#34;</span> } <span style=color:#fc5fa3>else</span> { <span style=color:#fc6a5d>&#34;Nein&#34;</span> } } }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>UserPrincipalName                                                           VIP
</span></span><span style=display:flex><span>-----------------                                                           ---
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>testuser12345<span style=color:#41a1c0>@demotenant</span>.de                                                 Nein
</span></span><span style=display:flex><span>alexw<span style=color:#41a1c0>@demotenant</span>.de                                                         Ja
</span></span><span style=display:flex><span>andreas.dieckmann<span style=color:#41a1c0>@demotenant</span>.de                                             Nein
</span></span><span style=display:flex><span>soenderzoichuenss<span style=color:#41a1c0>@demotenant</span>.de                                             Ja
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h2 id=zusätzliche-cmdlets-verwenden>Zusätzliche Cmdlets verwenden<a hidden class=anchor aria-hidden=true href=#zusätzliche-cmdlets-verwenden>#</a></h2><p>Abgesehen von If-Abfragen können wir auch ganze Cmdlets verwenden, um zusätzliche Informationen abzufragen.
In diesem Beispiel verwende ich erstmal <code>Get-ADUser</code>, um alle User in einer Organisationseinheit im Active Directory aufzulisten. Anschließend möchte ich den jeweiligen Manager (Vorgesetzten) von den Usern auflisten.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property Manager -Filter * -Searchbase <span style=color:#fc6a5d>&#34;OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Normale Auflistung der Manager</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, Manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Name              Manager
</span></span><span style=display:flex><span>----              -------
</span></span><span style=display:flex><span>Adam Steward      CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de
</span></span><span style=display:flex><span>Charles Walker    CN=Andreas Dieckmann,OU=User,OU=DemoTenant,DC=lan,DC=demotenant...
</span></span><span style=display:flex><span>Alex Wilber       CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de
</span></span><span style=display:flex><span>Andreas Dieckmann
</span></span><span style=display:flex><span>Söndèr Zöichünß   CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de
</span></span></code></pre></td></tr></table></div></div><p>Im Standard wird uns hier der &ldquo;Distinguished Name&rdquo; (DN) des Managers aufgelistet. Nicht besonders ansehlich. Aber wir können in der Expression für die Calculated Property ein weiteres mal <code>Get-ADUser</code> ausführen, um Infos zu dem Manager zu erhalten.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property Manager -Filter * -Searchbase <span style=color:#fc6a5d>&#34;OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de&#34;</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, @{Name = <span style=color:#fc6a5d>&#34;Manager&#34;</span>; Expression = {
</span></span><span style=display:flex><span>        <span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$_</span>.Manager) {
</span></span><span style=display:flex><span>            (<span style=color:#d0a8ff>Get-ADUser</span> <span style=color:#41a1c0>$_</span>.Manager).Name
</span></span><span style=display:flex><span>        } <span style=color:#fc5fa3>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;*niemand*&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Name              Manager
</span></span><span style=display:flex><span>----              -------
</span></span><span style=display:flex><span>Adam Steward      Charles Walker
</span></span><span style=display:flex><span>Charles Walker    Andreas Dieckmann
</span></span><span style=display:flex><span>Alex Wilber       Charles Walker
</span></span><span style=display:flex><span>Andreas Dieckmann *niemand*
</span></span><span style=display:flex><span>Söndèr Zöichünß   Charles Walker
</span></span></code></pre></td></tr></table></div></div><p>In diesem Beispiel habe ich die Expression auch auf mehrere Zeilen aufgeteilt. Das ist problemlos möglich, da sie eindeutig erkennbar mit <code>{</code>geschweiften Klammern<code>}</code> umschlossen ist.</p><p>Übrigens: Falls ihr in der Konsole arbeitet, könnt ihr auch <code>[Umschalt] + [Enter]</code> drücken, um in einer neuen Zeile weiter zu schreiben, ohne den Befehl bereits auszuführen.</p><h2 id=array-zu-string-umwandeln>Array zu String umwandeln<a hidden class=anchor aria-hidden=true href=#array-zu-string-umwandeln>#</a></h2><p>Falls ihr eine Objekteigenschaft exportieren wollt, die aus einem Array besteht, funktioniert der Export normalerweise nicht so gut. In der Konsole sind die Werte in der Array-Eigenschaft mit <code>{</code>geschweiften Klammern<code>}</code> umschlossen. Zum Beispiel frage ich hier alle Domain Controller in meinem Active Directory ab und lasse die FSMO-Rollen auflisten.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,OperationMasterRoles
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Name OperationMasterRoles
</span></span><span style=display:flex><span>---- --------------------
</span></span><span style=display:flex><span>DC2  {SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster...}
</span></span></code></pre></td></tr></table></div></div><p>In meiner Konsole wurde die Ausgabe sogar ein bisschen abgeschnitten, sodass ich gar nicht alle Rollen sehe. Wenn ich versuche ein derartiges Array per <code>Export-CSV</code> zu exportieren, ist das Ergebnis im Standard komplett unbrauchbar:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,OperationMasterRoles | <span style=color:#d0a8ff>Export-Csv</span> c:\diecknet\ad.csv
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Content</span> C:\diecknet\ad.csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Name&#34;</span>,<span style=color:#fc6a5d>&#34;OperationMasterRoles&#34;</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;DC2&#34;</span>,<span style=color:#fc6a5d>&#34;Microsoft.ActiveDirectory.Management.ADPropertyValueCollection&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Das Array wurde also nicht zu einem String umgewandelt, sondern stattdessen steht dort <code>Microsoft.ActiveDirectory.Management.ADPropertyValueCollection</code>.</p><p>Die Lösung: Calculated Properties und der <code>-join</code> Operator. Im folgenden Beispiel werden die Einträge im Array zu einem String zusammengeführt und jeweils mit einem Leerzeichen und Komma getrennt (<code>, </code>).</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Label=<span style=color:#fc6a5d>&#34;FSMO-Rollen&#34;</span>;Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Name <span style=color:#d0a8ff>FSMO-Rollen</span>
</span></span><span style=display:flex><span>---- -----------
</span></span><span style=display:flex><span>DC2  SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster
</span></span></code></pre></td></tr></table></div></div><h2 id=weitere-tipps-und-hinweise>Weitere Tipps und Hinweise<a hidden class=anchor aria-hidden=true href=#weitere-tipps-und-hinweise>#</a></h2><p>Hier noch ein paar allgemeine Tipps und Hinweise zu Calculated Properties.</p><h3 id=name-vs-label>Name VS. Label<a hidden class=anchor aria-hidden=true href=#name-vs-label>#</a></h3><p>Vielleicht ist euch im vorherigen Beispiel aufgefallen, dass ich auf einmal <code>@{Label=</code> statt <code>@{Name=</code> in der Hashtable verwendet habe. Tatsächlich sind hier <code>Name</code> und <code>Label</code> beliebig miteinander austauschbar. Es geht beides, macht keinen Unterschied.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Beides Varianten erzeugen das gleiche Ergebnis</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Label=<span style=color:#fc6a5d>&#34;FSMO-Rollen&#34;</span>; Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Name=<span style=color:#fc6a5d>&#34;FSMO-Rollen&#34;</span>; Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span></code></pre></td></tr></table></div></div><h3 id=lesbarkeit-erhöhen-mit-hashtable-splatting>Lesbarkeit erhöhen mit Hashtable Splatting<a hidden class=anchor aria-hidden=true href=#lesbarkeit-erhöhen-mit-hashtable-splatting>#</a></h3><p><a href=#zus%c3%a4tzliche-cmdlets-verwenden>Im Abschnitt &ldquo;Zusätzliche Cmdlets verwenden&rdquo;</a> hatte ich ja den Expression Scriptblock auch schon mal aufgeteilt auf mehrere Zeilen. Eine weitere Möglichkeit die Lesbarkeit zu erhöhen ist das Splatting. Dabei werden die Cmdlet Parameter in eine Hashtable geschrieben.</p><p>Im folgenden Beispiel habe ich die Hashtable-Variable für die Formatierung der Einfachheit halber auch <code>$Formatierung</code> genannt. Der Name ist aber natürlich frei wählbar. In der Hashtable gibt es dann den Key <code>Property</code>, der wiederum ein Array ist. In diesem Array müssen die Properties stehen, die ausgegeben werden sollen. Ich habe hier zwei weitere Hashtables verwendet (Calculated Properties) und einen String (normale Property vom Objekt).</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Formatierung</span> = @{
</span></span><span style=display:flex><span>    Property = (
</span></span><span style=display:flex><span>        @{
</span></span><span style=display:flex><span>            Name       = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>
</span></span><span style=display:flex><span>            Expression = { <span style=color:#41a1c0>$_</span>.Name }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        @{
</span></span><span style=display:flex><span>            Name       = <span style=color:#fc6a5d>&#34;Dienststatus&#34;</span>
</span></span><span style=display:flex><span>            Expression = { <span style=color:#41a1c0>$_</span>.Status }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#6c7986># Wichtig: Normale Eigenschaften müssen in der Hashtable in Anführungszeichen stehen!</span>
</span></span><span style=display:flex><span>        <span style=color:#fc6a5d>&#34;StartType&#34;</span> <span style=color:#6c7986># Beispiel für normale Eigenschaft (keine Calculated Property)</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> <span style=color:#41a1c0>@Formatierung</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Dienstname Dienststatus StartType
</span></span><span style=display:flex><span>---------- ------------ ---------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>wuauserv        Running    Manual
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h3 id=kurzform-der-hashtable-namen-erlaubt>Kurzform der Hashtable Namen erlaubt<a hidden class=anchor aria-hidden=true href=#kurzform-der-hashtable-namen-erlaubt>#</a></h3><p>Statt der vollständig ausgeschriebenen Hashtable-Keys <code>Name</code>/<code>Label</code> und <code>Expression</code> können auch die Kurzschreibweisen <code>N</code>,<code>L</code> und <code>E</code> verwendet werden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Normale Schreibweise</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{Name = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>; Expression = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span><span style=color:#6c7986># Kurze Schreibweise</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{N = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>; E = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{L = <span style=color:#fc6a5d>&#34;Dienstname&#34;</span>; E = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span></code></pre></td></tr></table></div></div><h3 id=das-label-ist-eigentlich-optional>Das Label ist eigentlich optional<a hidden class=anchor aria-hidden=true href=#das-label-ist-eigentlich-optional>#</a></h3><p>Tatsächlich ist das Label beziehungsweise der Name optional. Es wäre auch möglich <strong>keine</strong> Hashtable zu verwenden, sondern einfach nur einen Scriptblock für die Calculated Property anzugeben. In dem Fall erhält die Calculated Property aber den ScriptBlock als Namen, was komisch aussieht. Ich würde das nicht empfehlen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,{<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Rückgabe</span>
</span></span><span style=display:flex><span>Name <span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>
</span></span><span style=display:flex><span>---- ----------------------------------
</span></span><span style=display:flex><span>DC2  SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li></ul><div class=share-buttons></div></footer><script src=https://giscus.diecknet.de/client.js data-repo=diecknet/diecknet-blog data-repo-id="MDEwOlJlcG9zaXRvcnkyMDkzNDUzNzM=" data-category="Blog Discussions" data-category-id=MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyNjMwOTY0 data-mapping=specific data-term=powershell-calculated-properties data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>