<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Regular Expressions in PowerShell | diecknet</title>
<meta name=keywords content="powershell,regex,regular expressions"><meta name=description content="Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge &ldquo;Error&rdquo; enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/03/19/powershell-regex/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/03/19/powershell-regex/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Regular Expressions in PowerShell"><meta property="og:description" content="Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge &ldquo;Error&rdquo; enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/03/19/powershell-regex/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-19T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-19T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Regular Expressions in PowerShell"><meta name=twitter:description content="Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge &ldquo;Error&rdquo; enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"Regular Expressions in PowerShell","item":"https://diecknet.de/de/2024/03/19/powershell-regex/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Regular Expressions in PowerShell","name":"Regular Expressions in PowerShell","description":"Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge \u0026ldquo;Error\u0026rdquo; enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\n","keywords":["powershell","regex","regular expressions"],"articleBody":"Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge ‚ÄúError‚Äù enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nDiese Muster gibt es in vielen Programmiersprachen. Die Details der Implementierungen k√∂nnen sich dann in den Details aber etwas unterscheiden. PowerShell und die RegEx-Engine der PowerShell basieren auf .NET. Deshalb gelten hier vorallem die .NET Eigenheiten.\nIn der PowerShell gibt es verschiedene M√∂glichkeiten um Regular Expressions zu verwenden - also zum Beispiel in Cmdlets, als Vergleichsoperator oder per .NET Methode. Im Folgenden zeige ich euch ein paar dieser M√∂glichkeiten. Au√üerdem zeige ich euch, wie ihr die Vergleichsmuster also die tats√§chlichen Regular Expressions erstellen k√∂nnt.\nDer -match Operator Eine einfache M√∂glichkeit um einen Vergleich per Regular Expressions zu machen, ist der -match Vergleichsoperator. Zum Beispiel so:\n1 2 3 4 5 6 \"Hallo PowerShell\" -match \"shell\" \u003c# R√ºckgabe: True #\u003e Hier wird gepr√ºft, ob im Text ‚ÄúHallo PowerShell‚Äù auch die Zeichenkette ‚Äúshell‚Äù enthalten ist. Das Ergebnis ist True, also wahr. Und hierbei sehen wir jetzt schon die erste Besonderheit: Denn in der PowerShell sind Regular Expressions standardm√§√üig nicht case-sensitive - also die Gro√ü- und Kleinschreibung wird ignoriert. Ihr k√∂nnt aber auch explizit angeben, dass ihr Case-Sensitive vergleichen wollt, oder ganz explizit nicht. Explizit anzugeben, dass nicht case-sensitive gearbeitet wird, obwohl es ja eigentlich dem Standard spricht - das klingt vielleicht erstmal komisch. Hat aber seine Daseinsberechtigung. Wenn ihr das n√§mlich macht, dann wird spiegelt euer Code ein bisschen genauer wider, was ihr eigentlich machen wollt.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Explizit NICHT case-sensitive: \"Hallo PowerShell\" -imatch \"shell\" \u003c# R√ºckgabe: True #\u003e # Case-sensitive erzwingen: \"Hallo PowerShell\" -cmatch \"shell\" \u003c# R√ºckgabe: False #\u003e Es gibt auch alle drei match Operatoren auch noch in umgedreht, n√§mlich immer noch mit dem Zusatz ‚Äúnot‚Äù (also Englisch f√ºr ‚Äúnicht‚Äù):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # Normalerweise NICHT case-sensitive, aber negiert: \"Hallo PowerShell\" -notmatch \"shell\" \u003c# R√ºckgabe: False #\u003e # Explizit NICHT case-sensitive, aber negiert: \"Hallo PowerShell\" -inotmatch \"shell\" \u003c# R√ºckgabe: False #\u003e # Case-sensitive erzwingen, aber negiert: \"Hallo PowerShell\" -cnotmatch \"shell\" \u003c# R√ºckgabe: True #\u003e Platzhalter und Quantifier Aber mit Regul√§ren Ausdr√ºcken k√∂nnen wir auch mehr: Also nicht einfach nur ein Wort oder ein St√ºck Text als Vergleichsmuster verwenden. Es gibt verschiedene Zeichen, mit einer speziellen Bedeutung. Zum Beispiel ein Punkt . steht f√ºr ein beliebiges Zeichen. Und man kann auch mit einem zus√§tzlichen Zeichen die Anzahl des gew√ºnschten Zeichens angeben, auf Englisch wird das ‚Äúquantifier‚Äù genannt. So einen ‚Äúquantifier‚Äù h√§ngt man dran, also es bezieht sich immer auf die Sache davor. Ein Quantifier ist zum Beispiel das Stern-Symbol * was f√ºr eine beliebige Anzahl steht, also auch inklusive 0. Das + Symbol steht f√ºr die Anzahl 1 oder mehr. Das ? steht f√ºr die Anzahl 0 oder 1. Also kann ich zum Beispiel auch so einen Vergleich machen:\n1 2 3 4 5 \"PowerShell ist eine m√§chtige Skriptsprache\" -match \"m.chtig\" \u003c# R√ºckgabe: True #\u003e Statt also hier explizit das ‚Äú√§‚Äù anzugeben, habe ich den Punkt als Platzhalter verwendet. Das ergibt auch True. Passen wir das nochmal an und nehmen einen ‚Äúquantifier‚Äù mit rein.\n1 2 3 4 5 \"PowerShell ist eine m√§chtige Skriptsprache\" -match \"m.*chtig\" \u003c# R√ºckgabe: True #\u003e Der Stern steht ja f√ºr eine beliebige Anzahl. Also k√∂nnte ich auch den String anpassen, sodass dort ‚Äúm√§chtig‚Äù mit drei ‚Äú√§‚Äù steht.\n1 2 3 4 5 \"PowerShell ist eine m√§√§√§chtige Skriptsprache\" -match \"m.*chtig\" \u003c# R√ºckgabe: True #\u003e Oder es w√ºrden auch andere Zeichen gematched werden.\n1 2 3 4 5 6 7 8 9 10 11 \"PowerShell ist eine m√∂chtige Skriptsprache\" -match \"m.*chtig\" \u003c# R√ºckgabe: True #\u003e \"PowerShell ist eine massiv richtige Skriptsprache\" -match \"m.*chtig\" \u003c# R√ºckgabe: True #\u003e Ob das letzte Beispiel ein ordentlicher deutscher Satz ist, lassen wir mal dahin gestellt. Aber auch diese Vergleichsoperation ergibt True, weil da irgendwo ein m steht und dann sp√§ter chtig.\n√úbrigens: Den Quantifier k√∂nnen wir auch bei normalen Zeichen verwenden, also nicht nur bei Spezialzeichen wie dem Punkt. Um zum Beispiel stattdessen zu pr√ºfen, ob 0, 1 oder mehr √§ enthalten sind k√∂nnten wir folgendes machen:\n1 2 3 4 5 6 7 8 9 10 11 \"PowerShell ist eine m√∂chtige Skriptsprache\" -match \"m√§*chtig\" \u003c# R√ºckgabe: False #\u003e \"PowerShell ist eine m√§√§√§chtige Skriptsprache\" -match \"m√§*chtig\" \u003c# R√ºckgabe: True #\u003e Hinweis: Wenn ihr eines von den Spezialzeichen []().\\^$|?*+{} matchen wollt, also wenn ihr zum Beispiel schauen wollt, ob das Stern-Symbol oder ein Punkt in einem Text drin steht, dann funktioniert das erstmal nicht. Um gegen so ein Spezialzeichen vergleichen zu k√∂nnen, m√ºssen wir das Zeichen ‚Äúescapen‚Äù. Daf√ºr schreiben wir ein Backslash-Symbol \\ vor das Zeichen, welches wir escapen wollen. Zum Beispiel so:\n1 2 3 4 5 \"Dieser Text enth√§lt ein *-Symbol\" -match \"\\*\" \u003c# R√ºckgabe: True #\u003e Das gilt √ºbrigens auch f√ºr das Backslash-Symbol. Also um zu pr√ºfen ob ein Backslash Symbol enthalten ist, m√ºssen wir es mit einem Backslash escapen, sodass dann dort zwei Backslashes im Vergleichsmuster stehen.\n1 2 3 4 5 \"Dieser Text enth√§lt ein \\-Symbol\" -match \"\\\\\" \u003c# R√ºckgabe: True #\u003e Mehr Infos zu den anderen Spezialzeichen und Platzhaltern kommen im Laufe des Artikels.\nDie $Matches Variable Bei der Verwendung der Match-Operatoren passiert noch mehr als nur die R√ºckgabe von True oder False. Wenn das Ergebnis des Vergleichs True ist, dann wird die Variable $Matches dem ersten Suchtreffer im Text bef√ºllt. Das macht eigentlich erst Sinn, wenn man mit irgendwelchen Platzhaltern oder Quantifiern arbeitet.\nMachen wir mal noch einen Vergleich mit dem match-Operator und schauen in die Variable rein. Mein Text in dem ich etwas pr√ºfen m√∂chte, habe ich grob an HTML oder XML Code angelehnt. Und mein Vergleichsmuster schaut nach den Tags mit dem Namen und dazwischen d√ºrfen dann 0 oder mehr beliebige Zeichen stehen. Da das Ergebnis True ist, wird die $Matches Variable automatisch bef√ºllt.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \"Hallo\" -match \".*\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- 0 Hallo #\u003e Capture Groups Mit Capture Groups k√∂nnen wir bestimmte Bereiche aus dem Text extrahieren. Auch mehrere Capture Groups in einer regular Expression sind m√∂glich, aber wir fangen erstmal mit einer an.\nBleiben wir mal bei dem Beispiel vom vorherigen Abschnitt. Wenn ich jetzt genau den Text extrahieren m√∂chte, der sich innerhalb der -Tags befindet, dann ist der bisherige Code noch nicht optimal. Aber das Verwenden von Capture Groups ist eigentlich ganz einfach, wir m√ºssen einfach den Bereich den wir als Capture Group behandeln wollen in Runde Klammern () stecken. Das Ergebnis von Capture Groups landet ebenfalls in der $Matches Variable.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \"Hallo\" -match \"(.*)\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- 1 Hallo 0 Hallo #\u003e Die $Matches Variable ist √ºbrigens eine Hashtable. Der Eintrag mit dem Namen ‚Äú0‚Äù gibt unseren gesamten gematchten String zur√ºck. Und wenn wir eine Capture Group verwenden, dann landet die im Eintrag ‚Äú1‚Äù. Wenn wir noch mehr Capture Groups verwenden w√ºrden, dann k√∂nnte es auch noch mehr Eintr√§ge geben, dann w√ºrde einfach weiter hochnummeriert werden.\nZum Beispiel extrahiere ich hier drei Infos per Capture Groups:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \"Hallo\" -match \"\u003c(.+)\u003e(.*)\u003c/(.+)\u003e\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- 3 test 2 Hallo 1 test 0 Hallo #\u003e Jetzt habe ich Eintr√§ge von 0-3 in meiner $Matches Variable. Wenn ihr die im Code weiter verarbeiten wollt, k√∂nnt ihr wie bei jeder anderen Hashtable auch, auf die einzelnen Eintr√§ge zugreifen. Zum Beispiel so:\n1 2 3 4 5 6 7 8 9 10 11 $Matches[2] \u003c# R√ºckgabe: Hallo #\u003e $Matches[1] \u003c# R√ºckgabe: test #\u003e Hier ein Bild um visuell zu zeigen, wo was gecaptured wird:\nAllerdings wird der Code durch diese Nummerierungen schnell un√ºbersichtlich. Um den Code besser verst√§ndlich zu machen, k√∂nnen wir ‚ÄúNamed Captures‚Äù verwenden. Also Namen f√ºr unsere Capture Groups festlegen. Daf√ºr m√ºssen wir an den Anfang der Capture Group, aber innerhalb der runden Klammern, erstmal ein ? schreiben und dann zwischen einem kleiner-als-Zeichen \u003c und einem Gr√∂√üer-als-Zeichen \u003e den gew√ºnschten Namen. Der Eintrag in der $Matches-Hashtable erh√§lt dann statt einer Nummer den gew√ºnschten Namen.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \"Hallo\" -match \"(?.*)\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- MeinText Hallo 0 Hallo #\u003e $Matches[\"MeinText\"] \u003c# R√ºckgabe: Hallo #\u003e Ein kleines Manko gibt es bei der Verwendung von Capture Groups mit dem -match Operator: Wenn ihr mehrfach matchen wollt, dann geht das nicht. Also wenn eure Regular Expression mehrfach zutrifft auf euren String, dann wird nur das erste Ergebnis zur√ºckgeliefert. Zum Beispiel so:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \"Hallo Moin\" -match \"(?.*?)\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- MeinText Hallo 0 Hallo #\u003e Der String den ich hier √ºberpr√ºft habe, enth√§lt zwei Bl√∂cke mit diesem -Tag. Wenn ich jetzt in die $Matches Variable reinschaue, dann ist da aber trotzdem nur ein Treffer drin. Das l√§sst sich auch nicht anpassen bei der Verwendung des -match Operators. Wenn ihr mehrere Treffer matchen wollt und dabei vielleicht auch noch Capture Groups verwenden wollt, dann m√ºsst ihr eine andere Methode verwenden (zum Beispiel die .NET Klasse RegEx).\nGreedy Captures Euch ist vielleicht beim letzten Beispiel im vorherigen Abschnitt (Capture Groups) aufgefallen, dass meine Regular Expression noch ein Fragezeichen ? enth√§lt. Durch dieses Fragezeichen habe ich eingestellt, dass die RegEx Engine hier nicht wie im Standard ‚Äúgreedy‚Äù ist - (zu deutsch ‚Äúgierig‚Äù). Normalerweise versucht die Engine im gierigen Modus soviele Zeichen wie m√∂glich mit der Regular Expression zu matchen. Das kann aber zu unerw√ºnschten Ergebnissen f√ºhren. Im Vergleich hier einmal das Ergebnis ohne das Fragezeichen.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \"Hallo Moin\" -match \"(?.*)\" \u003c# R√ºckgabe: True #\u003e $Matches \u003c# R√ºckgabe Name Value ---- ----- MeinText Hallo Moin 0 Hallo Moin #\u003e Besonderheiten und Tipps zum match Operator Eine Besonderheit beim -match Operator: Wenn ihr mehrere Objekte gleichzeitig als Eingabe nehmt, also zum Beispiel so:\n1 2 3 4 5 6 \"Hallo\", \"PowerShell\", \"test\" -match \".*o.*\" \u003c# R√ºckgabe: Hallo PowerShell #\u003e Dann kriegt ihr nicht True oder False zur√ºck, sondern jeweils alle Strings bei denen die Regular Expression erfolgreich gematched hat. In so einem Fall wird die automatische Variable $Matches auch nicht bef√ºllt. Also wenn da vorher etwas drin stand, dann ist noch der alte Wert drin. Und wenn zuvor noch nichts drin stand, dann steht da jetzt auch nichts drin.\nMeine Praxistipps f√ºr den Match Operator sind wie folgt:\nWenn ihr nur pr√ºfen wollt, ob ein Muster zutreffend ist, gibt es nicht viel zu beachten. Macht einfach eine If-Abfrage. Das funktioniert sowohl bei einem Objekt als Input, als auch mit mehreren.\n1 2 3 4 5 $MeineVariable = \"Kanal abonnieren\" if($MeineVariable -match \"abo\") { # Das hier wird ausgef√ºhrt, wenn die Regular Expression True ergibt \"... und Video liken!\" } Ansonsten solltet ihr sicherstellen, dass ihr wisst wieviele Objekte ihr an -match √ºbergebt. Es ist ein ganz klassischer Fehler in der Programmlogik, dass nicht beachtet wird, dass ein Cmdlet auch mal mehr Objekte zur√ºcklieferen kann als nur eins. Um sicherzustellen, dass nur ein Objekt gepr√ºft wird, k√∂nnt ihr zum Beispiel mit Select-Object -First 1 die R√ºckgabe auf ein Objekt beschr√§nken.\n1 2 3 4 5 $MeineVariable = \"User1@example.com\", \"User2@example.com\" | Select-Object -First 1 if($MeineVariable -match \"user\") { \"User gefunden!\" # irgendwas mit dem User machen } Nur wenn ihr wirklich nur gegen ein Objekt matched, k√∂nnt ihr dem Inhalt der Variable $Matches vertrauen.\nWenn ihr eine Regular Expression habt, die mehrfach auf euren String passt, und ihr alle Treffer wissen wollt, und vielleicht sogar mit Capture Groups die Infos rausziehen wollt, dann ist der -match Operator daf√ºr nicht geeignet. Es gibt aber andere M√∂glichkeiten zum Beispiel die .NET RegEx Klasse.\nDer -replace Operator Mit dem -replace Operator wird der Text der dem RegEx Muster entspricht durch einen anderen Text ersetzt. Zun√§chst ein einfaches Beispiel, bei dem einfach das Zeichen W inklusive allem was danach folgt durch das Wort PowerShell ersetzt wird.\n1 2 3 4 5 \"Hallo Welt\" -replace \"W.*\", \"PowerShell\" \u003c# R√ºckgabe: Hallo PowerShell #\u003e Aber der -replace Operator unterst√ºtzt auch Capture Groups. Und dann k√∂nnen wir die Capture Groups in unserem Ergebnis verwenden.\n1 2 3 4 5 6 7 8 9 10 11 12 13 # Mit unbenannten Capture Groups \"diecknet\" -replace \"(.*)\", 'Hallo $1' \u003c# Achtung! Hier ist es wichtig, dass mindestens der zweite Parameter von -replace mit einfachen Anf√ºhrungszeichen umschlossen ist. Ansonsten w√ºrde das $1 als PowerShell Variable interpretiert werden - es ist aber keine. Es ist ein Platzhalter der auf eine Regular Expression Capture Group verweist. #\u003e # Ergebnis = Hallo diecknet # Mit benannten Capture Groups \"diecknet\" -replace \"(?.*)\", 'Hallo ${MeinText}' # Ergebnis = Hallo diecknet Die $Matches Variable wird √ºbrigens nicht bef√ºllt, wenn wir den -replace Operator verwenden. Falls sie bei euch noch gesetzt ist, dann ist das noch von einem vorherigen Vergleich per -match Operator.\nDer -split Operator Mit dem -split Operator k√∂nnt ihr Strings aufteilen. Und auch hier k√∂nnen nicht nur einfache Zeichenfolgen als Trennzeichen verwendet werden, sondern auch Regular Expressions. Einfaches Beispiel:\n1 2 3 4 5 6 7 \"Hallo Welt!\" -split \" \" \u003c# R√ºckgabe: Hallo Welt! #\u003e Und ein komplexeres Beispiel:\n1 2 3 4 5 6 7 8 9 10 \"Hallo Welt! In diesem Text wird jedes mal getrennt, wenn ein Satzzeichen auftaucht. Sinnvoll? Eher nicht.\" -split \"[\\.,!?]\" \u003c# R√ºckgabe: Hallo Welt In diesem Text wird jedes mal getrennt wenn ein Satzzeichen auftaucht Sinnvoll Eher nicht #\u003e Der -split Operator unterst√ºtzt noch ein paar weitere Optionen. Ich finde es aber nicht so interessant und habe keine coolen Beispiele. Schaut daf√ºr am besten in die Dokumentation bei Microsoft: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_split?view=powershell-7.4\nSelect-String Cmdlet Mit dem Cmdlet Select-String kann ein String oder ein Dateiinhalt mit einer Regular Expression verglichen werden. Oder auch mehrere Strings oder Dateiinhalte. Zum Beispiel vergleiche ich hier mehrere Objekte, in dem Fall einfache Strings, indem ich sie per Pipeline an Select-Object √ºbergebe.\n1 2 3 4 5 6 7 # Der Parameter -Pattern legt die Regular Expression fest \"Moin und hallo!\",\"Boink!\",\"Test\" | Select-String -Pattern \"oi\" \u003c# R√ºckgabe: Moin und hallo! Boink #\u003e Von den drei Objekten erhalte ich nur zwei zur√ºck, da nur zwei dem Muster entsprechen. In der PowerShell 7 wird es sogar auch noch in der Konsole hervorgehoben, wo das Muster zutrifft.\nAuch bei Select-String wird die Gro√ü- und Kleinschreibung im Standard erstmal ignoriert. Wenn ihr wollt, dass sie beim Vergleichen beachtet wird, dann k√∂nnt ihr den zus√§tzlichen Parameter -CaseSensitive mit angeben. Au√üerdem k√∂nnt ihr die √úberpr√ºfung auch umdrehen, indem ihr den Parameter -NotMatch angebt. Dann w√ºrden nur die Strings zur√ºckgegeben werden, die nicht dem Muster entsprechen. Aber diese Sachen k√∂nnten wir ja auch schon mit dem -match Operator erreichen. Was ich dann interessanter finde, ist die M√∂glichkeit eine oder mehrere Dateien zu pr√ºfen. Zum Beispiel √ºberpr√ºfe ich so alle Dateien mit der Dateiendung .log im Verzeichnis C:\\diecknet:\n1 Select-String -Path \"C:\\diecknet\\*.log\" -Pattern \"password\" Wenn wir jetzt eine oder mehrere Textdateien mit dem Cmdlet pr√ºfen, dann kriegen wir bei den Suchtreffern auch noch die Information in welcher Datei sich der Treffer befindet und in welcher Zeile. Manchmal m√∂chte man aber noch ein bisschen mehr Infos bekommen, ein bisschen Kontext. Daf√ºr gibt es den Parameter -Context. Da kann ich wahlweise eine Zahl angeben, und soviele Zeilen kriege ich dann dar√ºber und darunter mit ausgegeben.\n1 Select-String -Path \"C:\\diecknet\\*.log\" -Pattern \"password\" -Context 1 Die tats√§chliche Zeile mit dem Suchergebnis ist dann mit einem Gr√∂√üer-als-Zeichen \u003e markiert.\nWir k√∂nnen aber auch getrennt steuern, wieviele Zeilen davor und danach wir erhalten m√∂chten. Daf√ºr einfach zwei Zahlen als Parameterwert angeben und mit einem Komma trennen. In folgendem Beispiel werden eine Zeile davor und 5 danach zur√ºckgegeben.\n1 Select-String -Path \"C:\\diecknet\\*.log\" -Pattern \"password\" -Context 1,5 Das was uns hier von Select-String zur√ºckgeliefert wird, ist √ºbrigens auch mehr als einfach nur Text. Tats√§chlich kriegen wir hier Objekte vom Typ MatchInfo zur√ºck.\n1 Select-String -Path \"C:\\diecknet\\*\" -Pattern \"test\" -Context 1 | Get-Member Das MatchInfo Objekt hat einige interessante Eigenschaften, auf die wir dann per Code zugreifen k√∂nnen. Wir k√∂nnten beispielsweise auch per Code die genaue Zeilennummer eines Datei-Treffers herausfinden.\n1 2 3 4 5 6 $Ergebnisse = Select-String -Path \"C:\\diecknet\\*.log\" -Pattern \"password\" -Context 1,5 foreach($Ergebnis in $Ergebnisse) { Write-Host \"Treffer in $($Ergebnis.FileName) in Zeile $($Ergebnis.LineNumber):\" -ForegroundColor Red Write-Host $Ergebnis.Line -ForegroundColor Yellow } Falls ihr euch f√ºr mehrere Treffer in einer Zeile interessiert, dann k√∂nnt ihr das auch aktivieren mit dem Parameter -AllMatches.\n1 Select-String -Path \"C:\\diecknet\\*.log\" -Pattern \"password\" -AllMatches Switch Statement mit -RegEx Parameter Beim Switch Statement k√∂nnen auch regul√§re Ausdr√ºcke verwendet werden. Daf√ºr muss der Parameter -RegEx mit angegeben werden. Bei jedem Bedingungsblock des Switch Statements kann dann ein regul√§rer Ausdruck eingetragen werden.\n1 2 3 4 5 6 7 8 9 10 $MeinString = \"Hallo!\" switch -Regex ( $MeinString ) { \"\u003c.+\u003e\" { \"Sieht aus wie eine HTML-Seite!\" } \"\\d{5}\" { \"Enth√§lt eine 5-stellige Zahl!\" } } \u003c# R√ºckgabe Sieht aus wie eine HTML-Seite! #\u003e .NET RegEx Matches Die m√§chtigste M√∂glichkeit um Regular Expressions in der PowerShell zu verwenden, ist meiner Meinung nach die .NET Klasse RegEx. Es gibt verschiedene M√∂glichkeiten die Klasse zu benutzen. Die einfachste ist meiner Meinung nach Folgende:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $TestString = \"Hall√∂chen\" [regex]::Matches($TestString, 'Ha') \u003c# R√ºckgabe: Groups : {0} Success : True Name : 0 Captures : {0} Index : 0 Length : 2 Value : Ha ValueSpan : #\u003e Wenn die Regular Expression erfolgreich gegen den String gematched wurde, dann erhaltet ihr ein Match Objekt zur√ºck. Daran ist dann unter anderem erkennbar, dass das Muster erkannt wurde. Und ihr k√∂nnt per Code auf die Eigenschaften zugreifen. Ich benutze die .NET Variante hier vorallem wenn ich mehrere Infos auf einmal per Capture Groups rausziehen m√∂chte. Also nicht einfach nur mehrere Capture Groups, sondern dass das Muster mehrfach zutrifft. Ich habe hier zum Beispiel eine Text-Datei mit folgendem Inhalt (das ist √ºbrigens alles in einer Zeile):\nMit folgendem PowerShell Code lese ich die Text-Datei zun√§chst ein und pr√ºfe dann mit der [regex]::Matches() Methode ob ein Muster darauf zutrifft.\n1 2 $MeinString = Get-Content C:\\diecknet\\net-beispiel.txt [regex]::Matches($MeinString, '\\b([a-f0-9]{32})\\b') Der Code extrahiert alle Zeichenfolgen die exakt 32 Zeichen lang sind und ausschlie√ülich aus Hexadezimalen Zeichen bestehen. Dabei hat die Regular Expression \\b([a-f0-9]{32})\\b genau eine Capture Group. Da ich die Matches Methode aus der RegEx Klasse aufgerufen habe, kriege ich nicht nur den ersten Suchtreffer zur√ºck, sondern alle.\nWichtig: Bei der .NET Klasse RegEx solltet ihr genau auf die Gro√ü- und Kleinschreibung achten! Im Gegensatz zu den anderen RegEx M√∂glichkeiten in der PowerShell, ist sie standardm√§√üig case-sensitive. Der folgende Code w√ºrde keinen Treffer im String finden:\n1 2 3 $TestString = \"Hall√∂chen\" [regex]::Matches($TestString, 'ha') # Keine R√ºckgabe, auf Grund der Gro√ü- und Kleinschreibung. Aber die .NET [RegEx]::Matches() Methode unterst√ºtzt diverse Optionen. Unser bisheriges Beispiel kann um einen dritten Parameter erg√§nzt werden, um auch hier die Gro√ü- und Kleinschreibung zu ignorieren:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 $TestString = \"Hall√∂chen\" [regex]::Matches($TestString, 'ha', 'IgnoreCase') \u003c# R√ºckgabe Groups : {0} Success : True Name : 0 Captures : {0} Index : 0 Length : 2 Value : Ha ValueSpan : #\u003e üí° Weitere Optionen k√∂nnt ihr hier in der Microsoft Dokumentation finden: https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-options?redirectedfrom=MSDN\nAu√üerdem gibt es noch weitere Methoden in der RegEx Klasse, die je nach Anwendungsfall auch noch sehr praktisch sein k√∂nnen. Schaut daf√ºr in die Dokumentation zur RegEx Klasse: https://learn.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex?view=net-8.0#methods\nRegular Expressions entwerfen Okay, kommen wir also dazu wie ihr Regular Expressions entwerfen k√∂nnt. Wie zum Beispiel die Expression von eben: \\b([a-f0-9]{32})\\b Also ganz ehrlich: Ich finde Regular Expressions sind nicht einfach. Ich habe nicht genug Erfahrung mit Regular Expressions, dass ich die einfach so runtertippe ohne irgendwelche Hilfe. Aber ich guck eigentlich gar nicht erst in die Microsoft Dokumentation zu RegEx in .NET oder PowerShell. Stattdessen nehme ich ein Tool um ein RegEx Muster zu entwerfen. Es gibt einige kostenlose Websites, mit denen man Regular Expressions im Browser bauen kann und direkt live gegen einen oder mehrere Strings testen kann. Ich habe in letzter Zeit gerne RegEx101.com verwendet, weil dort auch speziell mit Bezug auf die .NET Eigenheiten gearbeitet werden kann. In der Vergangenheit habe ich auch andere allgemeinere Websites benutzt, die dann z.B. eher an JavaScript orientiert sind. Aber meistens hat das auch richtig funktioniert. Keine Ahnung wie seri√∂s diese RegEx101.com Seite ist, also ich w√ºrde da jetzt keine personenbezogenen Daten oder sonst wie was kritisches reintun. Wichtig: Auf der Seite m√ºsst ihr links den Flavor auf ‚Äú.NET‚Äù umstellen.\nWenn ihr jetzt ein Muster entwerfen wollt, dann schaut unten rechts in den Bereich ‚ÄúQuick Reference‚Äù. Dort werden alle m√∂glichen Platzhalter und Spezialzeichen erkl√§rt. Au√üerdem gibt es den Bereich Explanation, der die erstellte Regular Expression erkl√§rt. Sehr nice!\nSchlusswort Das waren meiner Meinung nach die wichtigsten M√∂glichkeiten Regular Expressions in der PowerShell zu verwenden. Vermutlich gibt auch noch mehr M√∂glichkeiten. Aber das Grundprinzip das war hoffentlich verst√§ndlich, sodass ihr Regular Expressions hoffentlich auch an den anderen Stellen anwenden k√∂nnt.\nEin wichtiger Hinweis noch: Wenn ihr nur einen einfachen Vergleich durchf√ºhren wollt, ist es empfehlenswert Regular Expressions gar nicht erst zu verwenden. Denn die Verwendung der RegEx Engine hat einen gewissen Overhead. Im Zweifelsfall testen und Zeit messen!\n","wordCount":"3654","inLanguage":"de","datePublished":"2024-03-19T00:00:00Z","dateModified":"2024-03-19T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/03/19/powershell-regex/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>Regular Expressions in PowerShell</h1><div class=post-meta><span title='2024-03-19 00:00:00 +0000 UTC'>2024-03-19</span>&nbsp;¬∑&nbsp;18 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-03-19-PowerShell-RegEx.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#der--match-operator aria-label="Der -match Operator">Der -match Operator</a></li><li><a href=#platzhalter-und-quantifier aria-label="Platzhalter und Quantifier">Platzhalter und Quantifier</a></li><li><a href=#die-matches-variable aria-label="Die $Matches Variable">Die $Matches Variable</a></li><li><a href=#capture-groups aria-label="Capture Groups">Capture Groups</a></li><li><a href=#greedy-captures aria-label="Greedy Captures">Greedy Captures</a></li><li><a href=#besonderheiten-und-tipps-zum-match-operator aria-label="Besonderheiten und Tipps zum match Operator">Besonderheiten und Tipps zum match Operator</a></li><li><a href=#der--replace-operator aria-label="Der -replace Operator">Der -replace Operator</a></li><li><a href=#der--split-operator aria-label="Der -split Operator">Der -split Operator</a></li><li><a href=#select-string-cmdlet aria-label="Select-String Cmdlet">Select-String Cmdlet</a></li><li><a href=#switch-statement-mit--regex-parameter aria-label="Switch Statement mit -RegEx Parameter">Switch Statement mit -RegEx Parameter</a></li><li><a href=#net-regex-matches aria-label=".NET RegEx Matches">.NET RegEx Matches</a></li><li><a href=#regular-expressions-entwerfen aria-label="Regular Expressions entwerfen">Regular Expressions entwerfen</a></li><li><a href=#schlusswort aria-label=Schlusswort>Schlusswort</a></li></ul></div></details></div><div class=post-content><p>Regular Expressions sind Muster mit denen Texte verglichen werden k√∂nnen oder auch Infos aus Texten extrahiert werden k√∂nnen. Zum Beispiel k√∂nnt ihr damit √ºberpr√ºfen, ob eine Logdatei von einem Programm die Zeichenfolge &ldquo;Error&rdquo; enth√§lt (also um zu pr√ºfen, ob ein Fehler aufgetreten ist). Oder um einfach nur zu schauen, ob eine Zeichenkette einem bestimmten Muster entspricht, zum Beispiel einer E-Mail Adresse.</p><p><strong>üé¨ Ich habe √ºbrigens auch ein <a href=https://youtu.be/Zk6iHL1T94k target=_blank>Video zu dem Thema erstellt.</a></strong></p><p>Diese Muster gibt es in vielen Programmiersprachen. Die Details der Implementierungen k√∂nnen sich dann in den Details aber etwas unterscheiden. PowerShell und die RegEx-Engine der PowerShell basieren auf .NET. Deshalb gelten hier vorallem die .NET Eigenheiten.<br>In der PowerShell gibt es verschiedene M√∂glichkeiten um Regular Expressions zu verwenden - also zum Beispiel in Cmdlets, als Vergleichsoperator oder per .NET Methode. Im Folgenden zeige ich euch ein paar dieser M√∂glichkeiten. Au√üerdem zeige ich euch, wie ihr die Vergleichsmuster also die tats√§chlichen Regular Expressions erstellen k√∂nnt.</p><h2 id=der--match-operator>Der -match Operator<a hidden class=anchor aria-hidden=true href=#der--match-operator>#</a></h2><p>Eine einfache M√∂glichkeit um einen Vergleich per Regular Expressions zu machen, ist der <code>-match</code> Vergleichsoperator. Zum Beispiel so:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -match <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Hier wird gepr√ºft, ob im Text &ldquo;Hallo PowerShell&rdquo; auch die Zeichenkette &ldquo;shell&rdquo; enthalten ist. Das Ergebnis ist <code>True</code>, also wahr. Und hierbei sehen wir jetzt schon die erste Besonderheit: Denn in der PowerShell sind Regular Expressions standardm√§√üig <strong>nicht case-sensitive</strong> - also die Gro√ü- und Kleinschreibung wird ignoriert. Ihr k√∂nnt aber auch explizit angeben, dass ihr Case-Sensitive vergleichen wollt, oder ganz explizit nicht. Explizit anzugeben, dass nicht case-sensitive gearbeitet wird, obwohl es ja eigentlich dem Standard spricht - das klingt vielleicht erstmal komisch. Hat aber seine Daseinsberechtigung. Wenn ihr das n√§mlich macht, dann wird spiegelt euer Code ein bisschen genauer wider, was ihr eigentlich machen wollt.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Explizit NICHT case-sensitive:</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -imatch <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Case-sensitive erzwingen:</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -cmatch <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>False
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Es gibt auch alle drei <code>match</code> Operatoren auch noch in umgedreht, n√§mlich immer noch mit dem Zusatz &ldquo;not&rdquo; (also Englisch f√ºr &ldquo;nicht&rdquo;):</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Normalerweise NICHT case-sensitive, aber negiert:</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -notmatch <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>False
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Explizit NICHT case-sensitive, aber negiert:</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -inotmatch <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>False
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Case-sensitive erzwingen, aber negiert:</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo PowerShell&#34;</span> -cnotmatch <span style=color:#fc6a5d>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=platzhalter-und-quantifier>Platzhalter und Quantifier<a hidden class=anchor aria-hidden=true href=#platzhalter-und-quantifier>#</a></h2><p>Aber mit Regul√§ren Ausdr√ºcken k√∂nnen wir auch mehr: Also nicht einfach nur ein Wort oder ein St√ºck Text als Vergleichsmuster verwenden. Es gibt verschiedene Zeichen, mit einer speziellen Bedeutung. Zum Beispiel ein Punkt <code>.</code> steht f√ºr ein beliebiges Zeichen. Und man kann auch mit einem zus√§tzlichen Zeichen die Anzahl des gew√ºnschten Zeichens angeben, auf Englisch wird das &ldquo;quantifier&rdquo; genannt. So einen &ldquo;quantifier&rdquo; h√§ngt man dran, also es bezieht sich immer auf die Sache davor. Ein Quantifier ist zum Beispiel das Stern-Symbol <code>*</code> was f√ºr eine beliebige Anzahl steht, also auch inklusive 0. Das <code>+</code> Symbol steht f√ºr die Anzahl 1 oder mehr. Das <code>?</code> steht f√ºr die Anzahl 0 oder 1.
Also kann ich zum Beispiel auch so einen Vergleich machen:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√§chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m.chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Statt also hier explizit das &ldquo;√§&rdquo; anzugeben, habe ich den Punkt als Platzhalter verwendet. Das ergibt auch <code>True</code>.
Passen wir das nochmal an und nehmen einen &ldquo;quantifier&rdquo; mit rein.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√§chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m.*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Der Stern steht ja f√ºr eine beliebige Anzahl. Also k√∂nnte ich auch den String anpassen, sodass dort &ldquo;m√§chtig&rdquo; mit drei &ldquo;√§&rdquo; steht.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√§√§√§chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m.*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Oder es w√ºrden auch andere Zeichen gematched werden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√∂chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m.*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine massiv richtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m.*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Ob das letzte Beispiel ein ordentlicher deutscher Satz ist, lassen wir mal dahin gestellt. Aber auch diese Vergleichsoperation ergibt <code>True</code>, weil da irgendwo ein <code>m</code> steht und dann sp√§ter <code>chtig</code>.</p><p>√úbrigens: Den Quantifier k√∂nnen wir auch bei normalen Zeichen verwenden, also nicht nur bei Spezialzeichen wie dem Punkt. Um zum Beispiel stattdessen zu pr√ºfen, ob 0, 1 oder mehr <code>√§</code> enthalten sind k√∂nnten wir folgendes machen:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√∂chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m√§*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>False
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;PowerShell ist eine m√§√§√§chtige Skriptsprache&#34;</span> -match <span style=color:#fc6a5d>&#34;m√§*chtig&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Hinweis:</strong> Wenn ihr eines von den Spezialzeichen <code>[]().\^$|?*+{}</code> matchen wollt, also wenn ihr zum Beispiel schauen wollt, ob das Stern-Symbol oder ein Punkt in einem Text drin steht, dann funktioniert das erstmal nicht. Um gegen so ein Spezialzeichen vergleichen zu k√∂nnen, m√ºssen wir das Zeichen &ldquo;escapen&rdquo;. Daf√ºr schreiben wir ein Backslash-Symbol <code>\</code> vor das Zeichen, welches wir escapen wollen. Zum Beispiel so:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Dieser Text enth√§lt ein *-Symbol&#34;</span> -match <span style=color:#fc6a5d>&#34;\*&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Das gilt √ºbrigens auch f√ºr das Backslash-Symbol. Also um zu pr√ºfen ob ein Backslash Symbol enthalten ist, m√ºssen wir es mit einem Backslash escapen, sodass dann dort zwei Backslashes im Vergleichsmuster stehen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Dieser Text enth√§lt ein \-Symbol&#34;</span> -match <span style=color:#fc6a5d>&#34;\\&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Mehr Infos zu den anderen Spezialzeichen und Platzhaltern kommen im Laufe des Artikels.</p><h2 id=die-matches-variable>Die $Matches Variable<a hidden class=anchor aria-hidden=true href=#die-matches-variable>#</a></h2><p>Bei der Verwendung der Match-Operatoren passiert noch mehr als nur die R√ºckgabe von <code>True</code> oder <code>False</code>. Wenn das Ergebnis des Vergleichs <code>True</code> ist, dann wird die Variable <code>$Matches</code> dem ersten Suchtreffer im Text bef√ºllt. Das macht eigentlich erst Sinn, wenn man mit irgendwelchen Platzhaltern oder Quantifiern arbeitet.</p><p>Machen wir mal noch einen Vergleich mit dem <code>match</code>-Operator und schauen in die Variable rein.
Mein Text in dem ich etwas pr√ºfen m√∂chte, habe ich grob an HTML oder XML Code angelehnt.
Und mein Vergleichsmuster schaut nach den Tags mit dem Namen <code>&lt;test> &lt;/test></code> und dazwischen d√ºrfen dann 0 oder mehr beliebige Zeichen stehen.
Da das Ergebnis <code>True</code> ist, wird die <code>$Matches</code> Variable automatisch bef√ºllt.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;test&gt;.*&lt;/test&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;test&gt;Hallo&lt;/test&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=capture-groups>Capture Groups<a hidden class=anchor aria-hidden=true href=#capture-groups>#</a></h2><p>Mit Capture Groups k√∂nnen wir bestimmte Bereiche aus dem Text extrahieren. Auch mehrere Capture Groups in einer regular Expression sind m√∂glich, aber wir fangen erstmal mit einer an.<br>Bleiben wir mal bei dem Beispiel vom vorherigen Abschnitt. Wenn ich jetzt genau den Text extrahieren m√∂chte, der sich innerhalb der <code>&lt;test></code>-Tags befindet, dann ist der bisherige Code noch nicht optimal. Aber das Verwenden von Capture Groups ist eigentlich ganz einfach, wir m√ºssen einfach den Bereich den wir als Capture Group behandeln wollen in Runde Klammern <code>()</code> stecken. Das Ergebnis von Capture Groups landet ebenfalls in der <code>$Matches</code> Variable.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;test&gt;(.*)&lt;/test&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>1                              Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;test&gt;Hallo&lt;/test&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Die <code>$Matches</code> Variable ist √ºbrigens eine Hashtable. Der Eintrag mit dem Namen &ldquo;0&rdquo; gibt unseren gesamten gematchten String zur√ºck. Und wenn wir <em>eine</em> Capture Group verwenden, dann landet die im Eintrag &ldquo;1&rdquo;. Wenn wir noch mehr Capture Groups verwenden w√ºrden, dann k√∂nnte es auch noch mehr Eintr√§ge geben, dann w√ºrde einfach weiter hochnummeriert werden.</p><p>Zum Beispiel extrahiere ich hier drei Infos per Capture Groups:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;(.+)&gt;(.*)&lt;/(.+)&gt;&lt;/b&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>3                              test
</span></span></span><span style=display:flex><span><span style=color:#6c7986>2                              Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>1                              test
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Jetzt habe ich Eintr√§ge von 0-3 in meiner <code>$Matches</code> Variable. Wenn ihr die im Code weiter verarbeiten wollt, k√∂nnt ihr wie bei jeder anderen Hashtable auch, auf die einzelnen Eintr√§ge zugreifen. Zum Beispiel so:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>[<span style=color:#d0bf69>2</span>]
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>[<span style=color:#d0bf69>1</span>]
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>test
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Hier ein Bild um visuell zu zeigen, wo was gecaptured wird:<br><a href=/images/2024/2024-03-19_RegEx_Multiple_Capture_Groups.jpg><img loading=lazy src=/images/2024/2024-03-19_RegEx_Multiple_Capture_Groups.jpg alt="Mehrere RegEx Capture Groups" title="Mehrere RegEx Capture Groups"></a></p><p>Allerdings wird der Code durch diese Nummerierungen schnell un√ºbersichtlich. Um den Code besser verst√§ndlich zu machen, k√∂nnen wir &ldquo;Named Captures&rdquo; verwenden. Also Namen f√ºr unsere Capture Groups festlegen. Daf√ºr m√ºssen wir an den Anfang der Capture Group, aber innerhalb der runden Klammern, erstmal ein <code>?</code> schreiben und dann zwischen einem kleiner-als-Zeichen <code>&lt;</code> und einem Gr√∂√üer-als-Zeichen <code>></code> den gew√ºnschten Namen. Der Eintrag in der <code>$Matches</code>-Hashtable erh√§lt dann statt einer Nummer den gew√ºnschten Namen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;test&gt;(?&lt;MeinText&gt;.*)&lt;/test&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>MeinText                       Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;test&gt;Hallo&lt;/test&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>[<span style=color:#fc6a5d>&#34;MeinText&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Ein kleines Manko gibt es bei der Verwendung von Capture Groups mit dem <code>-match</code> Operator: Wenn ihr mehrfach matchen wollt, dann geht das nicht. Also wenn eure Regular Expression mehrfach zutrifft auf euren String, dann wird nur das erste Ergebnis zur√ºckgeliefert. Zum Beispiel so:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt; &lt;u&gt;&lt;test&gt;Moin&lt;/test&gt;&lt;/u&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;test&gt;(?&lt;MeinText&gt;.*?)&lt;/test&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>MeinText                       Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;test&gt;Hallo&lt;/test&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Der String den ich hier √ºberpr√ºft habe, enth√§lt zwei Bl√∂cke mit diesem <code>&lt;test></code>-Tag. Wenn ich jetzt in die <code>$Matches</code> Variable reinschaue, dann ist da aber trotzdem nur ein Treffer drin. Das l√§sst sich auch nicht anpassen bei der Verwendung des <code>-match</code> Operators. Wenn ihr mehrere Treffer matchen wollt und dabei vielleicht auch noch Capture Groups verwenden wollt, dann m√ºsst ihr eine andere Methode verwenden (zum Beispiel die <a href=#net-regex-matches>.NET Klasse <code>RegEx</code></a>).</p><h2 id=greedy-captures>Greedy Captures<a hidden class=anchor aria-hidden=true href=#greedy-captures>#</a></h2><p>Euch ist vielleicht beim letzten Beispiel im vorherigen Abschnitt (<a href=#capture-groups>Capture Groups</a>) aufgefallen, dass meine Regular Expression noch ein Fragezeichen <code>?</code> enth√§lt. Durch dieses Fragezeichen habe ich eingestellt, dass die RegEx Engine hier nicht wie im Standard &ldquo;greedy&rdquo; ist - (zu deutsch &ldquo;gierig&rdquo;). Normalerweise versucht die Engine im gierigen Modus soviele Zeichen wie m√∂glich mit der Regular Expression zu matchen. Das kann aber zu unerw√ºnschten Ergebnissen f√ºhren. Im Vergleich hier einmal das Ergebnis ohne das Fragezeichen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt; &lt;u&gt;&lt;test&gt;Moin&lt;/test&gt;&lt;/u&gt;&#34;</span> -match <span style=color:#fc6a5d>&#34;&lt;test&gt;(?&lt;MeinText&gt;.*)&lt;/test&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$Matches</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name                           Value
</span></span></span><span style=display:flex><span><span style=color:#6c7986>----                           -----
</span></span></span><span style=display:flex><span><span style=color:#6c7986>MeinText                       Hallo&lt;/test&gt;&lt;/b&gt; &lt;u&gt;&lt;test&gt;Moin
</span></span></span><span style=display:flex><span><span style=color:#6c7986>0                              &lt;test&gt;Hallo&lt;/test&gt;&lt;/b&gt; &lt;u&gt;&lt;test&gt;Moin&lt;/test&gt;
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=besonderheiten-und-tipps-zum-match-operator>Besonderheiten und Tipps zum match Operator<a hidden class=anchor aria-hidden=true href=#besonderheiten-und-tipps-zum-match-operator>#</a></h2><p>Eine Besonderheit beim <code>-match</code> Operator: Wenn ihr mehrere Objekte gleichzeitig als Eingabe nehmt, also zum Beispiel so:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo&#34;</span>, <span style=color:#fc6a5d>&#34;PowerShell&#34;</span>, <span style=color:#fc6a5d>&#34;test&#34;</span> -match <span style=color:#fc6a5d>&#34;.*o.*&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>PowerShell
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Dann kriegt ihr nicht <code>True</code> oder <code>False</code> zur√ºck, sondern jeweils alle Strings bei denen die Regular Expression erfolgreich gematched hat. In so einem Fall wird die automatische Variable <code>$Matches</code> auch <strong>nicht</strong> bef√ºllt. Also wenn da vorher etwas drin stand, dann ist noch der alte Wert drin. Und wenn zuvor noch nichts drin stand, dann steht da jetzt auch nichts drin.</p><p>Meine Praxistipps f√ºr den Match Operator sind wie folgt:</p><ol><li><p>Wenn ihr nur pr√ºfen wollt, ob ein Muster zutreffend ist, gibt es nicht viel zu beachten. Macht einfach eine <code>If</code>-Abfrage. Das funktioniert sowohl bei einem Objekt als Input, als auch mit mehreren.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$MeineVariable</span> = <span style=color:#fc6a5d>&#34;Kanal abonnieren&#34;</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>if</span>(<span style=color:#41a1c0>$MeineVariable</span> -match <span style=color:#fc6a5d>&#34;abo&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#6c7986># Das hier wird ausgef√ºhrt, wenn die Regular Expression True ergibt</span>
</span></span><span style=display:flex><span>    <span style=color:#fc6a5d>&#34;... und Video liken!&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></li><li><p>Ansonsten solltet ihr sicherstellen, dass ihr wisst wieviele Objekte ihr an <code>-match</code> √ºbergebt. Es ist ein ganz klassischer Fehler in der Programmlogik, dass nicht beachtet wird, dass ein Cmdlet auch mal mehr Objekte zur√ºcklieferen kann als nur eins. Um sicherzustellen, dass nur ein Objekt gepr√ºft wird, k√∂nnt ihr zum Beispiel mit <code>Select-Object -First 1</code> die R√ºckgabe auf ein Objekt beschr√§nken.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$MeineVariable</span> = <span style=color:#fc6a5d>&#34;User1@example.com&#34;</span>, <span style=color:#fc6a5d>&#34;User2@example.com&#34;</span> | <span style=color:#d0a8ff>Select-Object</span> -First <span style=color:#d0bf69>1</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>if</span>(<span style=color:#41a1c0>$MeineVariable</span> -match <span style=color:#fc6a5d>&#34;user&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#fc6a5d>&#34;User gefunden!&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#6c7986># irgendwas mit dem User machen</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Nur wenn ihr wirklich nur gegen ein Objekt matched, k√∂nnt ihr dem Inhalt der Variable <code>$Matches</code> vertrauen.</p></li><li><p>Wenn ihr eine Regular Expression habt, die mehrfach auf euren String passt, und ihr alle Treffer wissen wollt, und vielleicht sogar mit Capture Groups die Infos rausziehen wollt, dann ist der <code>-match</code> Operator daf√ºr <strong>nicht geeignet</strong>. Es gibt aber andere M√∂glichkeiten zum Beispiel die <a href=#net-regex-matches>.NET RegEx Klasse</a>.</p></li></ol><h2 id=der--replace-operator>Der -replace Operator<a hidden class=anchor aria-hidden=true href=#der--replace-operator>#</a></h2><p>Mit dem <code>-replace</code> Operator wird der Text der dem RegEx Muster entspricht durch einen anderen Text ersetzt.
Zun√§chst ein einfaches Beispiel, bei dem einfach das Zeichen <code>W</code> inklusive allem was danach folgt durch das Wort <code>PowerShell</code> ersetzt wird.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo Welt&#34;</span> -replace <span style=color:#fc6a5d>&#34;W.*&#34;</span>, <span style=color:#fc6a5d>&#34;PowerShell&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo PowerShell
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Aber der <code>-replace</code> Operator unterst√ºtzt auch Capture Groups. Und dann k√∂nnen wir die Capture Groups in unserem Ergebnis verwenden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Mit unbenannten Capture Groups</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;diecknet&lt;/test&gt;&lt;/b&gt;&#34;</span> -replace <span style=color:#fc6a5d>&#34;&lt;test&gt;(.*)&lt;/test&gt;&#34;</span>, <span style=color:#fc6a5d>&#39;Hallo $1&#39;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;#  
</span></span></span><span style=display:flex><span><span style=color:#6c7986>    Achtung! Hier ist es wichtig, dass mindestens der zweite Parameter von
</span></span></span><span style=display:flex><span><span style=color:#6c7986>    -replace mit einfachen Anf√ºhrungszeichen umschlossen ist. Ansonsten w√ºrde
</span></span></span><span style=display:flex><span><span style=color:#6c7986>    das $1 als PowerShell Variable interpretiert werden - es ist aber keine. 
</span></span></span><span style=display:flex><span><span style=color:#6c7986>    Es ist ein Platzhalter der auf eine Regular Expression Capture Group verweist. 
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span> 
</span></span><span style=display:flex><span><span style=color:#6c7986># Ergebnis = &lt;b&gt;Hallo diecknet&lt;/b&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Mit benannten Capture Groups</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;&lt;b&gt;&lt;test&gt;diecknet&lt;/test&gt;&lt;/b&gt;&#34;</span> -replace <span style=color:#fc6a5d>&#34;&lt;test&gt;(?&lt;MeinText&gt;.*)&lt;/test&gt;&#34;</span>, <span style=color:#fc6a5d>&#39;Hallo ${MeinText}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Ergebnis = &lt;b&gt;Hallo diecknet&lt;/b&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Die <code>$Matches</code> Variable wird √ºbrigens <strong>nicht</strong> bef√ºllt, wenn wir den <code>-replace</code> Operator verwenden. Falls sie bei euch noch gesetzt ist, dann ist das noch von einem vorherigen Vergleich per <code>-match</code> Operator.</p><h2 id=der--split-operator>Der -split Operator<a hidden class=anchor aria-hidden=true href=#der--split-operator>#</a></h2><p>Mit dem <code>-split</code> Operator k√∂nnt ihr Strings aufteilen. Und auch hier k√∂nnen nicht nur einfache Zeichenfolgen als Trennzeichen verwendet werden, sondern auch Regular Expressions.
Einfaches Beispiel:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo Welt!&#34;</span> -split <span style=color:#fc6a5d>&#34; &#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Welt!
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Und ein komplexeres Beispiel:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Hallo Welt! In diesem Text wird jedes mal getrennt, wenn ein Satzzeichen auftaucht. Sinnvoll? Eher nicht.&#34;</span> -split <span style=color:#fc6a5d>&#34;[\.,!?]&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Hallo Welt
</span></span></span><span style=display:flex><span><span style=color:#6c7986> In diesem Text wird jedes mal getrennt
</span></span></span><span style=display:flex><span><span style=color:#6c7986> wenn ein Satzzeichen auftaucht
</span></span></span><span style=display:flex><span><span style=color:#6c7986> Sinnvoll
</span></span></span><span style=display:flex><span><span style=color:#6c7986> Eher nicht
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Der <code>-split</code> Operator unterst√ºtzt noch ein paar weitere Optionen. Ich finde es aber nicht so interessant und habe keine coolen Beispiele. Schaut daf√ºr am besten in die Dokumentation bei Microsoft: <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_split?view=powershell-7.4" target=_blank>https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_split?view=powershell-7.4</a></p><h2 id=select-string-cmdlet>Select-String Cmdlet<a hidden class=anchor aria-hidden=true href=#select-string-cmdlet>#</a></h2><p>Mit dem Cmdlet <code>Select-String</code> kann ein String oder ein Dateiinhalt mit einer Regular Expression verglichen werden. Oder auch mehrere Strings oder Dateiinhalte.
Zum Beispiel vergleiche ich hier mehrere Objekte, in dem Fall einfache Strings, indem ich sie per Pipeline an <code>Select-Object</code> √ºbergebe.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Der Parameter -Pattern legt die Regular Expression fest</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Moin und hallo!&#34;</span>,<span style=color:#fc6a5d>&#34;Boink!&#34;</span>,<span style=color:#fc6a5d>&#34;Test&#34;</span> | <span style=color:#d0a8ff>Select-String</span> -Pattern <span style=color:#fc6a5d>&#34;oi&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Moin und hallo!
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Boink
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Von den drei Objekten erhalte ich nur zwei zur√ºck, da nur zwei dem Muster entsprechen. In der PowerShell 7 wird es sogar auch noch in der Konsole hervorgehoben, wo das Muster zutrifft.</p><p><a href=/images/2024/2024-03-19_RegEx_Highlight_in_PS7.jpg><img loading=lazy src=/images/2024/2024-03-19_RegEx_Highlight_in_PS7.jpg alt="Highlight der Suchtreffer bei Select-String in PowerShell 7" title="Highlight der Suchtreffer bei Select-String in PowerShell 7"></a></p><p>Auch bei <code>Select-String</code> wird die Gro√ü- und Kleinschreibung im Standard erstmal ignoriert. Wenn ihr wollt, dass sie beim Vergleichen beachtet wird, dann k√∂nnt ihr den zus√§tzlichen Parameter <code>-CaseSensitive</code> mit angeben. Au√üerdem k√∂nnt ihr die √úberpr√ºfung auch umdrehen, indem ihr den Parameter <code>-NotMatch</code> angebt. Dann w√ºrden nur die Strings zur√ºckgegeben werden, die nicht dem Muster entsprechen.
Aber diese Sachen k√∂nnten wir ja auch schon mit dem <code>-match</code> Operator erreichen. Was ich dann interessanter finde, ist die M√∂glichkeit eine oder mehrere Dateien zu pr√ºfen.
Zum Beispiel √ºberpr√ºfe ich so alle Dateien mit der Dateiendung <code>.log</code> im Verzeichnis <code>C:\diecknet</code>:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*.log&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;password&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_RegEx_Select-String-Files.jpg><img loading=lazy src=/images/2024/2024-03-19_RegEx_Select-String-Files.jpg alt="Highlight der Suchtreffer in einer Datei bei Select-String in PowerShell 7" title="Highlight der Suchtreffer in einer Datei bei Select-String in PowerShell 7"></a></p><p>Wenn wir jetzt eine oder mehrere Textdateien mit dem Cmdlet pr√ºfen, dann kriegen wir bei den Suchtreffern auch noch die Information in welcher Datei sich der Treffer befindet und in welcher Zeile.
Manchmal m√∂chte man aber noch ein bisschen mehr Infos bekommen, ein bisschen Kontext. Daf√ºr gibt es den Parameter <code>-Context</code>. Da kann ich wahlweise eine Zahl angeben, und soviele Zeilen kriege ich dann dar√ºber und darunter mit ausgegeben.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*.log&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;password&#34;</span> -Context <span style=color:#d0bf69>1</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_RegEx_Select-String-Files-Context.jpg><img loading=lazy src=/images/2024/2024-03-19_RegEx_Select-String-Files-Context.jpg alt="Highlight der Suchtreffer in einer Datei bei Select-String in PowerShell 7 mit Kontext" title="Highlight der Suchtreffer in einer Datei bei Select-String in PowerShell 7 mit Kontext"></a></p><p>Die tats√§chliche Zeile mit dem Suchergebnis ist dann mit einem Gr√∂√üer-als-Zeichen <code>></code> markiert.</p><p>Wir k√∂nnen aber auch getrennt steuern, wieviele Zeilen davor und danach wir erhalten m√∂chten. Daf√ºr einfach zwei Zahlen als Parameterwert angeben und mit einem Komma trennen. In folgendem Beispiel werden eine Zeile davor und 5 danach zur√ºckgegeben.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*.log&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;password&#34;</span> -Context <span style=color:#d0bf69>1</span>,<span style=color:#d0bf69>5</span>
</span></span></code></pre></td></tr></table></div></div><p>Das was uns hier von <code>Select-String</code> zur√ºckgeliefert wird, ist √ºbrigens auch mehr als einfach nur Text. Tats√§chlich kriegen wir hier Objekte vom Typ <code>MatchInfo</code> zur√ºck.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;test&#34;</span> -Context <span style=color:#d0bf69>1</span> | <span style=color:#d0a8ff>Get-Member</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_Select-String-Object-Infos.jpg><img loading=lazy src=/images/2024/2024-03-19_Select-String-Object-Infos.jpg alt="Die R√ºckgabe von Select-String ist ein MatchInfo Objekt" title="Die R√ºckgabe von Select-String ist ein MatchInfo Objekt"></a></p><p>Das MatchInfo Objekt hat einige interessante Eigenschaften, auf die wir dann per Code zugreifen k√∂nnen. Wir k√∂nnten beispielsweise auch per Code die genaue Zeilennummer eines Datei-Treffers herausfinden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Ergebnisse</span> = <span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*.log&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;password&#34;</span> -Context <span style=color:#d0bf69>1</span>,<span style=color:#d0bf69>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>foreach</span>(<span style=color:#41a1c0>$Ergebnis</span> <span style=color:#fc5fa3>in</span> <span style=color:#41a1c0>$Ergebnisse</span>) {
</span></span><span style=display:flex><span>    <span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Treffer in </span>$(<span style=color:#41a1c0>$Ergebnis</span>.FileName)<span style=color:#fc6a5d> in Zeile </span>$(<span style=color:#41a1c0>$Ergebnis</span>.LineNumber)<span style=color:#fc6a5d>:&#34;</span> -ForegroundColor Red
</span></span><span style=display:flex><span>    <span style=color:#d0a8ff>Write-Host</span> <span style=color:#41a1c0>$Ergebnis</span>.Line -ForegroundColor Yellow
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_Select-String-Object-Properties.jpg><img loading=lazy src=/images/2024/2024-03-19_Select-String-Object-Properties.jpg alt="Beispiel f√ºr die Weiterverarbeitung der R√ºckgabe von Select-String" title="Beispiel f√ºr die Weiterverarbeitung der R√ºckgabe von Select-String"></a></p><p>Falls ihr euch f√ºr mehrere Treffer in einer Zeile interessiert, dann k√∂nnt ihr das auch aktivieren mit dem Parameter <code>-AllMatches</code>.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Select-String</span> -Path <span style=color:#fc6a5d>&#34;C:\diecknet\*.log&#34;</span> -Pattern <span style=color:#fc6a5d>&#34;password&#34;</span> -AllMatches
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_Select-String-Multiple-Matches.jpg><img loading=lazy src=/images/2024/2024-03-19_Select-String-Multiple-Matches.jpg alt="Beispiel f√ºr die R√ºckgabe von Select-String bei Verwendung des AllMatches Parameters" title="Beispiel f√ºr die R√ºckgabe von Select-String bei Verwendung des AllMatches Parameters"></a></p><h2 id=switch-statement-mit--regex-parameter>Switch Statement mit -RegEx Parameter<a hidden class=anchor aria-hidden=true href=#switch-statement-mit--regex-parameter>#</a></h2><p>Beim <code>Switch</code> Statement k√∂nnen auch regul√§re Ausdr√ºcke verwendet werden. Daf√ºr muss der Parameter <code>-RegEx</code> mit angegeben werden. Bei jedem Bedingungsblock des Switch Statements kann dann ein regul√§rer Ausdruck eingetragen werden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$MeinString</span> = <span style=color:#fc6a5d>&#34;&lt;h1&gt;Hallo!&lt;/h1&gt;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>switch</span> -Regex ( <span style=color:#41a1c0>$MeinString</span> ) {
</span></span><span style=display:flex><span>    <span style=color:#fc6a5d>&#34;&lt;.+&gt;&#34;</span> { <span style=color:#fc6a5d>&#34;Sieht aus wie eine HTML-Seite!&#34;</span> }
</span></span><span style=display:flex><span>    <span style=color:#fc6a5d>&#34;\d{5}&#34;</span> { <span style=color:#fc6a5d>&#34;Enth√§lt eine 5-stellige Zahl!&#34;</span> }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Sieht aus wie eine HTML-Seite!
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=net-regex-matches>.NET RegEx Matches<a hidden class=anchor aria-hidden=true href=#net-regex-matches>#</a></h2><p>Die m√§chtigste M√∂glichkeit um Regular Expressions in der PowerShell zu verwenden, ist meiner Meinung nach die .NET Klasse <code>RegEx</code>. Es gibt verschiedene M√∂glichkeiten die Klasse zu benutzen. Die einfachste ist meiner Meinung nach Folgende:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$TestString</span> = <span style=color:#fc6a5d>&#34;Hall√∂chen&#34;</span>
</span></span><span style=display:flex><span>[regex]::Matches(<span style=color:#41a1c0>$TestString</span>, <span style=color:#fc6a5d>&#39;Ha&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Groups    : {0}
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Success   : True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name      : 0
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Captures  : {0}
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Index     : 0
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Length    : 2
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Value     : Ha
</span></span></span><span style=display:flex><span><span style=color:#6c7986>ValueSpan :
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Wenn die Regular Expression erfolgreich gegen den String gematched wurde, dann erhaltet ihr ein Match Objekt zur√ºck. Daran ist dann unter anderem erkennbar, dass das Muster erkannt wurde. Und ihr k√∂nnt per Code auf die Eigenschaften zugreifen.
Ich benutze die .NET Variante hier vorallem wenn ich mehrere Infos auf einmal per Capture Groups rausziehen m√∂chte. Also nicht einfach nur mehrere Capture Groups, sondern dass das Muster mehrfach zutrifft. Ich habe hier zum Beispiel eine Text-Datei mit folgendem Inhalt (das ist √ºbrigens alles in einer Zeile):</p><p><a href=/images/2024/2024-03-19_FileContent-example.jpg><img loading=lazy src=/images/2024/2024-03-19_FileContent-example.jpg alt="Beispiel f√ºr die R√ºckgabe von mehreren Treffern bei Verwendung der Matches Methode aus der .NET Klasse RegEx" title="Beispiel f√ºr die R√ºckgabe von mehreren Treffern bei Verwendung der Matches Methode aus der .NET Klasse RegEx"></a></p><p>Mit folgendem PowerShell Code lese ich die Text-Datei zun√§chst ein und pr√ºfe dann mit der <code>[regex]::Matches()</code> Methode ob ein Muster darauf zutrifft.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$MeinString</span> = <span style=color:#d0a8ff>Get-Content</span> C:\diecknet\<span style=color:#d0a8ff>net-beispiel</span>.txt
</span></span><span style=display:flex><span>[regex]::Matches(<span style=color:#41a1c0>$MeinString</span>, <span style=color:#fc6a5d>&#39;\b([a-f0-9]{32})\b&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-03-19_RegEx-Net-Class-Matches.jpg><img loading=lazy src=/images/2024/2024-03-19_RegEx-Net-Class-Matches.jpg alt="Beispiel f√ºr die R√ºckgabe von mehreren Treffern bei Verwendung der Matches Methode aus der .NET Klasse RegEx" title="Beispiel f√ºr die R√ºckgabe von mehreren Treffern bei Verwendung der Matches Methode aus der .NET Klasse RegEx"></a></p><p>Der Code extrahiert alle Zeichenfolgen die exakt 32 Zeichen lang sind und ausschlie√ülich aus Hexadezimalen Zeichen bestehen. Dabei hat die Regular Expression <code>\b([a-f0-9]{32})\b</code> genau eine Capture Group. Da ich die <code>Matches</code> Methode aus der <code>RegEx</code> Klasse aufgerufen habe, kriege ich nicht nur den ersten Suchtreffer zur√ºck, sondern alle.</p><p><strong>Wichtig: Bei der .NET Klasse <code>RegEx</code> solltet ihr genau auf die Gro√ü- und Kleinschreibung achten!</strong> Im Gegensatz zu den anderen RegEx M√∂glichkeiten in der PowerShell, ist sie standardm√§√üig case-sensitive. Der folgende Code w√ºrde keinen Treffer im String finden:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$TestString</span> = <span style=color:#fc6a5d>&#34;Hall√∂chen&#34;</span>
</span></span><span style=display:flex><span>[regex]::Matches(<span style=color:#41a1c0>$TestString</span>, <span style=color:#fc6a5d>&#39;ha&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#6c7986># Keine R√ºckgabe, auf Grund der Gro√ü- und Kleinschreibung.</span>
</span></span></code></pre></td></tr></table></div></div><p>Aber die .NET <code>[RegEx]::Matches()</code> Methode unterst√ºtzt diverse Optionen. Unser bisheriges Beispiel kann um einen dritten Parameter erg√§nzt werden, um auch hier die Gro√ü- und Kleinschreibung zu ignorieren:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$TestString</span> = <span style=color:#fc6a5d>&#34;Hall√∂chen&#34;</span>
</span></span><span style=display:flex><span>[regex]::Matches(<span style=color:#41a1c0>$TestString</span>, <span style=color:#fc6a5d>&#39;ha&#39;</span>, <span style=color:#fc6a5d>&#39;IgnoreCase&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Groups    : {0}
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Success   : True
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Name      : 0
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Captures  : {0}
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Index     : 0
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Length    : 2
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Value     : Ha
</span></span></span><span style=display:flex><span><span style=color:#6c7986>ValueSpan :
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>üí° Weitere Optionen k√∂nnt ihr hier in der Microsoft Dokumentation finden: <a href="https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-options?redirectedfrom=MSDN" target=_blank>https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-options?redirectedfrom=MSDN</a></p><p>Au√üerdem gibt es noch weitere Methoden in der <code>RegEx</code> Klasse, die je nach Anwendungsfall auch noch sehr praktisch sein k√∂nnen. Schaut daf√ºr in die Dokumentation zur <code>RegEx</code> Klasse: <a href="https://learn.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex?view=net-8.0#methods" target=_blank>https://learn.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex?view=net-8.0#methods</a></p><h2 id=regular-expressions-entwerfen>Regular Expressions entwerfen<a hidden class=anchor aria-hidden=true href=#regular-expressions-entwerfen>#</a></h2><p>Okay, kommen wir also dazu wie ihr Regular Expressions entwerfen k√∂nnt. Wie zum Beispiel die Expression von eben: <code>\b([a-f0-9]{32})\b</code>
Also ganz ehrlich: Ich finde Regular Expressions sind nicht einfach. Ich habe nicht genug Erfahrung mit Regular Expressions, dass ich die einfach so runtertippe ohne irgendwelche Hilfe. Aber ich guck eigentlich gar nicht erst in die <a href=https://learn.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference target=_blank>Microsoft Dokumentation zu RegEx in .NET</a> oder <a href=https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_regular_expressions target=_blank>PowerShell</a>. Stattdessen nehme ich ein Tool um ein RegEx Muster zu entwerfen. Es gibt einige kostenlose Websites, mit denen man Regular Expressions im Browser bauen kann und direkt live gegen einen oder mehrere Strings testen kann. Ich habe in letzter Zeit gerne <a href=https://regex101.com target=_blank>RegEx101.com</a> verwendet, weil dort auch speziell mit Bezug auf die .NET Eigenheiten gearbeitet werden kann. In der Vergangenheit habe ich auch andere allgemeinere Websites benutzt, die dann z.B. eher an JavaScript orientiert sind. Aber meistens hat das auch richtig funktioniert. Keine Ahnung wie seri√∂s diese <a href=https://regex101.com target=_blank>RegEx101.com</a> Seite ist, also ich w√ºrde da jetzt keine personenbezogenen Daten oder sonst wie was kritisches reintun.
<strong>Wichtig:</strong> Auf der Seite m√ºsst ihr links den Flavor auf &ldquo;.NET&rdquo; umstellen.</p><p>Wenn ihr jetzt ein Muster entwerfen wollt, dann schaut unten rechts in den Bereich &ldquo;Quick Reference&rdquo;. Dort werden alle m√∂glichen Platzhalter und Spezialzeichen erkl√§rt. Au√üerdem gibt es den Bereich Explanation, der die erstellte Regular Expression erkl√§rt. Sehr nice!</p><h2 id=schlusswort>Schlusswort<a hidden class=anchor aria-hidden=true href=#schlusswort>#</a></h2><p>Das waren meiner Meinung nach die wichtigsten M√∂glichkeiten Regular Expressions in der PowerShell zu verwenden. Vermutlich gibt auch noch mehr M√∂glichkeiten. Aber das Grundprinzip das war hoffentlich verst√§ndlich, sodass ihr Regular Expressions hoffentlich auch an den anderen Stellen anwenden k√∂nnt.</p><p><strong>Ein wichtiger Hinweis noch:</strong> Wenn ihr nur einen einfachen Vergleich durchf√ºhren wollt, ist es empfehlenswert Regular Expressions <strong>gar nicht</strong> erst zu verwenden. Denn die Verwendung der RegEx Engine hat einen gewissen Overhead. Im Zweifelsfall testen und Zeit messen!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li><li><a href=https://diecknet.de/de/tags/regex/>Regex</a></li><li><a href=https://diecknet.de/de/tags/regular-expressions/>Regular Expressions</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>