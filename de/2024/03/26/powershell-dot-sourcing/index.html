<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Dot Sourcing | diecknet</title>
<meta name=keywords content="powershell"><meta name=description content="Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl include, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/03/26/powershell-dot-sourcing/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/03/26/powershell-dot-sourcing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Dot Sourcing"><meta property="og:description" content="Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl include, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/03/26/powershell-dot-sourcing/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-26T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Dot Sourcing"><meta name=twitter:description content="Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl include, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Dot Sourcing","item":"https://diecknet.de/de/2024/03/26/powershell-dot-sourcing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Dot Sourcing","name":"PowerShell Dot Sourcing","description":"Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl include, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\n","keywords":["powershell"],"articleBody":"Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl include, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nNormaler Skript-Aufruf Zum Vergleich: Normalerweise w√ºrde man ein Skript ja wie folgt ausf√ºhren. Entweder mit einem relativen Pfad oder mit einem absoluten Pfad.\n1 2 3 4 5 # Relativer Pfad .\\MeinSkript.ps1 # Absoluter Pfad: \u0026 C:\\diecknet\\MeinSkript.ps1 Wenn das Skript ‚Äúnormal‚Äù ausgef√ºhrt wird, dann sehe ich zwar eventuelle Ausgaben des Skriptes, aber Funktionen oder Variablen aus dem Skript sind nicht mehr verf√ºgbar. Im nachfolgenden Screenshot sind zum Beispiel die Funktion Test-BeispielFunktion und die Variable $TestVariable aus dem Skript nicht in der Session verf√ºgbar.\nAufruf per Dot Sourcing Beim Dot Sourcing wird stattdessen ein Punkt und dann ein Leerzeichen vor den Pfad gesetzt. Auch beim Dot Sourcing kann sowohl ein relativer, als auch ein absoluter Pfad verwendet werden.\n1 2 3 4 5 # Relativer Pfad . .\\MeinSkript.ps1 # Absoluter Pfad: . C:\\diecknet\\MeinSkript.ps1 Wenn ich das Skript per Dot Sourcing ausf√ºhre, dann wird nicht nur der Code ausgef√ºhrt, sondern alles in den Global Scope der PowerShell Session importiert. Also kann ich jetzt zum Beispiel auf eine im Skript definierte Funktion zugreifen, oder mir den Inhalt einer Variable anzeigen. Im nachfolgenden Screenshot sind beispielsweise die Funktion Test-BeispielFunktion und die Variable $TestVariable die im Skript definiert wurden auch danach noch in der Session verf√ºgbar.\nWann Dot Sourcing verwenden? Ich verwende Dot Sourcing, wenn ich eine Funktion wiederverwenden m√∂chte, ohne daf√ºr direkt ein ganzes PowerShell Modul zu erstellen. Und das Importieren per Dot Sourcing funktioniert nat√ºrlich sowohl in der Konsole, als auch in Skriptdateien.\n√úbrigens: Visual Studio Code und die PowerShell ISE f√ºhren Code standardm√§√üig auch per Dot Sourcing aus. Deshalb ist dort auch zum Beispiel der Inhalt von Variablen nach der Ausf√ºhrung des Codes verf√ºgbar.\n","wordCount":"344","inLanguage":"de","datePublished":"2024-03-26T00:00:00Z","dateModified":"2024-03-26T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/03/26/powershell-dot-sourcing/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell Dot Sourcing</h1><div class=post-meta><span title='2024-03-26 00:00:00 +0000 UTC'>2024-03-26</span>&nbsp;¬∑&nbsp;2 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-03-26-PowerShell-Dot-Sourcing.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#normaler-skript-aufruf aria-label="Normaler Skript-Aufruf">Normaler Skript-Aufruf</a></li><li><a href=#aufruf-per-dot-sourcing aria-label="Aufruf per Dot Sourcing">Aufruf per Dot Sourcing</a></li><li><a href=#wann-dot-sourcing-verwenden aria-label="Wann Dot Sourcing verwenden?">Wann Dot Sourcing verwenden?</a></li></ul></div></details></div><div class=post-content><p>Mit PowerShell Dot Sourcing k√∂nnt ihr eine Skriptdatei in eure PowerShell Session importieren. Das Skript wird erstmal normal ausgef√ºhrt, aber gesetzte Variablen, erstellte Funktionen und so weiter sind dann in der Session verf√ºgbar. Bei einem normalen Skript-Aufruf ist das sonst nicht der Fall. Mich erinnert das immer an den PHP-Befehl <code>include</code>, weil ich in meiner Jugend mit PHP rumgedaddelt habe üòÖ</p><p><strong>üé¨ Ich habe √ºbrigens auch ein <a href=https://youtu.be/TTnKAU-Po7Q target=_blank>Video zu dem Thema erstellt.</a></strong></p><h2 id=normaler-skript-aufruf>Normaler Skript-Aufruf<a hidden class=anchor aria-hidden=true href=#normaler-skript-aufruf>#</a></h2><p>Zum Vergleich: Normalerweise w√ºrde man ein Skript ja wie folgt ausf√ºhren. Entweder mit einem relativen Pfad oder mit einem absoluten Pfad.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Relativer Pfad</span>
</span></span><span style=display:flex><span>.\MeinSkript.ps1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Absoluter Pfad:</span>
</span></span><span style=display:flex><span>&amp; C:\diecknet\MeinSkript.ps1
</span></span></code></pre></td></tr></table></div></div><p>Wenn das Skript &ldquo;normal&rdquo; ausgef√ºhrt wird, dann sehe ich zwar eventuelle Ausgaben des Skriptes, aber Funktionen oder Variablen aus dem Skript sind nicht mehr verf√ºgbar. Im nachfolgenden Screenshot sind zum Beispiel die Funktion <code>Test-BeispielFunktion</code> und die Variable <code>$TestVariable</code> aus dem Skript nicht in der Session verf√ºgbar.</p><p><a href=/images/2024/2024-03-25_No_DotSourcing.jpg><img loading=lazy src=/images/2024/2024-03-25_No_DotSourcing.jpg alt="Beispiel f√ºr einen normalen Skript-Aufruf: Variablen und Funktionen aus dem Skript sind NICHT in der Session verf√ºgbar" title="Beispiel f√ºr einen normalen Skript-Aufruf: Variablen und Funktionen aus dem Skript sind NICHT in der Session verf√ºgbar"></a></p><h2 id=aufruf-per-dot-sourcing>Aufruf per Dot Sourcing<a hidden class=anchor aria-hidden=true href=#aufruf-per-dot-sourcing>#</a></h2><p>Beim Dot Sourcing wird stattdessen ein Punkt und dann ein Leerzeichen vor den Pfad gesetzt. Auch beim Dot Sourcing kann sowohl ein relativer, als auch ein absoluter Pfad verwendet werden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Relativer Pfad</span>
</span></span><span style=display:flex><span>. .\MeinSkript.ps1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Absoluter Pfad:</span>
</span></span><span style=display:flex><span>. C:\diecknet\MeinSkript.ps1
</span></span></code></pre></td></tr></table></div></div><p>Wenn ich das Skript per Dot Sourcing ausf√ºhre, dann wird <em>nicht nur</em> der Code ausgef√ºhrt, sondern alles in den <strong>Global Scope</strong> der PowerShell Session importiert. Also kann ich jetzt zum Beispiel auf eine im Skript definierte Funktion zugreifen, oder mir den Inhalt einer Variable anzeigen. Im nachfolgenden Screenshot sind beispielsweise die Funktion <code>Test-BeispielFunktion</code> und die Variable <code>$TestVariable</code> die im Skript definiert wurden auch danach noch in der Session verf√ºgbar.</p><p><a href=/images/2024/2024-03-25_DotSourcing_Example.jpg><img loading=lazy src=/images/2024/2024-03-25_DotSourcing_Example.jpg alt="Beispiel f√ºr Dot Sourcing: Variablen und Funktionen aus dem Skript sind in der Session verf√ºgbar" title="Beispiel f√ºr Dot Sourcing: Variablen und Funktionen aus dem Skript sind in der Session verf√ºgbar"></a></p><h2 id=wann-dot-sourcing-verwenden>Wann Dot Sourcing verwenden?<a hidden class=anchor aria-hidden=true href=#wann-dot-sourcing-verwenden>#</a></h2><p>Ich verwende Dot Sourcing, wenn ich eine Funktion wiederverwenden m√∂chte, ohne daf√ºr direkt ein ganzes PowerShell Modul zu erstellen. Und das Importieren per Dot Sourcing funktioniert nat√ºrlich sowohl in der Konsole, als auch in Skriptdateien.</p><p>√úbrigens: Visual Studio Code und die PowerShell ISE f√ºhren Code standardm√§√üig auch per Dot Sourcing aus. Deshalb ist dort auch zum Beispiel der Inhalt von Variablen nach der Ausf√ºhrung des Codes verf√ºgbar.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>