<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Profile erkl√§rt (mit Beispielen) | diecknet</title>
<meta name=keywords content="powershell,profiles,customization"><meta name=description content="Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:
Oder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:
Oder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Letztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/03/05/powershell-profiles/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/03/05/powershell-profiles/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Profile erkl√§rt (mit Beispielen)"><meta property="og:description" content="Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:
Oder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:
Oder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Letztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/03/05/powershell-profiles/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Profile erkl√§rt (mit Beispielen)"><meta name=twitter:description content="Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:
Oder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:
Oder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Letztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Profile erkl√§rt (mit Beispielen)","item":"https://diecknet.de/de/2024/03/05/powershell-profiles/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Profile erkl√§rt (mit Beispielen)","name":"PowerShell Profile erkl√§rt (mit Beispielen)","description":"Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:\nOder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:\nOder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nLetztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet.","keywords":["powershell","profiles","customization"],"articleBody":"Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:\nOder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:\nOder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.\nüé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nLetztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet. Die PowerShell schaut beim Start automatisch in bestimmten Pfaden, ob eine Profildatei vorhanden ist. Es k√∂nnen aber auch mehrere Profile vorhanden sein. So kann dann zum Beispiel ein User-spezifisches Profil angelegt werden und auch ein systemweites. Au√üerdem k√∂nnen unterschiedliche PowerShell Konsolenhosts auch noch separate Profile haben. So kann dann zum Beispiel VSCode oder die PowerShell ISE anders konfiguriert werden, als die normale PowerShell Konsole (falls es gew√ºnscht ist). Und die Windows PowerShell hat auch nochmal Profile die unabh√§ngig sind von der PowerShell 7. Also es gibt sehr viele Orte wo ein Profil liegen kann.\nTipp: PowerShell ohne Profile starten √úbrigens die PowerShell versucht normalerweise immer Profile zu laden wenn sie gestartet wird. Aber es ist auch m√∂glich die PowerShell mit dem zus√§tzlichen Parameter -NoProfile zu starten und dann wird sie ganz ohne Profile gestartet - kann manchmal n√ºtzlich sein.\n1 2 3 4 5 # F√ºr Windows PowerShell powershell.exe -NoProfile # F√ºr PowerShell 7 pwsh -NoProfile Profil Speicherorte Die genauen Profil Speicherorte sind bei Microsoft dokumentiert. Hier die Infos zu PowerShell 7.4 und hier f√ºr die Windows PowerShell 5.1.\nAber die Pfade sind auch einfach per PowerShell abrufbar - daf√ºr gibt es in der PowerShell eine automatische Variable names $PROFILE. Die zeigt erstmal den Profilpfad zu ‚ÄúCurrent user, current host‚Äù, also das Profil was so spezifisch ist wie es geht. Aber auch die anderen Pfade sind dar√ºber abrufbar. Daf√ºr k√∂nnt ihr die Variable einmal in Select-Object pipen. Beispielsweise wird mir in der Windows PowerShell 5.1 folgendes zur√ºckgegeben:\n1 2 3 4 5 6 7 8 9 10 11 $PROFILE | Select-Object * \u003c# Beispiel R√ºckgabe aus Windows PowerShell 5.1: AllUsersAllHosts : C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\profile.ps1 AllUsersCurrentHost : C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\Microsoft.PowerShell_profile.ps1 CurrentUserAllHosts : C:\\Users\\diecknet\\Documents\\WindowsPowerShell\\profile.ps1 CurrentUserCurrentHost : C:\\Users\\diecknet\\Documents\\WindowsPowerShell\\\\Microsoft.PowerShell_profile.ps1 Length : 78 #\u003e Und in PowerShell 7.4 erhalte ich folgende R√ºckgabe:\n1 2 3 4 5 6 7 8 9 10 11 $PROFILE | Select-Object * \u003c# Beispiel R√ºckgabe aus PowerShell 7.4: AllUsersAllHosts : C:\\Program Files\\PowerShell\\7\\profile.ps1 AllUsersCurrentHost : C:\\Program Files\\PowerShell\\7\\Microsoft.PowerShell_profile.ps1 CurrentUserAllHosts : C:\\Users\\diecknet\\Documents\\PowerShell\\profile.ps1 CurrentUserCurrentHost : C:\\Users\\diecknet\\Documents\\PowerShell\\Microsoft.PowerShell_profile.ps1 Length : 71 #\u003e Wenn ihr jetzt ein Profil bearbeiten wollt, dann k√∂nnt ihr direkt aus der PowerShell notepad oder VSCode mit $PROFILE als Parameterwert aufrufen. Dadurch √∂ffnet sich euer Bearbeitungsprogramm direkt mit der Profildatei. Die meisten modernen Editoren k√∂nnen dann die Profildatei direkt erstellen, falls sie noch nicht vorhanden sein sollte. Manche √§ltere Editoren geben aber nur eine Fehlermeldung zur√ºck, falls die Datei noch gar nicht existiert.\n1 2 3 4 5 # Das \"Current User, Current Host\" Profil per Visual Studio Code bearbeiten: code $PROFILE # Das \"Current User, All Hosts\" Profil per notepad bearbeiten: notepad $PROFILE.CurrentUserAllHosts Wenn ihr ein ‚ÄúAll Users‚Äù Profil bearbeiten wollt, dann m√ºsst ihr √ºbrigens den Editor daf√ºr mit Admin-Rechten starten. Beziehungsweise wenn ihr direkt per PowerShell euren Editor starten wollt und die Profildatei laden wollt, dann sollte die PowerShell schon mit Adminrechten laufen.\nProfil Beispiele Hier ein paar Beispiele f√ºr Konfigurationen, die man in einem PowerShell Profil setzen k√∂nnte.\nWichtig: Damit die Profil√§nderungen aktiv werden, m√ºsst ihr die PowerShell einmal neustarten.\nPSReadLine Optionen Ich habe bei mir in meiner Demo-VM eingestellt, dass keine Autovervollst√§ndigung in der PowerShell passieren soll. Finde ich sonst n√§mlich nervig bei der Erstellung von Videos und Blog Posts. Daf√ºr habe ich in meinem Profil folgendes stehen:\n1 Set-PSReadLineOption -PredictionSource None Diese Einstellung l√§uft √ºber das Modul PSReadLine. Das Modul kann genutzt werden, um die PowerShell Konsole vielf√§ltig anzupassen. Es k√∂nnen zum Beispiel auch Tastenkombinationen eingestellt werden. Oder hier ein cooles Beispiel von der PSReadLine GitHub Projektseite:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Set-PSReadLineKeyHandler -Chord '\"',\"'\" ` -BriefDescription SmartInsertQuote ` -LongDescription \"Insert paired quotes if not already on a quote\" ` -ScriptBlock { param($key, $arg) $line = $null $cursor = $null [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref]$line, [ref]$cursor) if ($line.Length -gt $cursor -and $line[$cursor] -eq $key.KeyChar) { # Just move the cursor [Microsoft.PowerShell.PSConsoleReadLine]::SetCursorPosition($cursor + 1) } else { # Insert matching quotes, move cursor to be in between the quotes [Microsoft.PowerShell.PSConsoleReadLine]::Insert(\"$($key.KeyChar)\" * 2) [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref]$line, [ref]$cursor) [Microsoft.PowerShell.PSConsoleReadLine]::SetCursorPosition($cursor - 1) } } Das sorgt daf√ºr, dass wenn man ein Anf√ºhrungszeichen in der Shell eingibt, automatisch ein schlie√üendes Anf√ºhrungszeichen eingef√ºgt wird - und der Cursor wird dazwischen platziert. Wenn ihr mehr zu PSReadLine wissen wollt, dann schaut mal in die Dokumentation dazu.\nEigene Cmdlets und Aliase Wenn ihr wollt, k√∂nnt ihr auch eigene Cmdlets oder Aliase im PowerShell Profil definieren, die dann automatisch in eurer PowerShell Session verf√ºgbar sind. Zum Beispiel:\n1 2 3 function blog { Set-Location C:\\dev\\diecknet-blog } Dadurch kann ich schnell und einfach mit dem Befehl blog in mein lokales Verzeichnis wechseln, wo der Quellcode zu meinem Blog liegt. Oder ich kann mir den Alias reboot anlegen, der auf das Cmdlet Restart-Computer zeigt.\n1 New-Alias -Name reboot -Value Restart-Computer Standardwerte f√ºr Cmdlets festlegen Ihr k√∂nnt auch Standardwerte f√ºr bestimmte Cmdlet-Parameter festlegen. Das geht mit der Variable $PSDefaultParameterValues - das ist eine Hashtable in die bei Bedarf Eintr√§ge mit Cmdlet und Parameternamen eingetragen werden k√∂nnen.\n1 2 3 4 5 # Das Schema ist wie folgt: $PSDefaultParameterValues[\"CmdletName:ParameterName\"]=\"Standardwert\" # also zum Beispiel $PSDefaultParameterValues[\"Select-Object:Property\"]=\"*\" Aber diese Standard-Werte k√∂nnen nat√ºrlich bei der Ausf√ºhrung von Cmdlets immer auch explizit √ºberschrieben werden. Also wenn ich beim Aufruf von Select-Object einen anderen -Property Wert festlege, dann wird der Befehl trotzdem noch richtig ausgef√ºhrt. Und Standardwerte k√∂nnt ihr √ºbrigens mit dieser Variable auch au√üerhalb von Profilen festlegen. Also das geht auch zum Beispiel in Skripten oder in eigenen Funktionen.\nCmdlets automatisch ausf√ºhren Ihr k√∂nnt auch bestimmte Befehle in euer PowerShell Profil eintragen und diese werden dann automatisch ausgef√ºhrt, wenn die PowerShell gestartet wird.\n1 2 3 4 5 6 7 # Beispiel: Aktuellen Wochentag ausgeben, wenn die PowerShell gestartet wird Write-Host \"Heute ist $(Get-Date -Format \"dddd\")\" \u003c# Beispiel R√ºckgabe: Heute ist Freitag #\u003e Oder die PowerShell 7 zeigt ja beim Start immer die Version an. Die Windows PowerShell macht das aber nicht. Wenn ihr wollt, k√∂nnt ihr in eurem Windows PowerShell Profil folgende Zeile hinzuf√ºgen, damit auch dort eine Versionsinfo angezeigt wird:\n1 2 3 4 5 6 \"Windows PowerShell $($PSVersionTable.PSVersion.Major).$($PSVersionTable.PSVersion.Minor)\" \u003c# Beispiel R√ºckgabe: Windows PowerShell 5.1 #\u003e Aber zu lange Befehle solltet ihr so lieber nicht ausf√ºhren, weil das sonst den Start von jeder PowerShell Session verlangsamt. Und wenn das Laden von allen Profilen zusammen mehr als 500ms dauert, dann eine Warnungsmeldung angezeigt. Prompt anpassen Ihr k√∂nnt auch eure Prompt, also den Eingabebereich in der Konsole anpassen. Daf√ºr verwendet die PowerShell die Standardfunktion prompt. Und den Code k√∂nnen wir mit unserem PowerShell Profil √ºberschreiben. Schauen wir uns erstmal den Standard-Code an:\n1 2 3 4 5 6 7 8 9 10 11 (Get-Command Prompt).ScriptBlock \u003c# R√ºckgabe: \"PS $($executionContext.SessionState.Path.CurrentLocation)$('\u003e' * ($nestedPromptLevel + 1)) \"; # .Link # https://go.microsoft.com/fwlink/?LinkID=225750 # .ExternalHelp System.Management.Automation.dll-help.xml #\u003e Ich w√ºrde mich erstmal an diesem Standard orientieren, anstatt von null anzufangen. Wir k√∂nnen das zum Beispiel erg√§nzen durch die Info, welcher User hier gerade angemeldet ist.\n1 2 3 function prompt { \"$($env:username)@$($env:computername) PS $($executionContext.SessionState.Path.CurrentLocation)$('\u003e' * ($nestedPromptLevel + 1)) \" } Das Ergebnis: Oder mit diesem Beispiel aus der Microsoft Dokumentation kann interaktiv angezeigt werden, ob die PowerShell mit Adminrechte l√§uft:\n1 2 3 4 5 6 7 8 9 10 11 function prompt { $identity = [Security.Principal.WindowsIdentity]::GetCurrent() $principal = [Security.Principal.WindowsPrincipal] $identity $adminRole = [Security.Principal.WindowsBuiltInRole]::Administrator $(if (Test-Path variable:/PSDebugContext) { '[DBG]: ' } elseif($principal.IsInRole($adminRole)) { \"[ADMIN]: \" } else { '' } ) + 'PS ' + $(Get-Location) + $(if ($NestedPromptLevel -ge 1) { '\u003e\u003e' }) + '\u003e ' } Das Ergebnis: Oh My Posh Wenn ihr Lust habt, eure PowerShell Konsole noch st√§rker anzupassen, dann empfehle ich Oh My Posh. Es gibt da schon viele vorgefertigte Themes, die direkt √ºbernommen werden k√∂nnen. Oder ihr k√∂nnt eigene Themes erstellen und dabei vielleicht nur ein bestehendes Theme als Grundlage nehmen.\nIch habe mir Oh My Posh per winget installiert, aber ihr k√∂nnt es auch anders installieren, schaut daf√ºr in die Dokumentation. Und Oh My Posh ist auch f√ºr macOS und Linux verf√ºgbar!\n1 winget install JanDeDobbeleer.OhMyPosh -s winget F√ºr viele Themes macht es Sinn, noch ein ‚ÄúNerd Font‚Äù Schriftarten-Paket zu installieren. Das sind Schriftarten die zus√§tzlich zu normalen Zeichen auch noch Icons enthalten. In der Oh My Posh Dokumentation wird die Schriftart ‚ÄúMeslo LGM NF‚Äù empfohlen, der Download Link ist auch dort zu finden. Anschlie√üend muss die Schriftart im Windows Terminal aktiviert werden. Und wenn ihr VSCode verwendet, dann macht es auch Sinn, die Schriftart f√ºr das dortige Terminal anzupassen.\nUm Oh My Posh jetzt auch tats√§chlich zu verwenden, m√ºssen wir eine Zeile in unserem PowerShell Profil hinzuf√ºgen.\n1 oh-my-posh init pwsh | Invoke-Expression Dadurch haben wir jetzt ein Standard-Theme in Verwendung. Eine √úbersicht von anderen Themes k√∂nnt ihr auf der Oh My Posh Webseite ansehen. Oder wenn ihr Oh My Posh schon geladen habt, k√∂nnt ihr in der Shell mit dem Befehl Get-PoshThemes eine √úbersicht erhalten. Themes mit dem Zusatz ‚Äúminimal‚Äù im Namen ben√∂tigen √ºbrigens keine Nerd Fonts. Ich fand ‚Äúblue-owl‚Äù ganz cool. Um das Theme zu nutzen, m√ºssen wir den Befehl im PowerShell Profil anpassen.\n1 oh-my-posh init pwsh¬†--config \"$($env:POSH_THEMES_PATH)\\blue-owl.omp.json\" | Invoke-Expression Das Ergebnis: Winfetch Was auch noch zum Thema Customizing passt ist Winfetch. Mit Winfetch k√∂nnt ihr euch so einen Infoscreen anzeigen, wenn ihr die PowerShell startet:\nAllerdings habe ich mir Winfetch nicht im PowerShell Profil eingetragen, sondern nur als Startoption im Windows Terminal hinzugef√ºgt. Dadurch wird verhindert, dass Winfetch ausgef√ºhrt wird, wenn ich z.B. aus der cmd.exe die PowerShell starte oder √§hnliches.\nWinfetch ist unter anderem √ºber PowerShell Gallery verf√ºgbar, kann also zum Beispiel mit folgendem Befehl installiert werden:\n1 Install-Script winfetch Bei der Installation werdet ihr m√∂glicherweise gefragt, ob ihr den PowerShell Skriptpfad zu eurer PATH Umgebungsvariable hinzuf√ºgen wollt. Ich w√ºrde das mit ‚ÄúJa‚Äù best√§tigen, weil ihr das Skript dadurch einfach mit dem Befehl winfetch aufrufen k√∂nnt. Ansonsten m√ºsst ihr eventuell mit dem absoluten Pfad des Skripts arbeiten. Damit die PATH √Ñnderung aktiv wird, m√ºsst ihr einmal die PowerShell Konsole neustarten. Anschlie√üend k√∂nnt ihr mit dem Befehl winfetch den Standard Infoscreen anzeigen. Wenn ihr wollt, k√∂nnt ihr aber auch eine eigene Konfiguration anlegen und bearbeiten:\n1 2 winfetch -genconf code $env:USERPROFILE/.config/winfetch/config.ps1 Guckt euch am besten die Konfig-Datei an, die generiert wurde. Da stehen eigentlich alle m√∂glichen Optionen drin, wo dann nur die Auskommentierung entfernt, oder ein Wert angepasst werden muss. Ihr k√∂nnt zum Beispiel das Logo √§ndern oder abschalten, oder auch komplett eigene Info-Zeilen hinzuf√ºgen.\nUm das Skript jetzt automatisch beim Start der PowerShell auszuf√ºhren, ohne es im PowerShell Profil einzutragen, k√∂nnt ihr es in den ‚ÄúCommand Line‚Äù Einstellungen von euren Windows Terminal Profilen eintragen.\n1 2 3 powershell.exe -NoLogo -NoExit -File \"C:\\Program Files\\WindowsPowerShell\\Scripts\\winfetch.ps1\" pwsh.exe -NoLogo -NoExit -File \"C:\\Program Files\\WindowsPowerShell\\Scripts\\winfetch.ps1\" Empfehlenswert ist es auch, die Einstellung dann sowohl f√ºr das Profil ‚ÄúWindows PowerShell‚Äù als auch ‚ÄúPowerShell‚Äù (also f√ºr PowerShell 7) zu setzen. Wenn ihr jetzt die PowerShell im Windows Terminal startet, dann wird winfetch ausgef√ºhrt, aber wenn ihr aus einer anderen Prompt die PowerShell startet, passiert nix üòé.\nAnregungen? Wenn ihr Ideen f√ºr n√ºtzliche PowerShell Profil Anpassungen habt, lasst es mich gerne in den Kommentaren wissen! ‚¨á\n","wordCount":"1901","inLanguage":"de","datePublished":"2024-03-05T00:00:00Z","dateModified":"2024-03-05T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/03/05/powershell-profiles/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell Profile erkl√§rt (mit Beispielen)</h1><div class=post-meta><span title='2024-03-05 00:00:00 +0000 UTC'>2024-03-05</span>&nbsp;¬∑&nbsp;9 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-03-05-PowerShell-Profiles.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#tipp-powershell-ohne-profile-starten aria-label="Tipp: PowerShell ohne Profile starten">Tipp: PowerShell ohne Profile starten</a></li><li><a href=#profil-speicherorte aria-label="Profil Speicherorte">Profil Speicherorte</a></li><li><a href=#profil-beispiele aria-label="Profil Beispiele">Profil Beispiele</a><ul><li><a href=#psreadline-optionen aria-label="PSReadLine Optionen">PSReadLine Optionen</a></li><li><a href=#eigene-cmdlets-und-aliase aria-label="Eigene Cmdlets und Aliase">Eigene Cmdlets und Aliase</a></li><li><a href=#standardwerte-f%c3%bcr-cmdlets-festlegen aria-label="Standardwerte f√ºr Cmdlets festlegen">Standardwerte f√ºr Cmdlets festlegen</a></li><li><a href=#cmdlets-automatisch-ausf%c3%bchren aria-label="Cmdlets automatisch ausf√ºhren">Cmdlets automatisch ausf√ºhren</a></li><li><a href=#prompt-anpassen aria-label="Prompt anpassen">Prompt anpassen</a></li><li><a href=#oh-my-posh aria-label="Oh My Posh">Oh My Posh</a></li></ul></li><li><a href=#winfetch aria-label=Winfetch>Winfetch</a></li><li><a href=#anregungen aria-label=Anregungen?>Anregungen?</a></li></ul></div></details></div><div class=post-content><p>Mit PowerShell Profilen k√∂nnt ihr eure PowerShell anpassen. Also zum Beispiel, dass sie so aussieht:</p><p><a href=/images/2024/2024-03-05_PSProfiles_OhMyPosh.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_OhMyPosh.jpg alt="PowerShell Konsole angepasst mit Oh My Posh und dem Theme Blue Owl" title="PowerShell Konsole angepasst mit Oh My Posh und dem Theme Blue Owl"></a></p><p>Oder ihr k√∂nnt einstellen, dass beim Start so ein Splash-Screen angezeigt (winfetch) wird:</p><p><a href=/images/2024/2024-03-05_PSProfiles_Winfetch.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_Winfetch.jpg alt="Beispiel f√ºr Winfetch Infobildschirm" title="Beispiel f√ºr Winfetch Infobildschirm"></a></p><p>Oder ihr k√∂nnt auch eigene Funktionen und Variablen hinterlegen, sodass diese immer sofort verf√ºgbar sind, wenn ihr die PowerShell startet.</p><p><strong>üé¨ Ich habe √ºbrigens auch ein <a href="https://www.youtube.com/watch?v=vtqrZjofJ40" target=_blank>Video zu dem Thema erstellt.</a></strong></p><p>Letztendlich ist ein PowerShell Profil einfach ein PowerShell Skript, was automatisch ausgef√ºhrt wird, wenn ihr die PowerShell startet. Die PowerShell schaut beim Start automatisch in bestimmten Pfaden, ob eine Profildatei vorhanden ist. Es k√∂nnen aber auch mehrere Profile vorhanden sein.
So kann dann zum Beispiel ein User-spezifisches Profil angelegt werden und auch ein systemweites. Au√üerdem k√∂nnen unterschiedliche PowerShell Konsolenhosts auch noch separate Profile haben. So kann dann zum Beispiel VSCode oder die PowerShell ISE anders konfiguriert werden, als die normale PowerShell Konsole (falls es gew√ºnscht ist). Und die Windows PowerShell hat auch nochmal Profile die unabh√§ngig sind von der PowerShell 7. Also es gibt sehr viele Orte wo ein Profil liegen kann.</p><h2 id=tipp-powershell-ohne-profile-starten>Tipp: PowerShell ohne Profile starten<a hidden class=anchor aria-hidden=true href=#tipp-powershell-ohne-profile-starten>#</a></h2><p>√úbrigens die PowerShell versucht normalerweise immer Profile zu laden <em>wenn sie gestartet wird</em>. Aber es ist auch m√∂glich die PowerShell mit dem zus√§tzlichen Parameter <code>-NoProfile</code> zu starten und dann wird sie ganz ohne Profile gestartet - kann manchmal n√ºtzlich sein.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># F√ºr Windows PowerShell</span>
</span></span><span style=display:flex><span>powershell.exe -NoProfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># F√ºr PowerShell 7</span>
</span></span><span style=display:flex><span>pwsh -NoProfile
</span></span></code></pre></td></tr></table></div></div><h2 id=profil-speicherorte>Profil Speicherorte<a hidden class=anchor aria-hidden=true href=#profil-speicherorte>#</a></h2><p>Die genauen Profil Speicherorte sind bei Microsoft dokumentiert. Hier die Infos zu <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.4#profile-types-and-locations" target=_blank>PowerShell 7.4</a> und hier f√ºr die <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-5.1#profile-types-and-locations" target=_blank>Windows PowerShell 5.1</a>.</p><p>Aber die Pfade sind auch einfach per PowerShell abrufbar - daf√ºr gibt es in der PowerShell eine automatische Variable names <code>$PROFILE</code>. Die zeigt erstmal den Profilpfad zu &ldquo;Current user, current host&rdquo;, also das Profil was so spezifisch ist wie es geht. Aber auch die anderen Pfade sind dar√ºber abrufbar. Daf√ºr k√∂nnt ihr die Variable einmal in <code>Select-Object</code> pipen. Beispielsweise wird mir in der Windows PowerShell 5.1 folgendes zur√ºckgegeben:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$PROFILE</span> | <span style=color:#d0a8ff>Select-Object</span> *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# Beispiel R√ºckgabe aus Windows PowerShell 5.1:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>AllUsersAllHosts       : C:\Windows\System32\WindowsPowerShell\v1.0\profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>AllUsersCurrentHost    : C:\Windows\System32\WindowsPowerShell\v1.0\Microsoft.PowerShell_profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>CurrentUserAllHosts    : C:\Users\diecknet\Documents\WindowsPowerShell\profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>CurrentUserCurrentHost : C:\Users\diecknet\Documents\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Length                 : 78
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Und in PowerShell 7.4 erhalte ich folgende R√ºckgabe:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$PROFILE</span> | <span style=color:#d0a8ff>Select-Object</span> *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# Beispiel R√ºckgabe aus PowerShell 7.4:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>AllUsersAllHosts       : C:\Program Files\PowerShell\7\profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>AllUsersCurrentHost    : C:\Program Files\PowerShell\7\Microsoft.PowerShell_profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>CurrentUserAllHosts    : C:\Users\diecknet\Documents\PowerShell\profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>CurrentUserCurrentHost : C:\Users\diecknet\Documents\PowerShell\Microsoft.PowerShell_profile.ps1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Length                 : 71
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Wenn ihr jetzt ein Profil bearbeiten wollt, dann k√∂nnt ihr direkt aus der PowerShell <code>notepad</code> oder VSCode mit <code>$PROFILE</code> als Parameterwert aufrufen. Dadurch √∂ffnet sich euer Bearbeitungsprogramm direkt mit der Profildatei. Die meisten modernen Editoren k√∂nnen dann die Profildatei direkt erstellen, falls sie noch nicht vorhanden sein sollte. Manche √§ltere Editoren geben aber nur eine Fehlermeldung zur√ºck, falls die Datei noch gar nicht existiert.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Das &#34;Current User, Current Host&#34; Profil per Visual Studio Code bearbeiten:</span>
</span></span><span style=display:flex><span>code <span style=color:#41a1c0>$PROFILE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Das &#34;Current User, All Hosts&#34; Profil per notepad bearbeiten:</span>
</span></span><span style=display:flex><span>notepad <span style=color:#41a1c0>$PROFILE</span>.CurrentUserAllHosts
</span></span></code></pre></td></tr></table></div></div><p>Wenn ihr ein &ldquo;All Users&rdquo; Profil bearbeiten wollt, dann m√ºsst ihr √ºbrigens den Editor daf√ºr mit Admin-Rechten starten. Beziehungsweise wenn ihr direkt per PowerShell euren Editor starten wollt und die Profildatei laden wollt, dann sollte die PowerShell schon mit Adminrechten laufen.</p><h2 id=profil-beispiele>Profil Beispiele<a hidden class=anchor aria-hidden=true href=#profil-beispiele>#</a></h2><p>Hier ein paar Beispiele f√ºr Konfigurationen, die man in einem PowerShell Profil setzen k√∂nnte.<br><strong>Wichtig: Damit die Profil√§nderungen aktiv werden, m√ºsst ihr die PowerShell einmal neustarten.</strong></p><h3 id=psreadline-optionen>PSReadLine Optionen<a hidden class=anchor aria-hidden=true href=#psreadline-optionen>#</a></h3><p>Ich habe bei mir in meiner Demo-VM eingestellt, dass keine Autovervollst√§ndigung in der PowerShell passieren soll. Finde ich sonst n√§mlich nervig bei der Erstellung von Videos und Blog Posts.
Daf√ºr habe ich in meinem Profil folgendes stehen:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Set-PSReadLineOption</span> -PredictionSource None
</span></span></code></pre></td></tr></table></div></div><p>Diese Einstellung l√§uft √ºber das Modul <code>PSReadLine</code>. Das Modul kann genutzt werden, um die PowerShell Konsole vielf√§ltig anzupassen. Es k√∂nnen zum Beispiel auch Tastenkombinationen eingestellt werden. Oder hier ein cooles Beispiel von der <a href="https://github.com/PowerShell/PSReadLine?tab=readme-ov-file#usage" target=_blank>PSReadLine GitHub Projektseite</a>:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Set-PSReadLineKeyHandler</span> -Chord <span style=color:#fc6a5d>&#39;&#34;&#39;</span>,<span style=color:#fc6a5d>&#34;&#39;&#34;</span> `
</span></span><span style=display:flex><span>                         -BriefDescription SmartInsertQuote `
</span></span><span style=display:flex><span>                         -LongDescription <span style=color:#fc6a5d>&#34;Insert paired quotes if not already on a quote&#34;</span> `
</span></span><span style=display:flex><span>                         -ScriptBlock {
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>param</span>(<span style=color:#41a1c0>$key</span>, <span style=color:#41a1c0>$arg</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#41a1c0>$line</span> = $null
</span></span><span style=display:flex><span>    <span style=color:#41a1c0>$cursor</span> = $null
</span></span><span style=display:flex><span>    [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref]<span style=color:#41a1c0>$line</span>, [ref]<span style=color:#41a1c0>$cursor</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$line</span>.Length -gt <span style=color:#41a1c0>$cursor</span> -and <span style=color:#41a1c0>$line</span>[<span style=color:#41a1c0>$cursor</span>] -eq <span style=color:#41a1c0>$key</span>.KeyChar) {
</span></span><span style=display:flex><span>        <span style=color:#6c7986># Just move the cursor</span>
</span></span><span style=display:flex><span>        [Microsoft.PowerShell.PSConsoleReadLine]::SetCursorPosition(<span style=color:#41a1c0>$cursor</span> + <span style=color:#d0bf69>1</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#6c7986># Insert matching quotes, move cursor to be in between the quotes</span>
</span></span><span style=display:flex><span>        [Microsoft.PowerShell.PSConsoleReadLine]::Insert(<span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$key</span>.KeyChar)<span style=color:#fc6a5d>&#34;</span> * <span style=color:#d0bf69>2</span>)
</span></span><span style=display:flex><span>        [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref]<span style=color:#41a1c0>$line</span>, [ref]<span style=color:#41a1c0>$cursor</span>)
</span></span><span style=display:flex><span>        [Microsoft.PowerShell.PSConsoleReadLine]::SetCursorPosition(<span style=color:#41a1c0>$cursor</span> - <span style=color:#d0bf69>1</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Das sorgt daf√ºr, dass wenn man ein Anf√ºhrungszeichen in der Shell eingibt, automatisch ein schlie√üendes Anf√ºhrungszeichen eingef√ºgt wird - und der Cursor wird dazwischen platziert. Wenn ihr mehr zu <a href="https://learn.microsoft.com/en-us/powershell/module/psreadline/about/about_psreadline?view=powershell-7.4" target=_blank>PSReadLine</a> wissen wollt, dann schaut mal in <a href="https://learn.microsoft.com/en-us/powershell/module/psreadline/about/about_psreadline?view=powershell-7.4" target=_blank>die Dokumentation dazu</a>.</p><h3 id=eigene-cmdlets-und-aliase>Eigene Cmdlets und Aliase<a hidden class=anchor aria-hidden=true href=#eigene-cmdlets-und-aliase>#</a></h3><p>Wenn ihr wollt, k√∂nnt ihr auch eigene Cmdlets oder Aliase im PowerShell Profil definieren, die dann automatisch in eurer PowerShell Session verf√ºgbar sind. Zum Beispiel:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc5fa3>function</span> <span style=color:#d0a8ff>blog</span> {
</span></span><span style=display:flex><span>    <span style=color:#d0a8ff>Set-Location</span> C:\dev\<span style=color:#d0a8ff>diecknet-blog</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Dadurch kann ich schnell und einfach mit dem Befehl <code>blog</code> in mein lokales Verzeichnis wechseln, wo der Quellcode zu meinem Blog liegt. Oder ich kann mir den Alias <code>reboot</code> anlegen, der auf das Cmdlet <code>Restart-Computer</code> zeigt.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>New-Alias</span> -Name reboot -Value <span style=color:#d0a8ff>Restart-Computer</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=standardwerte-f√ºr-cmdlets-festlegen>Standardwerte f√ºr Cmdlets festlegen<a hidden class=anchor aria-hidden=true href=#standardwerte-f√ºr-cmdlets-festlegen>#</a></h3><p>Ihr k√∂nnt auch Standardwerte f√ºr bestimmte Cmdlet-Parameter festlegen. Das geht mit der Variable <code>$PSDefaultParameterValues</code> - das ist eine Hashtable in die bei Bedarf Eintr√§ge mit Cmdlet und Parameternamen eingetragen werden k√∂nnen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Das Schema ist wie folgt:</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$PSDefaultParameterValues</span>[<span style=color:#fc6a5d>&#34;CmdletName:ParameterName&#34;</span>]=<span style=color:#fc6a5d>&#34;Standardwert&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># also zum Beispiel</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$PSDefaultParameterValues</span>[<span style=color:#fc6a5d>&#34;Select-Object:Property&#34;</span>]=<span style=color:#fc6a5d>&#34;*&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Aber diese Standard-Werte k√∂nnen nat√ºrlich bei der Ausf√ºhrung von Cmdlets immer auch explizit √ºberschrieben werden. Also wenn ich beim Aufruf von <code>Select-Object</code> einen anderen <code>-Property</code> Wert festlege, dann wird der Befehl trotzdem noch richtig ausgef√ºhrt. Und Standardwerte k√∂nnt ihr √ºbrigens mit dieser Variable auch au√üerhalb von Profilen festlegen. Also das geht auch zum Beispiel in Skripten oder in eigenen Funktionen.</p><h3 id=cmdlets-automatisch-ausf√ºhren>Cmdlets automatisch ausf√ºhren<a hidden class=anchor aria-hidden=true href=#cmdlets-automatisch-ausf√ºhren>#</a></h3><p>Ihr k√∂nnt auch bestimmte Befehle in euer PowerShell Profil eintragen und diese werden dann automatisch ausgef√ºhrt, wenn die PowerShell gestartet wird.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Beispiel: Aktuellen Wochentag ausgeben, wenn die PowerShell gestartet wird</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Heute ist </span>$(<span style=color:#d0a8ff>Get-Date</span> -Format <span style=color:#fc6a5d>&#34;dddd&#34;</span>)<span style=color:#fc6a5d>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# Beispiel R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Heute ist Freitag
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Oder die PowerShell 7 zeigt ja beim Start immer die Version an. Die Windows PowerShell macht das aber nicht. Wenn ihr wollt, k√∂nnt ihr in eurem Windows PowerShell Profil folgende Zeile hinzuf√ºgen, damit auch dort eine Versionsinfo angezeigt wird:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc6a5d>&#34;Windows PowerShell </span>$(<span style=color:#41a1c0>$PSVersionTable</span>.PSVersion.Major)<span style=color:#fc6a5d>.</span>$(<span style=color:#41a1c0>$PSVersionTable</span>.PSVersion.Minor)<span style=color:#fc6a5d>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# Beispiel R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>Windows PowerShell 5.1
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span> 
</span></span></code></pre></td></tr></table></div></div><p>Aber zu lange Befehle solltet ihr so lieber nicht ausf√ºhren, weil das sonst den Start von jeder PowerShell Session verlangsamt. Und wenn das Laden von allen Profilen zusammen mehr als 500ms dauert, dann eine Warnungsmeldung angezeigt.
<a href=/images/2024/2024-03-05_PSProfiles_LoadingTime.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_LoadingTime.jpg alt="Beispiel f√ºr Warnungsmeldung wenn ein PowerShell Profil l√§nger als 500ms l√§dt - Das Laden von pers√∂nlichen und Systemprofilen dauerte 619 ms." title="Beispiel f√ºr Warnungsmeldung wenn ein PowerShell Profil l√§nger als 500ms l√§dt - Das Laden von pers√∂nlichen und Systemprofilen dauerte 619 ms."></a></p><h3 id=prompt-anpassen>Prompt anpassen<a hidden class=anchor aria-hidden=true href=#prompt-anpassen>#</a></h3><p>Ihr k√∂nnt auch eure Prompt, also den Eingabebereich in der Konsole anpassen. Daf√ºr verwendet die PowerShell die Standardfunktion <code>prompt</code>. Und den Code k√∂nnen wir mit unserem PowerShell Profil √ºberschreiben. Schauen wir uns erstmal den Standard-Code an:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>(<span style=color:#d0a8ff>Get-Command</span> Prompt).ScriptBlock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986>&lt;# R√ºckgabe:
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>&#34;PS $($executionContext.SessionState.Path.CurrentLocation)$(&#39;&gt;&#39; * ($nestedPromptLevel +
</span></span></span><span style=display:flex><span><span style=color:#6c7986>1)) &#34;;
</span></span></span><span style=display:flex><span><span style=color:#6c7986># .</span><span style=color:#fc6a5d>Link</span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986># https://go.microsoft.com/fwlink/?LinkID=225750
</span></span></span><span style=display:flex><span><span style=color:#6c7986># .ExternalHelp System.Management.Automation.dll-help.xml
</span></span></span><span style=display:flex><span><span style=color:#6c7986>
</span></span></span><span style=display:flex><span><span style=color:#6c7986>#&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Ich w√ºrde mich erstmal an diesem Standard orientieren, anstatt von null anzufangen. Wir k√∂nnen das zum Beispiel erg√§nzen durch die Info, welcher User hier gerade angemeldet ist.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc5fa3>function</span> <span style=color:#d0a8ff>prompt</span> {
</span></span><span style=display:flex><span>    <span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$env:username</span>)<span style=color:#fc6a5d>@</span>$(<span style=color:#41a1c0>$env:computername</span>)<span style=color:#fc6a5d> PS </span>$(<span style=color:#41a1c0>$executionContext</span>.SessionState.Path.CurrentLocation)$(<span style=color:#fc6a5d>&#39;&gt;&#39;</span> * (<span style=color:#41a1c0>$nestedPromptLevel</span> + <span style=color:#d0bf69>1</span>))<span style=color:#fc6a5d> &#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Das Ergebnis:
<a href=/images/2024/2024-03-05_PSProfiles_Prompt.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_Prompt.jpg alt="Beispiel f√ºr eine angepasst Prompt" title="Beispiel f√ºr eine angepasst Prompt"></a></p><p>Oder mit diesem Beispiel <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_prompts?view=powershell-7.4#how-to-customize-the-prompt" target=_blank>aus der Microsoft Dokumentation</a> kann interaktiv angezeigt werden, ob die PowerShell mit Adminrechte l√§uft:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#fc5fa3>function</span> <span style=color:#d0a8ff>prompt</span> {
</span></span><span style=display:flex><span>  <span style=color:#41a1c0>$identity</span> = [Security.Principal.WindowsIdentity]::GetCurrent()
</span></span><span style=display:flex><span>  <span style=color:#41a1c0>$principal</span> = [Security.Principal.WindowsPrincipal] <span style=color:#41a1c0>$identity</span>
</span></span><span style=display:flex><span>  <span style=color:#41a1c0>$adminRole</span> = [Security.Principal.WindowsBuiltInRole]::Administrator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  $(<span style=color:#fc5fa3>if</span> (<span style=color:#d0a8ff>Test-Path</span> variable<span style=color:#960050>:</span>/PSDebugContext) { <span style=color:#fc6a5d>&#39;[DBG]: &#39;</span> }
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>elseif</span>(<span style=color:#41a1c0>$principal</span>.IsInRole(<span style=color:#41a1c0>$adminRole</span>)) { <span style=color:#fc6a5d>&#34;[ADMIN]: &#34;</span> }
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>else</span> { <span style=color:#fc6a5d>&#39;&#39;</span> }
</span></span><span style=display:flex><span>  ) + <span style=color:#fc6a5d>&#39;PS &#39;</span> + $(<span style=color:#d0a8ff>Get-Location</span>) +
</span></span><span style=display:flex><span>    $(<span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$NestedPromptLevel</span> -ge <span style=color:#d0bf69>1</span>) { <span style=color:#fc6a5d>&#39;&gt;&gt;&#39;</span> }) + <span style=color:#fc6a5d>&#39;&gt; &#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Das Ergebnis:
<a href=/images/2024/2024-03-05_PSProfiles_Prompt2.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_Prompt2.jpg alt="Weiteres Beispiel f√ºr eine angepasst Prompt" title="Weiteres Beispiel f√ºr eine angepasst Prompt"></a></p><h3 id=oh-my-posh>Oh My Posh<a hidden class=anchor aria-hidden=true href=#oh-my-posh>#</a></h3><p>Wenn ihr Lust habt, eure PowerShell Konsole noch st√§rker anzupassen, dann empfehle ich <a href=https://ohmyposh.dev/ target=_blank>Oh My Posh</a>. Es gibt da schon viele vorgefertigte Themes, die direkt √ºbernommen werden k√∂nnen. Oder ihr k√∂nnt eigene Themes erstellen und dabei vielleicht nur ein bestehendes Theme als Grundlage nehmen.</p><p>Ich habe mir Oh My Posh per <code>winget</code> installiert, aber ihr k√∂nnt es auch anders installieren, schaut daf√ºr in die <a href=https://ohmyposh.dev/docs/installation/windows target=_blank>Dokumentation</a>. Und Oh My Posh ist auch f√ºr <a href=https://ohmyposh.dev/docs/installation/macos target=_blank>macOS</a> und <a href=https://ohmyposh.dev/docs/installation/linux target=_blank>Linux</a> verf√ºgbar!</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>winget install JanDeDobbeleer.OhMyPosh -s winget
</span></span></code></pre></td></tr></table></div></div><p>F√ºr viele Themes macht es Sinn, noch ein &ldquo;Nerd Font&rdquo; Schriftarten-Paket zu installieren. Das sind Schriftarten die zus√§tzlich zu normalen Zeichen auch noch Icons enthalten. In der <a href=https://ohmyposh.dev/docs/installation/fonts target=_blank>Oh My Posh Dokumentation</a> wird die Schriftart &ldquo;Meslo LGM NF&rdquo; empfohlen, der Download Link ist auch <a href=https://ohmyposh.dev/docs/installation/fonts target=_blank>dort</a> zu finden.
Anschlie√üend muss die Schriftart im Windows Terminal aktiviert werden. Und wenn ihr VSCode verwendet, dann macht es auch Sinn, die Schriftart f√ºr das dortige Terminal anzupassen.</p><p>Um Oh My Posh jetzt auch tats√§chlich zu verwenden, m√ºssen wir eine Zeile in unserem PowerShell Profil hinzuf√ºgen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>oh-my</span>-posh init pwsh | <span style=color:#d0a8ff>Invoke-Expression</span>
</span></span></code></pre></td></tr></table></div></div><p>Dadurch haben wir jetzt ein Standard-Theme in Verwendung. Eine <a href=https://ohmyposh.dev/docs/themes target=_blank>√úbersicht von anderen Themes k√∂nnt ihr auf der Oh My Posh Webseite ansehen</a>. Oder wenn ihr Oh My Posh schon geladen habt, k√∂nnt ihr in der Shell mit dem Befehl <code>Get-PoshThemes</code> eine √úbersicht erhalten. Themes mit dem Zusatz &ldquo;minimal&rdquo; im Namen ben√∂tigen √ºbrigens keine Nerd Fonts. Ich fand &ldquo;blue-owl&rdquo; ganz cool. Um das Theme zu nutzen, m√ºssen wir den Befehl im PowerShell Profil anpassen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>oh-my</span>-posh init pwsh¬†--config <span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$env:POSH_THEMES_PATH</span>)<span style=color:#fc6a5d>\blue-owl.omp.json&#34;</span> | <span style=color:#d0a8ff>Invoke-Expression</span>
</span></span></code></pre></td></tr></table></div></div><p>Das Ergebnis:
<a href=/images/2024/2024-03-05_PSProfiles_OhMyPosh.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_OhMyPosh.jpg alt="PowerShell Konsole angepasst mit Oh My Posh und dem Theme Blue Owl" title="PowerShell Konsole angepasst mit Oh My Posh und dem Theme Blue Owl"></a></p><h2 id=winfetch>Winfetch<a hidden class=anchor aria-hidden=true href=#winfetch>#</a></h2><p>Was auch noch zum Thema Customizing passt ist <a href=https://github.com/lptstr/winfetch target=_blank>Winfetch</a>. Mit Winfetch k√∂nnt ihr euch so einen Infoscreen anzeigen, wenn ihr die PowerShell startet:</p><p><a href=/images/2024/2024-03-05_PSProfiles_Winfetch.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_Winfetch.jpg alt="Beispiel f√ºr Winfetch Infobildschirm" title="Beispiel f√ºr Winfetch Infobildschirm"></a></p><p>Allerdings habe ich mir Winfetch <strong>nicht</strong> im PowerShell Profil eingetragen, sondern nur als Startoption im Windows Terminal hinzugef√ºgt. Dadurch wird verhindert, dass Winfetch ausgef√ºhrt wird, wenn ich z.B. aus der <code>cmd.exe</code> die PowerShell starte oder √§hnliches.</p><p>Winfetch ist unter anderem √ºber PowerShell Gallery verf√ºgbar, kann also zum Beispiel mit folgendem Befehl installiert werden:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Install-Script</span> winfetch
</span></span></code></pre></td></tr></table></div></div><p>Bei der Installation werdet ihr m√∂glicherweise gefragt, ob ihr den PowerShell Skriptpfad zu eurer <code>PATH</code> Umgebungsvariable hinzuf√ºgen wollt. Ich w√ºrde das mit &ldquo;Ja&rdquo; best√§tigen, weil ihr das Skript dadurch einfach mit dem Befehl <code>winfetch</code> aufrufen k√∂nnt. Ansonsten m√ºsst ihr eventuell mit dem absoluten Pfad des Skripts arbeiten. Damit die <code>PATH</code> √Ñnderung aktiv wird, m√ºsst ihr einmal die PowerShell Konsole neustarten. Anschlie√üend k√∂nnt ihr mit dem Befehl <code>winfetch</code> den Standard Infoscreen anzeigen. Wenn ihr wollt, k√∂nnt ihr aber auch eine eigene Konfiguration anlegen und bearbeiten:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>winfetch -genconf
</span></span><span style=display:flex><span>code <span style=color:#41a1c0>$env:USERPROFILE</span>/.config/winfetch/config.ps1
</span></span></code></pre></td></tr></table></div></div><p>Guckt euch am besten die Konfig-Datei an, die generiert wurde. Da stehen eigentlich alle m√∂glichen Optionen drin, wo dann nur die Auskommentierung entfernt, oder ein Wert angepasst werden muss. Ihr k√∂nnt zum Beispiel das Logo √§ndern oder abschalten, oder auch komplett eigene Info-Zeilen hinzuf√ºgen.</p><p>Um das Skript jetzt automatisch beim Start der PowerShell auszuf√ºhren, ohne es im PowerShell Profil einzutragen, k√∂nnt ihr es in den &ldquo;Command Line&rdquo; Einstellungen von euren Windows Terminal Profilen eintragen.</p><p><a href=/images/2024/2024-03-05_PSProfiles_Winfetch_SetupWindowsTerminal.jpg><img loading=lazy src=/images/2024/2024-03-05_PSProfiles_Winfetch_SetupWindowsTerminal.jpg alt="Konfiguration Winfetch im Windows Terminal" title="Konfiguration Winfetch im Windows Terminal"></a></p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>powershell.exe -NoLogo -NoExit -File <span style=color:#fc6a5d>&#34;C:\Program Files\WindowsPowerShell\Scripts\winfetch.ps1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pwsh.exe -NoLogo -NoExit -File <span style=color:#fc6a5d>&#34;C:\Program Files\WindowsPowerShell\Scripts\winfetch.ps1&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Empfehlenswert ist es auch, die Einstellung dann sowohl f√ºr das Profil &ldquo;Windows PowerShell&rdquo; als auch &ldquo;PowerShell&rdquo; (also f√ºr PowerShell 7) zu setzen. Wenn ihr jetzt die PowerShell im Windows Terminal startet, dann wird winfetch ausgef√ºhrt, aber wenn ihr aus einer anderen Prompt die PowerShell startet, passiert nix üòé.</p><h2 id=anregungen>Anregungen?<a hidden class=anchor aria-hidden=true href=#anregungen>#</a></h2><p>Wenn ihr Ideen f√ºr n√ºtzliche PowerShell Profil Anpassungen habt, lasst es mich gerne in den Kommentaren wissen! ‚¨á</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li><li><a href=https://diecknet.de/de/tags/profiles/>Profiles</a></li><li><a href=https://diecknet.de/de/tags/customization/>Customization</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>