<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Skripte remote entwickeln | diecknet</title>
<meta name=keywords content="powershell"><meta name=description content="Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Windows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2024/04/23/powershell-remote-script-development/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/04/23/powershell-remote-script-development/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Skripte remote entwickeln"><meta property="og:description" content="Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Windows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2024/04/23/powershell-remote-script-development/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-23T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-23T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Skripte remote entwickeln"><meta name=twitter:description content="Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Windows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Skripte remote entwickeln","item":"https://diecknet.de/de/2024/04/23/powershell-remote-script-development/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Skripte remote entwickeln","name":"PowerShell Skripte remote entwickeln","description":"Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nWindows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell.","keywords":["powershell"],"articleBody":"Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.\nWindows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell. Um remote ein Skript zu entwickeln, k√∂nnt ihr √ºber das Men√º ‚ÄúDatei‚Äù ‚û°Ô∏è ‚ÄúNeue Remote-PowerShell-Registerkarte‚Äù eine Session starten.\nIm Dialog ‚ÄúNeue Remote-PowerShell-Registerkarte‚Äù k√∂nnt ihr dann den Hostname des remote Computers angegeben und optional noch einen anderen Benutzernamen. Falls der User mit dem ihr lokal angemeldet seid schon Rechte f√ºr den Remotecomputer hat, ist es nicht n√∂tig ihn hier erneut anzugeben.\nEs √∂ffnet sich eine neuer Tab. An den eckigen Klammern in der Prompt ist erkennbar, dass es sich um ein remote System handelt.\nUm eine neue Skriptdatei auf dem Remotecomputer anzulegen, k√∂nnt ihr das Cmdlet New-Item verwenden. Mit dem Befehl psedit k√∂nnt ihr ein Skript, welches auf dem Remotecomputer liegt zur Bearbeitung laden.\n1 2 3 4 5 # Anlage Skriptdatei New-Item RemoteBeispiel.ps1 # Skript bearbeiten psedit .\\RemoteBeispiel.ps1 Anschlie√üend √∂ffnet sich innerhalb des Remote-Tabs ein Tab f√ºr eure ‚ÄúRemotedatei‚Äù. Wenn ihr mit dem Mauszeiger √ºber den Titel des Remotedatei-Tabs fahrt, wird ein lokaler Pfad sichtbar in dem das Skript zwischengespeichert wird. Wenn ihr das Skript speichert, werden die √Ñnderungen aber automatisch auf das Remotesystem √ºbertragen.\nJetzt k√∂nnt ihr im Grunde normal mit der Windows PowerShell ISE ein Skript entwickeln. Also wahlweise einzelne Zeilen oder das ganze Skript ausf√ºhren. Die Befehle werden auf dem Remote System ausgef√ºhrt, wie zum Beispiel im nachfolgenden Screenshot erkennbar. Der Inhalt der Variable $ENV:COMPUTERNAME wird ausgegeben, wodurch erkennbar ist, dass das Skript auf dem Host Server1 ausgef√ºhrt wird.\nAuch Debugging ist m√∂glich. Im nachfolgenden Screenshot habe ich zum Beispiel per F9-Taste einen Breakpoint gesetzt und das Skript per F5-Taste im Debugging-Modus ausgef√ºhrt.\nWenn ihr fertig seid, k√∂nnt ihr den Remote-Tab einfach schlie√üen.\nVisual Studio Code Auch Visual Studio Code unterst√ºtzt remote PowerShell Entwicklung. Und hier ist sogar PowerShell 7 m√∂glich - wobei Windows PowerShell auch weiterhin geht. Wichtig ist, dass ihr die PowerShell Extension installiert habt. Und es muss auch die Konsole der Extension laufen. Falls ihr gerade nicht lokal schon ein PowerShell Skript bearbeitet, kann es sein, dass die Extension Konsole noch nicht l√§uft. Um sie zu starten k√∂nnt ihr per Tastenkombination ‚ÄúSTRG‚Äù + ‚ÄúUmschalt‚Äù + ‚ÄúP‚Äù die Command-Palette √∂ffnen. Dort k√∂nnt ihr dann nach ‚ÄúPowerShell: Restart Session‚Äù suchen und den Punkt ausf√ºhren.\nUm eine Verbindung mit einem Windows PowerShell System herzustellen, k√∂nnt ihr einfach in der Extension Konsole Enter-PSSession ausf√ºhren. Also zum Beispiel:\n1 Enter-PSSession Server1 Falls ihr euch mit einem PowerShell 7 System verbinden wollt, dann m√ºsst ihr den Parameter -Hostname mitangeben. Ansonsten wird der ausgelassene Parametername als -Computername interpretiert, was nur f√ºr Windows PowerShell Systeme geeignet ist. Bei beiden Varianten k√∂nnt ihr mit -Username einen anderen Username angeben, falls euer Remotesystem es erfordert.\n1 Enter-PSSession -Hostname DC2 -Username administrator Skripte anlegen und bearbeiten ist dann im Grunde wie auch in der Windows PowerShell ISE: Neue Skriptdateien k√∂nnen per New-Item angelegt werden, Skript bearbeiten geht per psedit. Anschlie√üend k√∂nnt ihr auch per F8-Taste die aktuelle Zeile oder Markierung ausf√ºhren, beziehungsweise mit der F5-Taste das ganze Skript.\n1 2 3 4 5 # Anlage Skriptdatei New-Item RemoteBeispiel.ps1 # Skript bearbeiten psedit .\\RemoteBeispiel.ps1 Theoretisch sollte auch das Remote-Debuggen funktionieren, aber als ich es im M√§rz 2024 getestet habe, hat es gerade nicht funktioniert. Das scheint aber ein bekanntes Problem zu sein, und sollte eigentlich demn√§chst wieder gehen.\nWenn ihr fertig seid: Eine Remote Session k√∂nnt ihr per Exit-PSSession beenden.\n","wordCount":"628","inLanguage":"de","datePublished":"2024-04-23T00:00:00Z","dateModified":"2024-04-23T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2024/04/23/powershell-remote-script-development/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell Skripte remote entwickeln</h1><div class=post-meta><span title='2024-04-23 00:00:00 +0000 UTC'>2024-04-23</span>&nbsp;¬∑&nbsp;3 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2024/2024-04-23-PowerShell-Remote-Script-Development.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#windows-powershell-ise aria-label="Windows PowerShell ISE">Windows PowerShell ISE</a></li><li><a href=#visual-studio-code aria-label="Visual Studio Code">Visual Studio Code</a></li></ul></div></details></div><div class=post-content><p>Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. <strong>üé¨ Ich habe √ºbrigens auch ein <a href="https://www.youtube.com/watch?v=T009J35wJQE" target=_blank>Video zu dem Thema erstellt.</a></strong></p><h2 id=windows-powershell-ise>Windows PowerShell ISE<a hidden class=anchor aria-hidden=true href=#windows-powershell-ise>#</a></h2><p>Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell. Um remote ein Skript zu entwickeln, k√∂nnt ihr √ºber das Men√º &ldquo;Datei&rdquo; ‚û°Ô∏è &ldquo;Neue Remote-PowerShell-Registerkarte&rdquo; eine Session starten.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_1.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_1.jpg alt="Neue Remote-PowerShell-Registerkarte in der PowerShell ISE starten" title="Neue Remote-PowerShell-Registerkarte in der PowerShell ISE starten"></a></p><p>Im Dialog &ldquo;Neue Remote-PowerShell-Registerkarte&rdquo; k√∂nnt ihr dann den Hostname des remote Computers angegeben und optional noch einen anderen Benutzernamen. Falls der User mit dem ihr lokal angemeldet seid schon Rechte f√ºr den Remotecomputer hat, ist es nicht n√∂tig ihn hier erneut anzugeben.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_2.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_2.jpg alt="Angabe des Remotecomputernamens im Dialog Neue Remote-PowerShell-Registerkarte in der PowerShell ISE" title="Angabe des Remotecomputernamens im Dialog Neue Remote-PowerShell-Registerkarte in der PowerShell ISE"></a></p><p>Es √∂ffnet sich eine neuer Tab. An den eckigen Klammern in der Prompt ist erkennbar, dass es sich um ein remote System handelt.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_3.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_3.jpg alt="PowerShell ISE ist mit Server1 verbunden" title="PowerShell ISE ist mit Server1 verbunden"></a></p><p>Um eine neue Skriptdatei auf dem Remotecomputer anzulegen, k√∂nnt ihr das Cmdlet <code>New-Item</code> verwenden. Mit dem Befehl <code>psedit</code> k√∂nnt ihr ein Skript, welches auf dem Remotecomputer liegt zur Bearbeitung laden.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Anlage Skriptdatei</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>New-Item</span> RemoteBeispiel.ps1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Skript bearbeiten</span>
</span></span><span style=display:flex><span>psedit .\RemoteBeispiel.ps1
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_4.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_4.jpg alt="PowerShell ISE remote Skript erstellen und bearbeiten" title="PowerShell ISE remote Skript erstellen und bearbeiten"></a></p><p>Anschlie√üend √∂ffnet sich innerhalb des Remote-Tabs ein Tab f√ºr eure &ldquo;Remotedatei&rdquo;. Wenn ihr mit dem Mauszeiger √ºber den Titel des Remotedatei-Tabs fahrt, wird ein lokaler Pfad sichtbar in dem das Skript zwischengespeichert wird. Wenn ihr das Skript speichert, werden die √Ñnderungen aber automatisch auf das Remotesystem √ºbertragen.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_5.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_5.jpg alt="PowerShell ISE remote Skript hat einen lokalen Pfad" title="PowerShell ISE remote Skript hat einen lokalen Pfad"></a></p><p>Jetzt k√∂nnt ihr im Grunde normal mit der Windows PowerShell ISE ein Skript entwickeln. Also wahlweise einzelne Zeilen oder das ganze Skript ausf√ºhren. Die Befehle werden auf dem Remote System ausgef√ºhrt, wie zum Beispiel im nachfolgenden Screenshot erkennbar. Der Inhalt der Variable <code>$ENV:COMPUTERNAME</code> wird ausgegeben, wodurch erkennbar ist, dass das Skript auf dem Host <code>Server1</code> ausgef√ºhrt wird.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_6.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_6.jpg alt="PowerShell ISE remote Skript entwickeln" title="PowerShell ISE remote Skript entwickeln"></a></p><p>Auch Debugging ist m√∂glich. Im nachfolgenden Screenshot habe ich zum Beispiel per <code>F9</code>-Taste einen Breakpoint gesetzt und das Skript per <code>F5</code>-Taste im Debugging-Modus ausgef√ºhrt.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_7.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_7.jpg alt="PowerShell ISE remote Skript debuggen" title="PowerShell ISE remote Skript debuggen"></a></p><p>Wenn ihr fertig seid, k√∂nnt ihr den Remote-Tab einfach schlie√üen.</p><p><a href=/images/2024/2024-04-23_PS_Remote_ISE_8.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_ISE_8.jpg alt="PowerShell ISE remote Tab schlie√üen" title="PowerShell ISE remote Tab schlie√üen"></a></p><h2 id=visual-studio-code>Visual Studio Code<a hidden class=anchor aria-hidden=true href=#visual-studio-code>#</a></h2><p>Auch Visual Studio Code unterst√ºtzt remote PowerShell Entwicklung. Und hier ist sogar PowerShell 7 m√∂glich - wobei Windows PowerShell auch weiterhin geht. Wichtig ist, dass ihr die <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell" target=_blank>PowerShell Extension</a> installiert habt. Und es muss auch die Konsole der Extension laufen. Falls ihr gerade nicht lokal schon ein PowerShell Skript bearbeitet, kann es sein, dass die Extension Konsole noch nicht l√§uft. Um sie zu starten k√∂nnt ihr per Tastenkombination &ldquo;STRG&rdquo; + &ldquo;Umschalt&rdquo; + &ldquo;P&rdquo; die Command-Palette √∂ffnen. Dort k√∂nnt ihr dann nach &ldquo;PowerShell: Restart Session&rdquo; suchen und den Punkt ausf√ºhren.</p><p><a href=/images/2024/2024-04-23_PS_Remote_VSCode_1.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_VSCode_1.jpg alt="Visual Studio Code - PowerShell Extension neustarten" title="Visual Studio Code - PowerShell Extension neustarten"></a></p><p>Um eine Verbindung mit einem Windows PowerShell System herzustellen, k√∂nnt ihr einfach in der Extension Konsole <code>Enter-PSSession &lt;Hostname></code> ausf√ºhren. Also zum Beispiel:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Enter-PSSession</span> Server1
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-04-23_PS_Remote_VSCode_2.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_VSCode_2.jpg alt="Visual Studio Code - Verbindung zu einem Remote Windows PowerShell System" title="Visual Studio Code - Verbindung zu einem Remote Windows PowerShell System"></a></p><p>Falls ihr euch mit einem PowerShell 7 System verbinden wollt, dann m√ºsst ihr den Parameter <code>-Hostname</code> mitangeben. Ansonsten wird der ausgelassene Parametername als <code>-Computername</code> interpretiert, was nur f√ºr Windows PowerShell Systeme geeignet ist. Bei beiden Varianten k√∂nnt ihr mit <code>-Username</code> einen anderen Username angeben, falls euer Remotesystem es erfordert.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Enter-PSSession</span> -Hostname DC2 -Username administrator
</span></span></code></pre></td></tr></table></div></div><p><a href=/images/2024/2024-04-23_PS_Remote_VSCode_3.jpg><img loading=lazy src=/images/2024/2024-04-23_PS_Remote_VSCode_3.jpg alt="Visual Studio Code - Verbindung zu einem PowerShell 7 System" title="Visual Studio Code - Verbindung zu einem PowerShell 7 System"></a></p><p>Skripte anlegen und bearbeiten ist dann im Grunde wie auch in der Windows PowerShell ISE: Neue Skriptdateien k√∂nnen per <code>New-Item</code> angelegt werden, Skript bearbeiten geht per <code>psedit</code>. Anschlie√üend k√∂nnt ihr auch per F8-Taste die aktuelle Zeile oder Markierung ausf√ºhren, beziehungsweise mit der F5-Taste das ganze Skript.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Anlage Skriptdatei</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>New-Item</span> RemoteBeispiel.ps1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Skript bearbeiten</span>
</span></span><span style=display:flex><span>psedit .\RemoteBeispiel.ps1
</span></span></code></pre></td></tr></table></div></div><p>Theoretisch sollte auch das Remote-Debuggen funktionieren, aber als ich es im M√§rz 2024 getestet habe, hat es gerade nicht funktioniert. Das scheint aber ein bekanntes Problem zu sein, und sollte eigentlich demn√§chst wieder gehen.</p><p>Wenn ihr fertig seid: Eine Remote Session k√∂nnt ihr per <code>Exit-PSSession</code> beenden.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>