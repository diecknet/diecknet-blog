<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Synchronisierte Exchange Objekte ohne Exchange Server verwalten | diecknet</title>
<meta name=keywords content="Hybrid,Exchange,Azure AD Connect,Exchange Server,AAD,Azure Active Directory,Active Directory"><meta name=description content="Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden. Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die Microsoft Dokumentation verweist nur am Rande auf das Thema und erklärt nicht wirklich.
In diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft: Im Microsoft 365 Admin Center wird angezeigt:"><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2023/04/12/exchange-hybrid-without-ever-having-an-exchange-server/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2023/04/12/exchange-hybrid-without-ever-having-an-exchange-server/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Synchronisierte Exchange Objekte ohne Exchange Server verwalten"><meta property="og:description" content="Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden. Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die Microsoft Dokumentation verweist nur am Rande auf das Thema und erklärt nicht wirklich.
In diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft: Im Microsoft 365 Admin Center wird angezeigt:"><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2023/04/12/exchange-hybrid-without-ever-having-an-exchange-server/"><meta property="og:image" content="https://diecknet.de/images/2023/2023-04-12-Exchange-YouTube-Thumbnail.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-12T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-12T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2023/2023-04-12-Exchange-YouTube-Thumbnail.jpg"><meta name=twitter:title content="Synchronisierte Exchange Objekte ohne Exchange Server verwalten"><meta name=twitter:description content="Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden. Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die Microsoft Dokumentation verweist nur am Rande auf das Thema und erklärt nicht wirklich.
In diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft: Im Microsoft 365 Admin Center wird angezeigt:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"Synchronisierte Exchange Objekte ohne Exchange Server verwalten","item":"https://diecknet.de/de/2023/04/12/exchange-hybrid-without-ever-having-an-exchange-server/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Synchronisierte Exchange Objekte ohne Exchange Server verwalten","name":"Synchronisierte Exchange Objekte ohne Exchange Server verwalten","description":"Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden. Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die Microsoft Dokumentation verweist nur am Rande auf das Thema und erklärt nicht wirklich.\nIn diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft: Im Microsoft 365 Admin Center wird angezeigt:","keywords":["Hybrid","Exchange","Azure AD Connect","Exchange Server","AAD","Azure Active Directory","Active Directory"],"articleBody":"Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden. Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die Microsoft Dokumentation verweist nur am Rande auf das Thema und erklärt nicht wirklich.\nIn diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft: Im Microsoft 365 Admin Center wird angezeigt:\nDieser Benutzer wird mit Ihrem lokalen Active Directory synchronisiert. Einige Details können nur über Ihre lokale Active Directory bearbeitet werden\nAber wie kann die Konfiguration über das lokale Active Directory vorgenommen werden?\nVideo zu dem Thema Ich habe auch ein Video zu dem Thema erstellt: Ursache Die Ursache liegt in Azure AD Connect. Auf Grund der Architektur der Verzeichnissynchronisierung zwischen On-Premises Windows Server Active Directory und Azure Active Directory ist festgelegt, dass die Benutzerattribute von On-Premises stammen. Die Änderung ist dann nur an der Quelle möglich. Also im lokalen AD. Allerdings ist die Verwaltung von Exchange-bezogenen Attributen wie z.B. die E-Mail Adresse nur über die Exchange Verwaltungstools supported. Also müssen die Exchange Management Tools lokal installiert werden. Und damit die Attribute an den Benutzerobjekten überhaupt existieren, werden die Exchange Schemaerweiterungen benötigt.\nInstallation Exchange Verwaltungstools und Schemaerweiterungen Wenn noch nie ein Exchange Server beziehungsweise eine Exchange-Organisation im Active Directory vorhanden waren, können trotzdem die Exchange-Schemaerweiterungen im AD installiert werden. Ein vollständiger Exchange Server muss dafür nicht installiert werden.\nVoraussetzungen Es wird ein Computer benötigt, auf dem die Exchange Management Tools installiert werden können.\nBerechtigungen:\nFür die initiale Einrichtung werden Domänenadministratorrechte benötigt Optional kann die spätere Verwaltung von Exchange Empfängern auch an Mitglieder einer Sicherheitsgruppe delegiert werden Betriebssystem:\nWindows Server 2022 (bevorzugt, damit habe ich es getestet) Windows Server 2019 Weitere Komponenten:\n.NET Framework 4.8 (ist bei Windows Server 2022 bereits vorinstalliert) Visual C++ 2012 Runtime Und natürlich muss das aktuellste Exchange Server 2019 CU heruntergeladen und gemounted werden Setup Assistent GUI Das setup.exe vom Exchange Installationsdatenträger starten Beim Schritt “Serverrollenauswahl” folgende Optionen aktivieren: Verwaltungstools Für die Installation von Exchange Server erforderliche Windows Server-Rollen und -Funktionen automatisch installieren Wenn wirklich noch keine Exchange Organisation vorhanden ist, kommt nach der Seite “Speicherplatz und Speicherort der Installation” die Seite “Exchange Organisation”. Hier einen beliebigen Namen für die Exchange Organisation eingeben. Ich nehme z.B. “diecknet-ORG”. Bei der “Bereitschaftsprüfung” wird darauf hingewiesen, dass nun mit Setup /PrepareAD eine Exchange Organisation eingerichtet wird. Nach Abschluss des Setup-Assistenten muss der Computer einmal neugestart werden. Nach Neustart des Servers: Aus dem Microsoft 365 Admin Center unter “Einstellungen” -\u003e “Domänen” die .onmicrosoft.com Domain des Tenants raussuchen. Bei mir ist das zum Beispiel “yr2z8.onmicrosoft.com” Diesen onmicrosoft.com Domainname ergänzen: Zwischen dem Tenantnamen und .onmicrosoft.com den Zusatz .mail einfügen (also so: .mail.onmicrosoft.com). Beispielsweise wird bei mir aus yr2z8.onmicrosoft.com dann yr2z8.mail.onmicrosoft.com.\nEine administrative PowerShell Session starten. Folgenden Befehle ausführen. Dabei natürlich die eigene Domäne einsetzen die wir gerade rausgesucht haben.\n1 2 3 4 Add-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn # Hier die eigene .onmicrosoft.com Domain des Tenants verwenden! New-RemoteDomain -Name \"yr2z8.mail.onmicrosoft.com\" -DomainName \"yr2z8.mail.onmicrosoft.com\" Set-RemoteDomain \"yr2z8.mail.onmicrosoft.com\" -TargetDeliveryDomain $true Das PowerShell Fenster schließen. Das Microsoft.Exchange.Management.PowerShell.SnapIn ist in dieser Konstellation nur für die Anlage der RemoteDomain/TargetDeliveryDomain supported.\nOptional: Berechtigung für Nicht-Domänenadmins zuweisen Eine neue administrative PowerShell Session starten und folgende Befehle ausführen.\n1 2 Add-PSSnapin *RecipientManagement $env:ExchangeInstallPath\\Scripts\\Add-PermissionForEMT.ps1 Anschließend können die User die ebenfalls Exchange Verwaltungen durchführen sollen zur Sicherheitsgruppe “Exchange Recipient Management EMT” hinzugefügt werden.\nVerwaltung von Exchange Attributen Wenn jetzt Exchange Attribute angepasst werden sollen, dann muss zuerst das RecipientManagement PowerShell SnapIn geladen werden. Anschließend können die entsprechenden PowerShell Cmdlets verwendet werden. Beispielsweise New-RemoteMailbox oder Set-RemoteMailbox.\n1 2 3 4 # SnapIn laden Add-PSSnapin *RecipientManagement # Exchange Verwaltung durchführen, z.B. Get-RemoteMailbox Tipps 🏁 Es wäre auch möglich die Exchange Installation inkl. Schemaerweiterung per Commandline/Unattended Install Options durchzuführen:\n1 setup.exe /IAcceptExchangeServerLicenseTerms_DiagnosticDataON /OrganizationName:\"diecknet-ORG\" /Mode:Install /Roles:ManagementTools /InstallWindowsComponents Alle zur Verfügung stehenden Cmdlets lassen sich so auflisten:\n1 2 Add-PSSnapin *RecipientManagement Get-Command -Module *RecipientManagement Um einfacher in die Exchange Recipient Verwaltung zu gelangen, könnt ihr euch eine Desktopverknüpfung anlegen, mit dem Ziel powershell.exe -NoExit -Command \"Add-Snapin *RecipientManagement\". Am besten noch per Rechtsklick auf die Verknüpfung einstellen, dass der Befehl direkt in C:\\ (oder einem beliebigen anderem Ort) ausgeführt wird. Ansonsten wird es nämlich im PowerShell Programm-Ordner ausgeführt und belegt so viel sichtbaren Platz in der Shell 😛. ","wordCount":"709","inLanguage":"de","image":"https://diecknet.de/images/2023/2023-04-12-Exchange-YouTube-Thumbnail.jpg","datePublished":"2023-04-12T00:00:00Z","dateModified":"2023-04-12T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2023/04/12/exchange-hybrid-without-ever-having-an-exchange-server/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>Synchronisierte Exchange Objekte ohne Exchange Server verwalten</h1><div class=post-meta><span title='2023-04-12 00:00:00 +0000 UTC'>2023-04-12</span>&nbsp;·&nbsp;4 Minuten&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2023/2023-04-12-Exchange-Hybrid-without-ever-having-an-Exchange-Server.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-04-12-Exchange-YouTube-Thumbnail.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#video-zu-dem-thema aria-label="Video zu dem Thema">Video zu dem Thema</a></li><li><a href=#ursache aria-label=Ursache>Ursache</a></li><li><a href=#installation-exchange-verwaltungstools-und-schemaerweiterungen aria-label="Installation Exchange Verwaltungstools und Schemaerweiterungen">Installation Exchange Verwaltungstools und Schemaerweiterungen</a><ul><li><a href=#voraussetzungen aria-label=Voraussetzungen>Voraussetzungen</a></li><li><a href=#setup-assistent-gui aria-label="Setup Assistent GUI">Setup Assistent GUI</a></li></ul></li><li><a href=#verwaltung-von-exchange-attributen aria-label="Verwaltung von Exchange Attributen">Verwaltung von Exchange Attributen</a></li><li><a href=#tipps aria-label=Tipps>Tipps</a></li></ul></div></details></div><div class=post-content><p>Es ist ja schon seit einiger Zeit möglich, die Exchange Server Verwaltungstools ohne einen vollständigen Exchange Server zu verwenden.
Die meisten Anleitungen gehen davon aus, dass schon mindestens ein Exchange Server vorhanden war und dieser dann entfernt wird. Und die <a href=https://learn.microsoft.com/en-us/exchange/manage-hybrid-exchange-recipients-with-management-tools title="Manage recipients in Exchange Hybrid environments using Management tools" target=_blank>Microsoft Dokumentation verweist nur am Rande auf das Thema</a> und erklärt nicht wirklich.</p><p>In diesem Post gehe ich auf ein Szenario ein, was vorallem viele kleinere Unternehmen betrifft:
Im Microsoft 365 Admin Center wird angezeigt:</p><blockquote><p>Dieser Benutzer wird mit Ihrem lokalen Active Directory synchronisiert. Einige Details können nur über Ihre lokale Active Directory bearbeitet werden</p></blockquote><p><strong>Aber wie kann die Konfiguration über das lokale Active Directory vorgenommen werden?</strong></p><h2 id=video-zu-dem-thema>Video zu dem Thema<a hidden class=anchor aria-hidden=true href=#video-zu-dem-thema>#</a></h2><p>Ich habe auch ein <a href=https://youtu.be/aDqBk6O0f-0 target=_blank>Video</a> zu dem Thema erstellt:
<a href=https://youtu.be/aDqBk6O0f-0 target=_blank><img loading=lazy src=/images/2023/2023-04-12-Exchange-YouTube-Thumbnail-player.jpg alt="Video Thumbnail &amp;ldquo;Synchronisierte User trotzdem administrieren&amp;rdquo;"></a></p><h2 id=ursache>Ursache<a hidden class=anchor aria-hidden=true href=#ursache>#</a></h2><p>Die Ursache liegt in Azure AD Connect. Auf Grund der Architektur der Verzeichnissynchronisierung zwischen On-Premises Windows Server Active Directory und Azure Active Directory ist festgelegt, dass die Benutzerattribute von On-Premises stammen. Die Änderung ist dann nur an der Quelle möglich. Also im lokalen AD.
Allerdings ist die Verwaltung von Exchange-bezogenen Attributen wie z.B. die E-Mail Adresse nur über die Exchange Verwaltungstools supported. Also müssen die Exchange Management Tools lokal installiert werden. Und damit die Attribute an den Benutzerobjekten überhaupt existieren, werden die Exchange Schemaerweiterungen benötigt.</p><h2 id=installation-exchange-verwaltungstools-und-schemaerweiterungen>Installation Exchange Verwaltungstools und Schemaerweiterungen<a hidden class=anchor aria-hidden=true href=#installation-exchange-verwaltungstools-und-schemaerweiterungen>#</a></h2><p>Wenn noch nie ein Exchange Server beziehungsweise eine Exchange-Organisation im Active Directory vorhanden waren, können trotzdem die Exchange-Schemaerweiterungen im AD installiert werden. Ein vollständiger Exchange Server muss dafür nicht installiert werden.</p><h3 id=voraussetzungen>Voraussetzungen<a hidden class=anchor aria-hidden=true href=#voraussetzungen>#</a></h3><p>Es wird ein Computer benötigt, auf dem die Exchange <em>Management Tools</em> installiert werden können.</p><p>Berechtigungen:</p><ul><li>Für die initiale Einrichtung werden Domänenadministratorrechte benötigt</li><li>Optional kann die spätere Verwaltung von Exchange Empfängern auch an Mitglieder einer Sicherheitsgruppe delegiert werden</li></ul><p>Betriebssystem:</p><ul><li>Windows Server 2022 (bevorzugt, damit habe ich es getestet)</li><li>Windows Server 2019</li></ul><p>Weitere Komponenten:</p><ul><li><a href="https://go.microsoft.com/fwlink/?linkid=2088631" title="Download .NET Framework 4.8" target=_blank>.NET Framework 4.8</a> (ist bei Windows Server 2022 bereits vorinstalliert)</li><li><a href="https://www.microsoft.com/download/details.aspx?id=30679" title="Download: Visual C++ Redistributable for Visual Studio 2012" target=_blank>Visual C++ 2012 Runtime</a></li><li>Und natürlich muss das <a href="https://learn.microsoft.com/en-us/exchange/new-features/updates?view=exchserver-2019" title="Download Exchange Server 2019 CUs" target=_blank>aktuellste Exchange Server 2019 CU heruntergeladen</a> und gemounted werden</li></ul><h3 id=setup-assistent-gui>Setup Assistent GUI<a hidden class=anchor aria-hidden=true href=#setup-assistent-gui>#</a></h3><ol><li>Das <code>setup.exe</code> vom Exchange Installationsdatenträger starten</li><li>Beim Schritt &ldquo;Serverrollenauswahl&rdquo; folgende Optionen aktivieren:<ul><li><input checked disabled type=checkbox> Verwaltungstools</li><li><input checked disabled type=checkbox> Für die Installation von Exchange Server erforderliche Windows Server-Rollen und -Funktionen automatisch installieren</li></ul></li><li>Wenn wirklich noch keine Exchange Organisation vorhanden ist, kommt nach der Seite &ldquo;Speicherplatz und Speicherort der Installation&rdquo; die Seite &ldquo;Exchange Organisation&rdquo;. Hier einen beliebigen Namen für die Exchange Organisation eingeben. Ich nehme z.B. &ldquo;diecknet-ORG&rdquo;.
<img loading=lazy src=/images/2023/2023-04-12-Exchange-ORG-GUI.jpg alt="Exchange Organisation im Setup Assistent konfigurieren"></li><li>Bei der &ldquo;Bereitschaftsprüfung&rdquo; wird darauf hingewiesen, dass nun mit <code>Setup /PrepareAD</code> eine Exchange Organisation eingerichtet wird.</li><li>Nach Abschluss des Setup-Assistenten muss der Computer einmal neugestart werden.</li><li>Nach Neustart des Servers:<ul><li><p>Aus dem Microsoft 365 Admin Center unter &ldquo;Einstellungen&rdquo; -> &ldquo;Domänen&rdquo; die <code>.onmicrosoft.com</code> Domain des Tenants raussuchen. Bei mir ist das zum Beispiel &ldquo;yr2z8.onmicrosoft.com&rdquo;
<img loading=lazy src=/images/2023/2023-04-12-Exchange-Tenant-onmicrosoft.com-Domain.jpg alt="onmicrosoft.com Domäne im Tenant nachschauen unter Einstellungen - Domänen"></p></li><li><p>Diesen onmicrosoft.com Domainname ergänzen: Zwischen dem Tenantnamen und <code>.onmicrosoft.com</code> den Zusatz <code>.mail</code> einfügen (also so: <code>&lt;Tenantname>.mail.onmicrosoft.com</code>). Beispielsweise wird bei mir aus <code>yr2z8.onmicrosoft.com</code> dann <code>yr2z8.mail.onmicrosoft.com</code>.</p></li><li><p>Eine administrative PowerShell Session starten. Folgenden Befehle ausführen. Dabei natürlich die eigene Domäne einsetzen die wir gerade rausgesucht haben.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Add-PSSnapin</span> Microsoft.Exchange.Management.PowerShell.SnapIn
</span></span><span style=display:flex><span><span style=color:#6c7986># Hier die eigene .onmicrosoft.com Domain des Tenants verwenden!</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>New-RemoteDomain</span> -Name <span style=color:#fc6a5d>&#34;yr2z8.mail.onmicrosoft.com&#34;</span> -DomainName <span style=color:#fc6a5d>&#34;yr2z8.mail.onmicrosoft.com&#34;</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Set-RemoteDomain</span> <span style=color:#fc6a5d>&#34;yr2z8.mail.onmicrosoft.com&#34;</span> -TargetDeliveryDomain $true
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/images/2023/2023-04-12-Exchange-RemoteDomain.jpg alt="onmicrosoft.com Domäne als Target Delivery Domain in der On-Premises Umgebung anlegen"></p></li><li><p><strong>Das PowerShell Fenster schließen.</strong> Das <code>Microsoft.Exchange.Management.PowerShell.SnapIn</code> ist in dieser Konstellation nur für die Anlage der RemoteDomain/TargetDeliveryDomain supported.</p></li></ul></li><li>Optional: Berechtigung für Nicht-Domänenadmins zuweisen<ul><li><p>Eine neue administrative PowerShell Session starten und folgende Befehle ausführen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Add-PSSnapin</span> *RecipientManagement
</span></span><span style=display:flex><span><span style=color:#41a1c0>$env:ExchangeInstallPath</span>\Scripts\<span style=color:#d0a8ff>Add-PermissionForEMT</span>.ps1
</span></span></code></pre></td></tr></table></div></div></li><li><p>Anschließend können die User die ebenfalls Exchange Verwaltungen durchführen sollen zur Sicherheitsgruppe &ldquo;Exchange Recipient Management EMT&rdquo; hinzugefügt werden.</p></li></ul></li></ol><h2 id=verwaltung-von-exchange-attributen>Verwaltung von Exchange Attributen<a hidden class=anchor aria-hidden=true href=#verwaltung-von-exchange-attributen>#</a></h2><p>Wenn jetzt Exchange Attribute angepasst werden sollen, dann muss zuerst das RecipientManagement PowerShell SnapIn geladen werden. Anschließend können die entsprechenden PowerShell Cmdlets verwendet werden. Beispielsweise <code>New-RemoteMailbox</code> oder <code>Set-RemoteMailbox</code>.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># SnapIn laden</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Add-PSSnapin</span> *RecipientManagement
</span></span><span style=display:flex><span><span style=color:#6c7986># Exchange Verwaltung durchführen, z.B.</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-RemoteMailbox</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=tipps>Tipps<a hidden class=anchor aria-hidden=true href=#tipps>#</a></h2><ul><li><p>🏁 Es wäre auch möglich die Exchange Installation inkl. Schemaerweiterung per <a href="https://learn.microsoft.com/en-us/exchange/plan-and-deploy/deploy-new-installations/unattended-installs?view=exchserver-2019" title="Use unattended mode in Exchange Setup" target=_blank>Commandline/Unattended Install Options</a> durchzuführen:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>setup.exe /IAcceptExchangeServerLicenseTerms_DiagnosticDataON /OrganizationName:<span style=color:#fc6a5d>&#34;diecknet-ORG&#34;</span> /Mode:Install /Roles:ManagementTools /InstallWindowsComponents
</span></span></code></pre></td></tr></table></div></div></li><li><p>Alle zur Verfügung stehenden Cmdlets lassen sich so auflisten:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Add-PSSnapin</span> *RecipientManagement
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Command</span> -Module *RecipientManagement
</span></span></code></pre></td></tr></table></div></div></li><li><p>Um einfacher in die Exchange Recipient Verwaltung zu gelangen, könnt ihr euch eine Desktopverknüpfung anlegen, mit dem Ziel <code>powershell.exe -NoExit -Command "Add-Snapin *RecipientManagement"</code>. Am besten noch per Rechtsklick auf die Verknüpfung einstellen, dass der Befehl direkt in <code>C:\</code> (oder einem beliebigen anderem Ort) ausgeführt wird. Ansonsten wird es nämlich im PowerShell Programm-Ordner ausgeführt und belegt so viel sichtbaren Platz in der Shell 😛.
<img loading=lazy src=/images/2023/2023-04-12-Exchange-Recipient-Management-Shortcut.jpg alt="Anpassung der Exchange EMT Verknüpfung, sodass sie in C:\ ausgeführt wird"></p></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/hybrid/>Hybrid</a></li><li><a href=https://diecknet.de/de/tags/exchange/>Exchange</a></li><li><a href=https://diecknet.de/de/tags/Azure-AD-Connect/>Azure AD Connect</a></li><li><a href=https://diecknet.de/de/tags/Exchange-Server/>Exchange Server</a></li><li><a href=https://diecknet.de/de/tags/AAD/>AAD</a></li><li><a href=https://diecknet.de/de/tags/Azure-Active-Directory/>Azure Active Directory</a></li><li><a href=https://diecknet.de/de/tags/Active-Directory/>Active Directory</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>