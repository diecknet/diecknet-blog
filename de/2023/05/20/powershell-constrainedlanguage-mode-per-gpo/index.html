<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen | diecknet</title>
<meta name=keywords content="powershell,language mode,constrained language"><meta name=description content="PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.
Gleichzeitig ist das auch ein zweischneidiges Schwert:
Vorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.
Nachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/><link rel=alternate hreflang=en href=https://diecknet.de/en/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen"><meta property="og:description" content="PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.
Gleichzeitig ist das auch ein zweischneidiges Schwert:
Vorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.
Nachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/"><meta property="og:image" content="https://diecknet.de/images/2023/2023-05-21-ConstrainedLanguageModePerGPO.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-20T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-20T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2023/2023-05-21-ConstrainedLanguageModePerGPO.jpg"><meta name=twitter:title content="PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen"><meta name=twitter:description content="PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.
Gleichzeitig ist das auch ein zweischneidiges Schwert:
Vorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.
Nachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/de/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen","item":"https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen","name":"PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen","description":"PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.\nGleichzeitig ist das auch ein zweischneidiges Schwert:\nVorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.\nNachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen.","keywords":["powershell","language mode","constrained language"],"articleBody":"PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.\nGleichzeitig ist das auch ein zweischneidiges Schwert:\nVorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.\nNachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen.\nIch habe auch ein Video zum Thema PowerShell Language Modes erstellt, in dem ich weiter darauf eingehe. In diesem Blog-Beitrag hier geht es aber nur darum, wie der ConstrainedLanguage Mode per Gruppenrichtlinie konfiguriert werden kann. Die anderen Modes lassen sich leider nicht sinnvoll systemweit aktivieren.\nHinweis zu __PSLockdownPolicy Die Umgebungsvariable __PSLockdownPolicy auf den Wert 4 setzen ist √ºbrigens KEIN sicherer oder supporteter Weg um den ConstrainedLanguage Mode zu aktivieren.\nConstrainedLanguage Mode konfigurieren Hinweis: Die Vorgehensweise habe ich mit Windows 11 Enterprise Version 22H2 (Build 22621.1702) evaluiert.\nDer ConstrainedLanguage Mode kann per Windows Defender Application Control (WDAC) oder mit dem √§lteren AppLocker konfiguriert werden. Verwendet am besten eine VM zum Testen, die schnell wieder auf einen funktionsf√§higen Zustand zur√ºckgesetzt werden kann. Es ist m√∂glich sich mit Application Control Policies sehr schnell das System zu zerschie√üen, sodass es nicht mehr bootf√§hig ist.\nUm den ConstrainedLanguage Mode per WDAC zu konfigurieren, verwenden wir das Sub-Feature ‚ÄúCode Integrity‚Äù mit ‚ÄúScript Enforcement‚Äù. Diese Script Enforcement betrifft nicht nur PowerShell, sondern auch einige andere Skript Hosts, die Microsoft als ‚ÄúEnlightened‚Äù bezeichnet. Der Windows Based Script Host (wscript.exe) und Microsoft Console Based Script Host (cscript.exe) blockiert die komplette Ausf√ºhrung von Skripten in den Formaten VBScript, cscript und jscript - egal wo die liegen. √Ñhnlich verh√§lt sich der Microsoft HTML Application Host (mshta.exe) der f√ºr die Ausf√ºhrung von .hta Dateien zust√§ndig ist - die Ausf√ºhrung von .hta Dateien wird pauschal blockiert. Andere Skripte wie z.B. .bat oder .cmd in der cmd.exe werden √ºbrigens gar nicht durch WDAC blockiert. Und auch nicht-Microsoft Skripte wie z.B. Python werden nicht blockiert.\nSchritt 1: Base Policy F√ºr CodeIntegrity gibt es einige Beispiel-Policies, die wir als Grundlage verwenden k√∂nnen. Diese sind unter folgendem Pfad zu finden: C:\\Windows\\schemas\\CodeIntegrity\\ExamplePolicies\nUm weiterhin normale Microsoft Applikationen und Systemkomponenten zu erlauben, kopieren wir uns die AllowMicrosoft.xml in ein Verzeichnis, z.B. C:\\CIPolicy. Dann per PowerShell anpassen, sodass die Policy eine neue GUID, einen neuen Namen und eine Versionsnummer erh√§lt:\n1 2 Set-CIPolicyIdInfo -FilePath MyCIPolicy.xml -PolicyName \"diecknet Code Integrity\" -ResetPolicyID Set-CIPolicyVersion -FilePath MyCIPolicy.xml -Version \"1.0.0.0\" Schritt 2: Bestimmten Dateipfad von der Regel ausschlie√üen Wenn ein bestimmter Ordnerpfad von der Richtlinie ausgenommen werden sollen, z.B. f√ºr Administrative Skripte, k√∂nnen wir eine zus√§tzliche Policy Rule erstellen. Diese Policy Rule kommt in eine neue Richtlinie.\n1 2 $rule = New-CIPolicyRule -FilePathRule \"C:\\AdminSkripte\\*\" New-CIPolicy ‚ÄìFilePath AdminSkripte.xml ‚ÄìRules $rule -UserPEs Das -UserPEs sorgt daf√ºr, dass auch Dateien im User-Mode unter die Richtlinie fallen.\nDann zusammenf√ºhren zu einer neuen Policy Datei:\n1 Merge-CIPolicy -OutputFilePath \"diecknet-Policy.xml\" -PolicyPaths \".\\AllowMicrosoft.xml\",\".\\AdminSkripte.xml\" Wichtig ist jetzt allerdings noch, dass nur Admins in dieses Verzeichnis schreiben d√ºrfen. Sonst k√∂nnten ja alle User einfach neue Skripte in dem Ordner anlegen und sie im FullLanguage Mode ausf√ºhren. Also einmal die Berechtigungen ansehen und ggf. √§ndern. Hier werden nur bestimmte Standard-Admin-SIDs erkannt, also wenn ihr eine Custom Sicherheitsgruppe verwendet und nicht etwa die lokale Administratoren-Gruppe, dann m√ºsst ihr Option 18 aktivieren. Das w√ºrde z.B. so gehen:\n1 2 # Nur notwendig bei benutzerdefinierten Berechtigungen Set-RuleOption -FilePath \"diecknet-Policy.xml\" -Option 18 Schritt 3: Audit Mode deaktivieren Standardm√§√üig ist der Audit Mode aktiv. Da ich hier ohnehin mit einem Testsystem arbeite, lasse ich den Audit Mode weg. Daf√ºr kann entweder wahlweise die Rule mit Enabled:Audit Mode manuell aus der .xml Datei gel√∂scht werden, oder per Set-RuleOption:\n1 Set-RuleOption -FilePath \"diecknet-Policy.xml\" -Option 3 -Delete Schritt 4: Policy zu Binary konvertieren Dann konvertieren die .xml-Policy zu einer Binary Datei:\n1 ConvertFrom-CIPolicy -XmlFilePath diecknet-Policy.xml -BinaryFilePath diecknet-Policy.cip Schritt 5: Testen - Richtlinie lokal anwenden Zum Testen kann die Richtlinie lokal angewandt werden. Am besten vorher einen VM Snapshot erstellen.\n1 CiTool.exe --update-policy diecknet-Policy.cip Wenn ihr jetzt eine neue PowerShell Session startet, sollte sie direkt im ConstrainedLanguage Mode laufen. Um das zu pr√ºfen, schaut den Wert der Variable $ExecutionContext.SessionState.LanguageMode an. Skripte die in C:\\AdminSkripte liegen (oder von Microsoft signiert wurden), sollten im FullLanguage Mode laufen. Skripte in anderen Orten sollten im ConstrainedLanguage Mode laufen.\nDiesen Code hier habe ich zum Testen in test.ps1 verwendet:\n1 2 Write-Host \"Hallo aus $PSScriptRoot\" Write-Host \"Der aktuelle LanguageMode:\"$ExecutionContext.SessionState.LanguageMode Schritt 6: Richtlinie per GPO verteilen Wenn alles passt, kann es auch produktiv ausgerollt werden. Das geht z.B. per Gruppenrichtlinie, Microsoft System Center Configuration Manager oder MDM Tools wie Intune. Ich zeige hier wie es per Gruppenrichtlinie geht, weil das Feature und die Dokumentation von Microsoft vernachl√§ssigt wurde.\nEigentlich gibt es eine Einstellung unter Computerkonfiguration -\u003e Richtlinien -\u003e Administrative Vorlagen -\u003e System -\u003e Device Guard. Allerdings funktioniert das nicht mit Multi-Policy Format Richtlinien, wie wir sie gerade erstellt haben. Microsoft schreibt dazu:\nGroup Policy-based deployment of Windows Defender Application Control policies only supports single-policy format WDAC policies. To use WDAC on devices running Windows 10 1903 and greater, or Windows 11, we recommend using an alternative method for policy deployment.\nStattdessen k√∂nnen wir die Datei aber auch einfach direkt per Gruppenrichtlinien verteilen. Das geht unter Computerkonfiguration -\u003e Einstellungen -\u003e Windows-Einstellungen -\u003e Dateien. Hier einen neuen Eintrag anlegen und die .cip-Quelldatei angeben. Damit sie im Netzwerk verf√ºgbar ist, habe sie einfach in das NETLOGON-Verzeichnis meiner Dom√§ne kopiert. Aber es geht nat√ºrlich jeder beliebige Fileshare.\nAls Zieldatei dann folgenden Pfad angeben: C:\\Windows\\System32\\CodeIntegrity\\CiPolicies\\Active\\{Policy-Guid}.cip Wobei Policy-Guid durch die GUID der Policy ersetzt werden muss. Die geschweiften Klammern sollten aber bleiben. Die PolicyID steht in der .xml-Policy-Datei im Tag . Bei mir es {82C1BF56-B3BC-40FE-AD21-5FC37EBB5CF9}, also ist der vollst√§ndige Zielpfad bei mir: C:\\Windows\\System32\\CodeIntegrity\\CiPolicies\\Active\\{82C1BF56-B3BC-40FE-AD21-5FC37EBB5CF9}.cip\nBei dieser Variante wird die Richtlinie erst beim Neustart des Computers angewandt. Ich habe also gpupdate /force ausgef√ºhrt (eventuell unn√∂tig, aber ich wollte mir einen eventuellen zweiten Neustart sparen) und den Computer neugestartet. Anschlie√üend wurde die Richtlinie wie zuvor in Schritt 5 angewendet.\nFazit Meiner Meinung nach ist die Einrichtung von Windows Defender Application Control / CodeIntegrity / PowerShell Language Modes unn√∂tig kompliziert. Auch dass die moderneren Multi-Policies eigentlich nicht per Gruppenrichtlinien unterst√ºtzt werden finde ich prall.\nWeiterf√ºhrende Links Hier noch ein paar Weiterf√ºhrende Links und Quellen die mir bei der Recherche geholfen haben. Besonders hervorheben m√∂chte ich die Blog-Reihe auf airdesk.com zu WDAC:\nairdesk.com: WDAC and Intune Blog series airdesk.com: WDAC and File Path Rules Und einige sehr gute Infos von HotCakeX:\nWDAC Wiki auf Github von HotCakeX Diese sehr ausf√ºhrliche Antwort zu WDAC hier auf superuser.com Ein paar n√ºtzliche Infos stehen auch bei Microsoft:\nCreate a WDAC policy for fully managed devices Enlightened script hosts that are part of Windows Windows Defender Application Control policy - policy rule options New-CIPolicy Cmdlet Deployment per GPO Entfernen einer WDAC Richtlinie Multi-Richtlinie lokal deployen WDAC EventLogs PowerShell Team: PowerShell Constrained Language Mode ","wordCount":"1139","inLanguage":"de","image":"https://diecknet.de/images/2023/2023-05-21-ConstrainedLanguageModePerGPO.jpg","datePublished":"2023-05-20T00:00:00Z","dateModified":"2023-05-20T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/posts/>Posts</a></div><h1 class=post-title>PowerShell ConstrainedLanguage Mode per Gruppenrichtlinie einstellen</h1><div class=post-meta><span title='2023-05-20 00:00:00 +0000 UTC'>2023-05-20</span>&nbsp;¬∑&nbsp;6 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<ul class=i18n_list>üåç&nbsp;This content is also available in:&nbsp;<li><a href=https://diecknet.de/en/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/>English</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/de/posts/2023/2023-05-21-PowerShell-ConstrainedLanguage-Mode-per-GPO.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-05-21-ConstrainedLanguageModePerGPO.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Inhaltsverzeichnis</span></summary><div class=inner><ul><li><a href=#hinweis-zu-__pslockdownpolicy aria-label="Hinweis zu __PSLockdownPolicy">Hinweis zu <code>__PSLockdownPolicy</code></a></li><li><a href=#constrainedlanguage-mode-konfigurieren aria-label="ConstrainedLanguage Mode konfigurieren">ConstrainedLanguage Mode konfigurieren</a><ul><li><a href=#schritt-1-base-policy aria-label="Schritt 1: Base Policy">Schritt 1: Base Policy</a></li><li><a href=#schritt-2-bestimmten-dateipfad-von-der-regel-ausschlie%c3%9fen aria-label="Schritt 2: Bestimmten Dateipfad von der Regel ausschlie√üen">Schritt 2: Bestimmten Dateipfad von der Regel ausschlie√üen</a></li><li><a href=#schritt-3-audit-mode-deaktivieren aria-label="Schritt 3: Audit Mode deaktivieren">Schritt 3: Audit Mode deaktivieren</a></li><li><a href=#schritt-4-policy-zu-binary-konvertieren aria-label="Schritt 4: Policy zu Binary konvertieren">Schritt 4: Policy zu Binary konvertieren</a></li><li><a href=#schritt-5-testen---richtlinie-lokal-anwenden aria-label="Schritt 5: Testen - Richtlinie lokal anwenden">Schritt 5: Testen - Richtlinie lokal anwenden</a></li><li><a href=#schritt-6-richtlinie-per-gpo-verteilen aria-label="Schritt 6: Richtlinie per GPO verteilen">Schritt 6: Richtlinie per GPO verteilen</a></li></ul></li><li><a href=#fazit aria-label=Fazit>Fazit</a></li><li><a href=#weiterf%c3%bchrende-links aria-label="Weiterf√ºhrende Links">Weiterf√ºhrende Links</a></li></ul></div></details></div><div class=post-content><p>PowerShell Language Modes sind eine M√∂glichkeit die Funktionalit√§t der PowerShell einzuschr√§nken, um die Sicherheit eines Systems zu erh√∂hen. Das ist nat√ºrlich nur ein kleiner Baustein in einer gr√∂√üeren Sicherheitsstrategie, also das alleine ist noch kein ausreichender Schutz f√ºr ein System.</p><p>Gleichzeitig ist das auch ein zweischneidiges Schwert:<br>Vorteil: Wir entziehen potenziellen Angreifern ein m√§chtiges Werkzeug.<br>Nachteil: Wir selbst als Administratoren k√∂nnen die PowerShell an einem System auch nicht mehr richtig nutzen.</p><p>Ich habe auch ein <a href="https://www.youtube.com/watch?v=WmgwybaNwjg" target=_blank>Video zum Thema PowerShell Language Modes erstellt</a>, in dem ich weiter darauf eingehe. In diesem Blog-Beitrag hier geht es aber nur darum, wie der <strong>ConstrainedLanguage</strong> Mode per Gruppenrichtlinie konfiguriert werden kann. Die anderen Modes lassen sich leider nicht sinnvoll systemweit aktivieren.</p><h2 id=hinweis-zu-__pslockdownpolicy>Hinweis zu <code>__PSLockdownPolicy</code><a hidden class=anchor aria-hidden=true href=#hinweis-zu-__pslockdownpolicy>#</a></h2><p>Die Umgebungsvariable <code>__PSLockdownPolicy</code> auf den Wert <code>4</code> setzen ist <a href=https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/ target=_blank>√ºbrigens <strong>KEIN</strong> sicherer oder supporteter Weg um den ConstrainedLanguage Mode zu aktivieren</a>.</p><h2 id=constrainedlanguage-mode-konfigurieren>ConstrainedLanguage Mode konfigurieren<a hidden class=anchor aria-hidden=true href=#constrainedlanguage-mode-konfigurieren>#</a></h2><p><strong>Hinweis: Die Vorgehensweise habe ich mit Windows 11 Enterprise Version 22H2 (Build 22621.1702) evaluiert.</strong></p><p>Der ConstrainedLanguage Mode kann per Windows Defender Application Control (WDAC) oder mit dem √§lteren AppLocker konfiguriert werden.
Verwendet am besten eine VM zum Testen, die schnell wieder auf einen funktionsf√§higen Zustand zur√ºckgesetzt werden kann. Es ist m√∂glich sich mit Application Control Policies sehr schnell das System zu zerschie√üen, sodass es nicht mehr bootf√§hig ist.</p><p>Um den ConstrainedLanguage Mode per WDAC zu konfigurieren, verwenden wir das Sub-Feature &ldquo;Code Integrity&rdquo; mit &ldquo;Script Enforcement&rdquo;. Diese Script Enforcement betrifft nicht nur PowerShell, sondern auch einige andere Skript Hosts, die Microsoft als &ldquo;Enlightened&rdquo; bezeichnet. Der Windows Based Script Host (<code>wscript.exe</code>) und Microsoft Console Based Script Host (<code>cscript.exe</code>) blockiert die komplette Ausf√ºhrung von Skripten in den Formaten <strong>VBScript</strong>, <strong>cscript</strong> und <strong>jscript</strong> - egal wo die liegen.
√Ñhnlich verh√§lt sich der Microsoft HTML Application Host (mshta.exe) der f√ºr die Ausf√ºhrung von <strong>.hta</strong> Dateien zust√§ndig ist - die Ausf√ºhrung von <strong>.hta</strong> Dateien wird pauschal blockiert. Andere Skripte wie z.B. <strong>.bat</strong> oder <strong>.cmd</strong> in der <code>cmd.exe</code> werden √ºbrigens gar nicht durch WDAC blockiert. Und auch nicht-Microsoft Skripte wie z.B. Python werden nicht blockiert.</p><h3 id=schritt-1-base-policy>Schritt 1: Base Policy<a hidden class=anchor aria-hidden=true href=#schritt-1-base-policy>#</a></h3><p>F√ºr CodeIntegrity gibt es einige Beispiel-Policies, die wir als Grundlage verwenden k√∂nnen. Diese sind unter folgendem Pfad zu finden:
<code>C:\Windows\schemas\CodeIntegrity\ExamplePolicies</code></p><p>Um weiterhin normale Microsoft Applikationen und Systemkomponenten zu erlauben, kopieren wir uns die <code>AllowMicrosoft.xml</code> in ein Verzeichnis, z.B. <code>C:\CIPolicy</code>. Dann per PowerShell anpassen, sodass die Policy eine neue GUID, einen neuen Namen und eine Versionsnummer erh√§lt:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#d0a8ff>Set-CIPolicyIdInfo</span> -FilePath MyCIPolicy.xml -PolicyName <span style=color:#fc6a5d>&#34;diecknet Code Integrity&#34;</span> -ResetPolicyID
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Set-CIPolicyVersion</span> -FilePath MyCIPolicy.xml -Version <span style=color:#fc6a5d>&#34;1.0.0.0&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=schritt-2-bestimmten-dateipfad-von-der-regel-ausschlie√üen>Schritt 2: Bestimmten Dateipfad von der Regel ausschlie√üen<a hidden class=anchor aria-hidden=true href=#schritt-2-bestimmten-dateipfad-von-der-regel-ausschlie√üen>#</a></h3><p>Wenn ein bestimmter Ordnerpfad von der Richtlinie ausgenommen werden sollen, z.B. f√ºr Administrative Skripte, k√∂nnen wir eine zus√§tzliche Policy Rule erstellen. Diese Policy Rule kommt in eine neue Richtlinie.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#41a1c0>$rule</span> = <span style=color:#d0a8ff>New-CIPolicyRule</span> -FilePathRule <span style=color:#fc6a5d>&#34;C:\AdminSkripte\*&#34;</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>New-CIPolicy</span> <span style=color:#960050>‚Äì</span>FilePath AdminSkripte.xml <span style=color:#960050>‚Äì</span>Rules <span style=color:#41a1c0>$rule</span> -UserPEs
</span></span></code></pre></td></tr></table></div></div><p>Das <code>-UserPEs</code> sorgt daf√ºr, dass auch Dateien im User-Mode unter die Richtlinie fallen.</p><p>Dann zusammenf√ºhren zu einer neuen Policy Datei:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#d0a8ff>Merge-CIPolicy</span> -OutputFilePath <span style=color:#fc6a5d>&#34;diecknet-Policy.xml&#34;</span> -PolicyPaths <span style=color:#fc6a5d>&#34;.\AllowMicrosoft.xml&#34;</span>,<span style=color:#fc6a5d>&#34;.\AdminSkripte.xml&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Wichtig ist jetzt allerdings noch, dass nur Admins in dieses Verzeichnis schreiben d√ºrfen. Sonst k√∂nnten ja alle User einfach neue Skripte in dem Ordner anlegen und sie im FullLanguage Mode ausf√ºhren.
Also einmal die Berechtigungen ansehen und ggf. √§ndern. Hier werden nur bestimmte Standard-Admin-SIDs erkannt, also wenn ihr eine Custom Sicherheitsgruppe verwendet und nicht etwa die lokale Administratoren-Gruppe, dann m√ºsst ihr <a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/select-types-of-rules-to-create#table-1-windows-defender-application-control-policy---policy-rule-options target=_blank>Option 18</a> aktivieren. Das w√ºrde z.B. so gehen:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#6c7986># Nur notwendig bei benutzerdefinierten Berechtigungen</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Set-RuleOption</span> -FilePath <span style=color:#fc6a5d>&#34;diecknet-Policy.xml&#34;</span> -Option <span style=color:#d0bf69>18</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=schritt-3-audit-mode-deaktivieren>Schritt 3: Audit Mode deaktivieren<a hidden class=anchor aria-hidden=true href=#schritt-3-audit-mode-deaktivieren>#</a></h3><p>Standardm√§√üig ist der Audit Mode aktiv. Da ich hier ohnehin mit einem Testsystem arbeite, lasse ich den Audit Mode weg.
Daf√ºr kann entweder wahlweise die Rule mit <code>Enabled:Audit Mode</code> manuell aus der <code>.xml</code> Datei gel√∂scht werden, oder per <code>Set-RuleOption</code>:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#d0a8ff>Set-RuleOption</span> -FilePath <span style=color:#fc6a5d>&#34;diecknet-Policy.xml&#34;</span> -Option <span style=color:#d0bf69>3</span> -Delete
</span></span></code></pre></td></tr></table></div></div><h3 id=schritt-4-policy-zu-binary-konvertieren>Schritt 4: Policy zu Binary konvertieren<a hidden class=anchor aria-hidden=true href=#schritt-4-policy-zu-binary-konvertieren>#</a></h3><p>Dann konvertieren die <code>.xml</code>-Policy zu einer Binary Datei:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#d0a8ff>ConvertFrom-CIPolicy</span> -XmlFilePath <span style=color:#d0a8ff>diecknet-Policy</span>.xml -BinaryFilePath <span style=color:#d0a8ff>diecknet-Policy</span>.cip
</span></span></code></pre></td></tr></table></div></div><h3 id=schritt-5-testen---richtlinie-lokal-anwenden>Schritt 5: Testen - Richtlinie lokal anwenden<a hidden class=anchor aria-hidden=true href=#schritt-5-testen---richtlinie-lokal-anwenden>#</a></h3><p>Zum Testen kann die Richtlinie lokal angewandt werden. Am besten vorher einen VM Snapshot erstellen.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>CiTool.exe --update-policy <span style=color:#d0a8ff>diecknet-Policy</span>.cip
</span></span></code></pre></td></tr></table></div></div><p>Wenn ihr jetzt eine neue PowerShell Session startet, sollte sie direkt im ConstrainedLanguage Mode laufen. Um das zu pr√ºfen, schaut den Wert der Variable <code>$ExecutionContext.SessionState.LanguageMode</code> an. Skripte die in <code>C:\AdminSkripte</code> liegen (oder von Microsoft signiert wurden), sollten im FullLanguage Mode laufen. Skripte in anderen Orten sollten im ConstrainedLanguage Mode laufen.</p><p><img loading=lazy src=/images/2023/2023-05-20-PSLanguageModeTest.jpg alt="PowerShell Language Mode Test"></p><p>Diesen Code hier habe ich zum Testen in <code>test.ps1</code> verwendet:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Hallo aus </span><span style=color:#41a1c0>$PSScriptRoot</span><span style=color:#fc6a5d>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Write-Host</span> <span style=color:#fc6a5d>&#34;Der aktuelle LanguageMode:&#34;</span><span style=color:#41a1c0>$ExecutionContext</span>.SessionState.LanguageMode
</span></span></code></pre></td></tr></table></div></div><h3 id=schritt-6-richtlinie-per-gpo-verteilen>Schritt 6: Richtlinie per GPO verteilen<a hidden class=anchor aria-hidden=true href=#schritt-6-richtlinie-per-gpo-verteilen>#</a></h3><p>Wenn alles passt, kann es auch produktiv ausgerollt werden. Das geht z.B. per Gruppenrichtlinie, Microsoft System Center Configuration Manager oder MDM Tools wie Intune. Ich zeige hier wie es per Gruppenrichtlinie geht, weil das Feature und die Dokumentation von Microsoft vernachl√§ssigt wurde.</p><p><em>Eigentlich</em> gibt es eine Einstellung unter <code>Computerkonfiguration -> Richtlinien -> Administrative Vorlagen -> System -> Device Guard</code>. Allerdings funktioniert das nicht mit Multi-Policy Format Richtlinien, wie wir sie gerade erstellt haben. Microsoft schreibt dazu:</p><blockquote><p>Group Policy-based deployment of Windows Defender Application Control policies only supports single-policy format WDAC policies. To use WDAC on devices running Windows 10 1903 and greater, or Windows 11, we recommend using an alternative method for policy deployment.</p></blockquote><p>Stattdessen k√∂nnen wir die Datei aber auch einfach direkt per Gruppenrichtlinien verteilen. Das geht unter <code>Computerkonfiguration -> Einstellungen -> Windows-Einstellungen -> Dateien</code>. Hier einen neuen Eintrag anlegen und die <code>.cip</code>-Quelldatei angeben. Damit sie im Netzwerk verf√ºgbar ist, habe sie einfach in das <code>NETLOGON</code>-Verzeichnis meiner Dom√§ne kopiert. Aber es geht nat√ºrlich jeder beliebige Fileshare.<br>Als Zieldatei dann folgenden Pfad angeben: <code>C:\Windows\System32\CodeIntegrity\CiPolicies\Active\{Policy-Guid}.cip</code>
Wobei <code>Policy-Guid</code> durch die GUID der Policy ersetzt werden muss. Die geschweiften Klammern sollten aber bleiben. Die PolicyID steht in der <code>.xml</code>-Policy-Datei im Tag <code>&lt;PolicyId></code>. Bei mir es <code>{82C1BF56-B3BC-40FE-AD21-5FC37EBB5CF9}</code>, also ist der vollst√§ndige Zielpfad bei mir: <code>C:\Windows\System32\CodeIntegrity\CiPolicies\Active\{82C1BF56-B3BC-40FE-AD21-5FC37EBB5CF9}.cip</code></p><p><img loading=lazy src=/images/2023/2023-05-20-WDAC-PolicyID.jpg alt="WDAC Policy ID herausfinden"></p><p><img loading=lazy src=/images/2023/2023-05-20_GPO_File.jpg alt="WDAC Policy per GPO Dateien verteilen"></p><p>Bei dieser Variante wird die Richtlinie erst beim Neustart des Computers angewandt. Ich habe also <code>gpupdate /force</code> ausgef√ºhrt (eventuell unn√∂tig, aber ich wollte mir einen eventuellen zweiten Neustart sparen) und den Computer neugestartet. Anschlie√üend wurde die Richtlinie wie zuvor in Schritt 5 angewendet.</p><h2 id=fazit>Fazit<a hidden class=anchor aria-hidden=true href=#fazit>#</a></h2><p>Meiner Meinung nach ist die Einrichtung von Windows Defender Application Control / CodeIntegrity / PowerShell Language Modes unn√∂tig kompliziert. Auch dass die moderneren Multi-Policies eigentlich nicht per Gruppenrichtlinien unterst√ºtzt werden finde ich prall.</p><h2 id=weiterf√ºhrende-links>Weiterf√ºhrende Links<a hidden class=anchor aria-hidden=true href=#weiterf√ºhrende-links>#</a></h2><p>Hier noch ein paar Weiterf√ºhrende Links und Quellen die mir bei der Recherche geholfen haben. Besonders hervorheben m√∂chte ich die Blog-Reihe auf airdesk.com zu WDAC:</p><ul><li><a href=https://airdesk.com/2019/11/mdac-and-intune-blog-series/ target=_blank>airdesk.com: WDAC and Intune Blog series</a></li><li><a href=https://airdesk.com/2019/11/mdac-and-path-rules/ target=_blank>airdesk.com: WDAC and File Path Rules</a></li></ul><p>Und einige sehr gute Infos von HotCakeX:</p><ul><li><a href=https://github.com/HotCakeX/Harden-Windows-Security/wiki/Introduction target=_blank>WDAC Wiki auf Github von HotCakeX</a></li><li><a href=https://superuser.com/questions/1741554/i-cant-get-windows-defender-application-control-policy-working-in-windows-11/1771065#1771065 target=_blank>Diese sehr ausf√ºhrliche Antwort zu WDAC hier auf superuser.com</a></li></ul><p>Ein paar n√ºtzliche Infos stehen auch bei Microsoft:</p><ul><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-wdac-policy-for-fully-managed-devices target=_blank>Create a WDAC policy for fully managed devices</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/design/script-enforcement#enlightened-script-hosts-that-are-part-of-windows target=_blank>Enlightened script hosts that are part of Windows</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/select-types-of-rules-to-create#table-1-windows-defender-application-control-policy---policy-rule-options target=_blank>Windows Defender Application Control policy - policy rule options</a></li><li><a href="https://learn.microsoft.com/en-us/powershell/module/configci/new-cipolicy?view=windowsserver2022-ps" target=_blank>New-CIPolicy Cmdlet</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deployment/deploy-windows-defender-application-control-policies-using-group-policy target=_blank>Deployment per GPO</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/disable-windows-defender-application-control-policies target=_blank>Entfernen einer WDAC Richtlinie</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/deploy-multiple-windows-defender-application-control-policies target=_blank>Multi-Richtlinie lokal deployen</a></li><li><a href=https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/event-id-explanations target=_blank>WDAC EventLogs</a></li><li><a href=https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/ target=_blank>PowerShell Team: PowerShell Constrained Language Mode</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/de/tags/powershell/>Powershell</a></li><li><a href=https://diecknet.de/de/tags/language-mode/>Language Mode</a></li><li><a href=https://diecknet.de/de/tags/constrained-language/>Constrained Language</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopieren";function s(){t.innerHTML="Kopiert!",setTimeout(()=>{t.innerHTML="Kopieren"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>