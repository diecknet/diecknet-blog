<!doctype html><html lang=de dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Powershell | diecknet</title>
<meta name=keywords content><meta name=description content><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/de/tags/powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://diecknet.de/de/tags/powershell/feed.xml><link rel=alternate hreflang=de href=https://diecknet.de/de/tags/powershell/><link rel=alternate hreflang=en href=https://diecknet.de/en/tags/powershell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Powershell"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://diecknet.de/de/tags/powershell/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Powershell"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/de/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/tags/powershell/ title=Deutsch aria-label=Deutsch><b>Deutsch</b></a></li><li><a href=https://diecknet.de/en/tags/powershell/ title=English aria-label=English>English</a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/de/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/de/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/de/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/de/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://diecknet.de/de/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/de/tags/>Tags</a></div><h1>Powershell</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>WMI in PowerShell verwenden</h2></header><div class=entry-content><p>WMI ist eine m√§chtige Schnittstelle um Windows Systeme zu verwalten. Dadurch ist der Zugriff auf Dinge m√∂glich, f√ºr die es vielleicht sonst gar keine eigenen PowerShell Cmdlets gibt. Teilweise k√∂nnen wir so mehr Infos abrufen, als die Standard-Cmdlets liefern. Das geht sowohl lokal, als auch remote.
Deprecated: Die alten WMI Cmdlets Es gibt ein paar √§ltere Cmdlets, die allerdings f√ºr Neuentwicklungen nicht empfohlen werden. Aber vielleicht sto√üt ihr in √§lteren Skripten mal dar√ºber, also jetzt habt ihr schon mal davon geh√∂rt - die existieren zumindest....</p></div><footer class=entry-footer><span title='2024-09-20 00:00:00 +0000 UTC'>2024-09-20</span>&nbsp;¬∑&nbsp;12 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to WMI in PowerShell verwenden" href=https://diecknet.de/de/2024/09/20/powershell-wmi/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Das Problem mit Array += in PowerShell</h2></header><div class=entry-content><p>Die PowerShell macht es leider recht einfach ineffizienten Code zu schreiben. Viele Leute benutzen zum Beispiel die += Schreibweise um ein Array zu bef√ºllen. Nicht empfehlenswert!
1 2 3 4 5 # So bitte nicht machen! $Array = @() for ($i = 0; $i -lt 10000; $i++) { $Array += $i } Mit Measure-Command k√∂nnen wir messen, wie lange die Ausf√ºhrung eines Skriptblocks dauert. Bei mir hat die Ausf√ºhrung des obigen Codes in einer Test-VM √ºber 2 Sekunden ben√∂tigt....</p></div><footer class=entry-footer><span title='2024-09-12 00:00:00 +0000 UTC'>2024-09-12</span>&nbsp;¬∑&nbsp;3 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Das Problem mit Array += in PowerShell" href=https://diecknet.de/de/2024/09/12/powershell-array-plus/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell NTFS Alternate Data Streams</h2></header><div class=entry-content><p>Das Dateisystem NTFS wird standardm√§√üig unter Windows verwendet. Und normalerweise hat eine Datei nur einen dazugeh√∂rigen normalen Datenstrom (Data Stream) mit dem Namen :$DATA. Aber es gibt auch die sogenannten ‚ÄúAlternate Data Streams‚Äù (ADS), die zus√§tzliche Daten enthalten k√∂nnen.
Diese ADS werden teilweise vom System verwendet, k√∂nnten aber auch von Angreifern verwendet werden, um Daten zu verstecken.
Ich habe zu dem Thema auch ein YouTube Video erstellt.
NTFS Alternate Data Stream auslesen Aus dem Internet heruntergeladene Dateien erhalten bei vielen Browsern unter Windows ein ‚ÄúMark of the web‚Äù (MOTW) im Zone....</p></div><footer class=entry-footer><span title='2024-08-30 00:00:00 +0000 UTC'>2024-08-30</span>&nbsp;¬∑&nbsp;3 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell NTFS Alternate Data Streams" href=https://diecknet.de/de/2024/08/30/powershell-ntfs-alternate-data-streams/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Calculated Properties</h2></header><div class=entry-content><p>Wenn ihr per PowerShell Daten exportiert (zum Beispiel in eine CSV-Datei per Export-CSV), dann werden die originalen Eigenschaftsnamen von den PowerShell Objekten verwendet. Wenn die aber nicht ganz passend f√ºr euren Zweck sind, dann k√∂nnt ihr sie auch anpassen. Daf√ºr k√∂nnen sogenannte ‚ÄúCalculcated Properties‚Äù und das Cmdlet Select-Object verwendet werden.
Damit k√∂nnen zum Beispiel:
Eigenschaften umbenannt werden Eigenschaftswerte formatiert werden Komplett eigene Eigenschaften erzeugt werden (z.B. durch den Aufruf zus√§tzlicher Cmdlets) Ich habe zu diesem Thema auch ein Video auf meinem YouTube Kanal ver√∂ffentlicht....</p></div><footer class=entry-footer><span title='2024-08-21 00:00:00 +0000 UTC'>2024-08-21</span>&nbsp;¬∑&nbsp;7 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Calculated Properties" href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Write-Host VS. Write-Output</h2></header><div class=entry-content><p>In PowerShell k√∂nnt ihr ja Text mit dem Cmdlet Write-Host ausgeben. Aber es wird teilweise davon abgeraten das zu verwenden. Es gibt zum Beispiel die Alternative Write-Output. In diesem Post erkl√§re ich euch die Unterschiede.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Write-Host Write-Host gibt Daten auf dem PowerShell Host aus, dem Programm, welches die aktuelle PowerShell Sitzung hostet. Oft ist das der ConsoleHost, aber z.B. die PowerShell ISE oder Visual Studio Code verwenden eigene Hosts, die sich in manchen Aspekten voneinander unterscheiden....</p></div><footer class=entry-footer><span title='2024-07-05 00:00:00 +0000 UTC'>2024-07-05</span>&nbsp;¬∑&nbsp;4 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Write-Host VS. Write-Output" href=https://diecknet.de/de/2024/07/05/powershell-write-host-vs-write-output/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Per PowerShell .zip-Archive erstellen und entpacken</h2></header><div class=entry-content><p>Windows kann eigentlich schon ziemlich lange mit ZIP-Archiven umgehen. Und auch die PowerShell kann das, also sowohl ZIP-Dateien erstellen, als auch sie entpacken. Das kann n√ºtzlich sein, wenn ihr z.B. mit einem PowerShell Skript mehrere Dateien zu einer ZIP-Datei zusammenfassen wollt - das erleichtert das wegkopieren. Oder vielleicht um eine per Skript aus dem Internet geladene ZIP-Datei zu extrahieren.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt....</p></div><footer class=entry-footer><span title='2024-06-08 00:00:00 +0000 UTC'>2024-06-08</span>&nbsp;¬∑&nbsp;3 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Per PowerShell .zip-Archive erstellen und entpacken" href=https://diecknet.de/de/2024/06/08/powershell-zip/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Befehle auf mehrere Zeilen aufteilen</h2></header><div class=entry-content><p>PowerShell Befehle mit vielen Parametern k√∂nnen die Lesbarkeit vom Code verschlechtern. Zum Beispiel habe ich im nachfolgenden Codeabschnitt in Zeile 5 das Cmdlet New-ADUser verwendet und dabei 7 Parameter angegeben. Das ist sehr schwer auf einer Zeile zu lesen, selbst wenn ihr einen Ultra-Wide Monitor verwendet.
1 2 3 4 5 6 $CSVFile = Import-Csv .\NeueUser.csv foreach($User in $CSVFile) { $Manager = Get-ADUser -Filter "mail -eq '$($User.Manager)'" New-ADUser -Name "$($User.Vorname) $($User....</p></div><footer class=entry-footer><span title='2024-05-15 00:00:00 +0000 UTC'>2024-05-15</span>&nbsp;¬∑&nbsp;6 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Befehle auf mehrere Zeilen aufteilen" href=https://diecknet.de/de/2024/05/15/powershell-multiline-commands/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>NULL in PowerShell</h2></header><div class=entry-content><p>Wenn ihr in PowerShell pr√ºfen wollt, ob ein Wert nicht gesetzt ist, dann k√∂nnt ihr einen Vergleich mit $null machen. Diese automatische Variable bedeutet immer null, nichts, kein Wert. Das ist aber etwas anderes, als wenn ihr einfach Anf√ºhrungszeichen "" nehmt und dann nichts reinschreibt. Zum Beispiel ergibt das hier immer FALSE:
1 2 3 4 5 $null -eq "" # = false $null -eq '' # = false # Hat √ºbrigens nichts mit der Zahl 0 zu tun // also das ergibt auch False $null -eq 0 # = false üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt....</p></div><footer class=entry-footer><span title='2024-04-29 00:00:00 +0000 UTC'>2024-04-29</span>&nbsp;¬∑&nbsp;7 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to NULL in PowerShell" href=https://diecknet.de/de/2024/04/29/powershell-null/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Skripte remote entwickeln</h2></header><div class=entry-content><p>Es ist m√∂glich PowerShell Skripte remote zu entwickeln. Also das Skript wird auf einem remote Computer gespeichert und ausgef√ºhrt, aber die Eingabe erfolgt im lokalen Editor-Tool. Das geht sowohl mit der klassischen Windows PowerShell ISE, als auch mit Visual Studio Code. In VSCode k√∂nnt ihr sowohl mit remote Windows PowerShell, als auch remote PowerShell 7 Systemen arbeiten. üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Windows PowerShell ISE Die Windows PowerShell ISE unterst√ºtzt nur remote Windows Systeme mit Windows PowerShell....</p></div><footer class=entry-footer><span title='2024-04-23 00:00:00 +0000 UTC'>2024-04-23</span>&nbsp;¬∑&nbsp;3 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Skripte remote entwickeln" href=https://diecknet.de/de/2024/04/23/powershell-remote-script-development/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Ausgabe unterdr√ºcken</h2></header><div class=entry-content><p>Manchmal geben PowerShell Befehle eine R√ºckmeldung aus, obwohl uns das gar nicht interessiert. Es gibt verschiedene Szenarien, wie ihr die Ausgaben unterdr√ºcken k√∂nnt.
üé¨ Ich habe √ºbrigens auch ein Video zu dem Thema erstellt.
Ich verwende hier zum Beispiel das Cmdlet New-NetFirewallRule mit dem ich eine neue Regel in der Windows Firewall hinzuf√ºgen kann:
1 New-NetFirewallRule -DisplayName "Ausgehende Verbindungen zu Port 443 blockieren" -Direction Outbound -RemotePort 443 -Protocol TCP -Action Block Wenn ich das ausf√ºhre, dann kriege ich als R√ºckgabe ein Objekt, welches die Firewall Regel repr√§sentiert....</p></div><footer class=entry-footer><span title='2024-04-09 00:00:00 +0000 UTC'>2024-04-09</span>&nbsp;¬∑&nbsp;4 Minuten&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Ausgabe unterdr√ºcken" href=https://diecknet.de/de/2024/04/09/powershell-suppress-output/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://diecknet.de/de/tags/powershell/page/2/>N√§chste&nbsp;&nbsp;¬ª</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/de/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/de/legal/>Impressum</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/de/privacy/>Datenschutz</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>