<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Verify Auto-Expanding Archives in Exchange Online | diecknet</title>
<meta name=keywords content="exchange,exchange online,powershell,archive mailbox"><meta name=description content="If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.
In the Exchange Admin Center (EAC), open the info pane of the user&rsquo;s mailbox. Click on &ldquo;Manage mailbox archive&rdquo;.
An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Verify Auto-Expanding Archives in Exchange Online"><meta property="og:description" content="If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.
In the Exchange Admin Center (EAC), open the info pane of the user&rsquo;s mailbox. Click on &ldquo;Manage mailbox archive&rdquo;.
An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/"><meta property="og:image" content="https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-04T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png"><meta name=twitter:title content="Verify Auto-Expanding Archives in Exchange Online"><meta name=twitter:description content="If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.
In the Exchange Admin Center (EAC), open the info pane of the user&rsquo;s mailbox. Click on &ldquo;Manage mailbox archive&rdquo;.
An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/en/posts/"},{"@type":"ListItem","position":2,"name":"Verify Auto-Expanding Archives in Exchange Online","item":"https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Verify Auto-Expanding Archives in Exchange Online","name":"Verify Auto-Expanding Archives in Exchange Online","description":"If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.\nIn the Exchange Admin Center (EAC), open the info pane of the user\u0026rsquo;s mailbox. Click on \u0026ldquo;Manage mailbox archive\u0026rdquo;.\nAn Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage.","keywords":["exchange","exchange online","powershell","archive mailbox"],"articleBody":"If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.\nIn the Exchange Admin Center (EAC), open the info pane of the user’s mailbox. Click on “Manage mailbox archive”.\nAn Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage.\nBy the way: This license note is apparently shown regardless whether that user has an Exchange Online Plan 2 license assigned or not:\nUnlimited storage is a premium feature that requires an Exchange Online Plan 2 or Exchange Online Archiving license to enable it for each user mailbox\"\nAnd it still mentions “unlimited storage”, even though since 2021-11-01 the Archiving does not include “unlimited storage” anymore. The storage is now limited to 1.5 TB.\nCheck for additional storage locations When the main Archive of the Mailbox reaches it’s limit of 100 GB, another storage gets added. The additional storage is called “Auxilary Archive” or short “AuxArchive”.\nI wrote a PowerShell function to list all the Mailbox locations of a user. It also lists some storage consumption information.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # prerequisite: Exchange Online PowerShell module, must be connected to the service function Get-AdditionalMailbox($Identity) { $MailboxLocations = (Get-MailboxLocation -User $Identity) $AdditionalMailbox = forEach($MailboxLocation in $MailboxLocations) { $MailboxStats = Get-MailboxStatistics -Identity ($MailboxLocation.MailboxGuid).ToString() # output this to the foreach loop: [PSCustomObject]@{ \"MailboxID\"=$MailboxLocation.MailboxGuid; \"MailboxType\"=$MailboxLocation.MailboxLocationType; \"TotalItemSize\"=$MailboxStats.TotalItemSize; \"TotalDeletedItemSize\"=$MailboxStats.TotalDeletedItemSize; } } return $AdditionalMailbox } Example of result:\nThe user has a “Primary” mailbox, a “MainArchive” mailbox and another “AuxArchive” mailbox.\nRelated Links Office 365: Auto-Expanding Archive FAQ (Exchange Team Blog) Microsoft Caps Exchange Online’s Unlimited Archive at 1.5 TB (Practical 365) ","wordCount":"300","inLanguage":"en","image":"https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png","datePublished":"2021-11-04T00:00:00Z","dateModified":"2021-11-04T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/en/posts/>Posts</a></div><h1 class=post-title>Verify Auto-Expanding Archives in Exchange Online</h1><div class=post-meta><span title='2021-11-04 00:00:00 +0000 UTC'>2021-11-04</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/en/posts/2021/2021-11-04-Exchange-Online-Auto-Expanding-Archives.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#check-for-additional-storage-locations aria-label="Check for additional storage locations">Check for additional storage locations</a></li><li><a href=#related-links aria-label="Related Links">Related Links</a></li></ul></div></details></div><div class=post-content><p>If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.</p><p>In the Exchange Admin Center (EAC), open the info pane of the user&rsquo;s mailbox. Click on &ldquo;Manage mailbox archive&rdquo;.</p><p><a href=/images/2021/2021-11-04_Exchange_Online_Mailbox.png><img loading=lazy src=/images/2021/2021-11-04_Exchange_Online_Mailbox.png alt="Exchange Admin Center - Mailbox Pane" title="Exchange Admin Center - Mailbox Pane"></a></p><p>An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage.</p><p><a href=/images/2021/2021-11-04_Exchange_Online_Mailbox_Archive_Usage.png><img loading=lazy src=/images/2021/2021-11-04_Exchange_Online_Mailbox_Archive_Usage.png alt="Exchange Admin Center - Archive Mailbox Usage" title="Exchange Admin Center - Archive Mailbox Usage"></a></p><p>By the way: This license note is apparently shown regardless whether that user has an Exchange Online Plan 2 license assigned or not:</p><blockquote><p>Unlimited storage is a premium feature that requires an Exchange Online Plan 2 or Exchange Online Archiving license to enable it for each user mailbox"</p></blockquote><p>And it still mentions &ldquo;unlimited storage&rdquo;, even though since 2021-11-01 the Archiving does not include &ldquo;unlimited storage&rdquo; anymore. The storage is now limited to 1.5 TB.</p><h2 id=check-for-additional-storage-locations>Check for additional storage locations<a hidden class=anchor aria-hidden=true href=#check-for-additional-storage-locations>#</a></h2><p>When the main Archive of the Mailbox reaches it&rsquo;s limit of 100 GB, another storage gets added. The additional storage is called &ldquo;Auxilary Archive&rdquo; or short &ldquo;AuxArchive&rdquo;.</p><p>I wrote a PowerShell function to list all the Mailbox locations of a user. It also lists some storage consumption information.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># prerequisite: Exchange Online PowerShell module, must be connected to the service</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>function</span> <span style=color:#d0a8ff>Get-AdditionalMailbox($Identity</span>) {
</span></span><span style=display:flex><span>    <span style=color:#41a1c0>$MailboxLocations</span> = (<span style=color:#d0a8ff>Get-MailboxLocation</span> -User <span style=color:#41a1c0>$Identity</span>)
</span></span><span style=display:flex><span>    <span style=color:#41a1c0>$AdditionalMailbox</span> = <span style=color:#fc5fa3>forEach</span>(<span style=color:#41a1c0>$MailboxLocation</span> <span style=color:#fc5fa3>in</span> <span style=color:#41a1c0>$MailboxLocations</span>) {
</span></span><span style=display:flex><span>        <span style=color:#41a1c0>$MailboxStats</span> = <span style=color:#d0a8ff>Get-MailboxStatistics</span> -Identity (<span style=color:#41a1c0>$MailboxLocation</span>.MailboxGuid).ToString()
</span></span><span style=display:flex><span>        <span style=color:#6c7986># output this to the foreach loop:</span>
</span></span><span style=display:flex><span>        [PSCustomObject]@{
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;MailboxID&#34;</span>=<span style=color:#41a1c0>$MailboxLocation</span>.MailboxGuid;
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;MailboxType&#34;</span>=<span style=color:#41a1c0>$MailboxLocation</span>.MailboxLocationType;
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;TotalItemSize&#34;</span>=<span style=color:#41a1c0>$MailboxStats</span>.TotalItemSize;
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;TotalDeletedItemSize&#34;</span>=<span style=color:#41a1c0>$MailboxStats</span>.TotalDeletedItemSize;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#fc5fa3>return</span> <span style=color:#41a1c0>$AdditionalMailbox</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Example of result:</p><p>The user has a &ldquo;Primary&rdquo; mailbox, a &ldquo;MainArchive&rdquo; mailbox and another &ldquo;AuxArchive&rdquo; mailbox.</p><p><a href=/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png><img loading=lazy src=/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png alt="Exchange Online PowerShell - Custom command to retrieve all mailbox locations of a user mailbox" title="Exchange Online PowerShell - Custom command to retrieve all mailbox locations of a user mailbox"></a></p><h2 id=related-links>Related Links<a hidden class=anchor aria-hidden=true href=#related-links>#</a></h2><ul><li><a href=https://techcommunity.microsoft.com/t5/exchange-team-blog/office-365-auto-expanding-archives-faq/ba-p/607784 target=_blank>Office 365: Auto-Expanding Archive FAQ (Exchange Team Blog)</a></li><li><a href=https://practical365.com/microsoft-caps-exchange-onlines-unlimited-archive/ target=_blank>Microsoft Caps Exchange Online’s Unlimited Archive at 1.5 TB (Practical 365)</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/en/tags/exchange/>Exchange</a></li><li><a href=https://diecknet.de/en/tags/exchange-online/>Exchange Online</a></li><li><a href=https://diecknet.de/en/tags/powershell/>Powershell</a></li><li><a href=https://diecknet.de/en/tags/archive-mailbox/>Archive Mailbox</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>