<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Set Teams Meeting Dial-in number using PowerShell | diecknet</title>
<meta name=keywords content="teams,microsoft teams,teams dial in number,teams audio conferencing"><meta name=description content="You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.
The phone number in the meeting invite is based on the UsageLocation attribute of the user - once when the user gets enabled for Audio Conferencing. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/><link rel=alternate hreflang=en href=https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Set Teams Meeting Dial-in number using PowerShell"><meta property="og:description" content="You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.
The phone number in the meeting invite is based on the UsageLocation attribute of the user - once when the user gets enabled for Audio Conferencing. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/"><meta property="og:image" content="https://diecknet.de/images/2021/2021-10-05_TeamsMeeting-DialIn-Number_thumbnail.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-05T00:00:00+00:00"><meta property="article:modified_time" content="2021-10-05T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2021/2021-10-05_TeamsMeeting-DialIn-Number_thumbnail.png"><meta name=twitter:title content="Set Teams Meeting Dial-in number using PowerShell"><meta name=twitter:description content="You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.
The phone number in the meeting invite is based on the UsageLocation attribute of the user - once when the user gets enabled for Audio Conferencing. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/en/posts/"},{"@type":"ListItem","position":2,"name":"Set Teams Meeting Dial-in number using PowerShell","item":"https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Set Teams Meeting Dial-in number using PowerShell","name":"Set Teams Meeting Dial-in number using PowerShell","description":"You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.\nThe phone number in the meeting invite is based on the UsageLocation attribute of the user - once when the user gets enabled for Audio Conferencing. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned.\n","keywords":["teams","microsoft teams","teams dial in number","teams audio conferencing"],"articleBody":"You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.\nThe phone number in the meeting invite is based on the UsageLocation attribute of the user - once when the user gets enabled for Audio Conferencing. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned.\nUse Teams Admin Center to change Dial-In Number for a single user Users ➔ Manage Users ➔ Click on any user ➔ Click on “Edit” next to “Audio Conferencing” ➔ Select “Toll number” according to User Location.\nUse PowerShell to change Dial-In Number for multiple users Note: You need to have the Microsoft Teams PowerShell module installed.\nI call these numbers “Dial-In numbers”, but the internal name is “ServiceNumber”. You can get a list of all available numbers using Get-CsOnlineDialInConferencingServiceNumber.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Connect to MS Teams Connect-MicrosoftTeams # List all available dial-in numbers Get-CsOnlineDialInConferencingServiceNumber # Set Dial-in number. This is an example value. Yes, we omit the leading +plus symbol. $dialInNumber = 1234567890 # Get all users that you want to change. This is an example that gets all users with UsageLocation \"US\" - change accordingly to your needs with other filters $users = Get-CsOnlineUser -Filter 'UsageLocation -eq \"US\"' -ResultSize Unlimited # Loop through the users foreach($user in $users) { # Apply new dial-in number for meetings for each user Set-CsOnlineDialInConferencingUser -Identity $user.Identity -ServiceNumber $dialInNumber } Source Initial assignment of phone numbers\n","wordCount":"269","inLanguage":"en","image":"https://diecknet.de/images/2021/2021-10-05_TeamsMeeting-DialIn-Number_thumbnail.png","datePublished":"2021-10-05T00:00:00Z","dateModified":"2021-10-05T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/en/posts/>Posts</a></div><h1 class=post-title>Set Teams Meeting Dial-in number using PowerShell</h1><div class=post-meta><span title='2021-10-05 00:00:00 +0000 UTC'>2021-10-05</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<ul class=i18n_list>🌍&nbsp;Dieser Inhalt ist auch verfügbar auf:&nbsp;<li><a href=https://diecknet.de/de/2021/10/05/Set-Teams-Meeting-Dialin-number-powershell/>Deutsch</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/en/posts/2021/2021-10-05-Set-Teams-Meeting-Dialin-number-powershell.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-10-05_TeamsMeeting-DialIn-Number_thumbnail.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#use-teams-admin-center-to-change-dial-in-number-for-a-single-user aria-label="Use Teams Admin Center to change Dial-In Number for a single user">Use Teams Admin Center to change Dial-In Number for a single user</a></li><li><a href=#use-powershell-to-change-dial-in-number-for-multiple-users aria-label="Use PowerShell to change Dial-In Number for multiple users">Use PowerShell to change Dial-In Number for multiple users</a></li><li><a href=#source aria-label=Source>Source</a></li></ul></div></details></div><div class=post-content><p>You can using Microsoft Teams Audio Conferencing licenses to get Dial-In phone numbers for your meetings. The license is needed per user that creates the meeting invites.</p><p>The phone number in the meeting invite is based on the UsageLocation attribute of the user - <strong>once when the user gets enabled for Audio Conferencing</strong>. So even if you fix a wrong UsageLocation, the user will still have the old dial-in number assigned.</p><h2 id=use-teams-admin-center-to-change-dial-in-number-for-a-single-user>Use Teams Admin Center to change Dial-In Number for a single user<a hidden class=anchor aria-hidden=true href=#use-teams-admin-center-to-change-dial-in-number-for-a-single-user>#</a></h2><p>Users ➔ Manage Users ➔ Click on any user ➔ Click on &ldquo;Edit&rdquo; next to &ldquo;Audio Conferencing&rdquo; ➔ Select &ldquo;Toll number&rdquo; according to User Location.</p><p><a href=/images/2021/2021-10-05_TeamsMeeting-DialIn-Number.png><img loading=lazy src=/images/2021/2021-10-05_TeamsMeeting-DialIn-Number.png alt="Microsoft Teams Admin Center with options to change the dialin number for a user." title="Microsoft Teams Admin Center with options to change the dialin number for a user."></a></p><h2 id=use-powershell-to-change-dial-in-number-for-multiple-users>Use PowerShell to change Dial-In Number for multiple users<a hidden class=anchor aria-hidden=true href=#use-powershell-to-change-dial-in-number-for-multiple-users>#</a></h2><p><strong>Note:</strong> You need to have the <a href=https://docs.microsoft.com/en-us/microsoftteams/teams-powershell-install target=_blank>Microsoft Teams PowerShell module</a> installed.</p><p>I call these numbers &ldquo;Dial-In numbers&rdquo;, but the internal name is &ldquo;ServiceNumber&rdquo;. You can get a list of all available numbers using <code>Get-CsOnlineDialInConferencingServiceNumber</code>.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Connect to MS Teams</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Connect-MicrosoftTeams</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># List all available dial-in numbers</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-CsOnlineDialInConferencingServiceNumber</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Set Dial-in number. This is an example value. Yes, we omit the leading +plus symbol.</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$dialInNumber</span> = <span style=color:#d0bf69>1234567890</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Get all users that you want to change. This is an example that gets all users with UsageLocation &#34;US&#34; - change accordingly to your needs with other filters</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$users</span> = <span style=color:#d0a8ff>Get-CsOnlineUser</span> -Filter <span style=color:#fc6a5d>&#39;UsageLocation -eq &#34;US&#34;&#39;</span> -ResultSize Unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Loop through the users</span>
</span></span><span style=display:flex><span><span style=color:#fc5fa3>foreach</span>(<span style=color:#41a1c0>$user</span> <span style=color:#fc5fa3>in</span> <span style=color:#41a1c0>$users</span>) {
</span></span><span style=display:flex><span> <span style=color:#6c7986># Apply new dial-in number for meetings for each user</span>
</span></span><span style=display:flex><span> <span style=color:#d0a8ff>Set-CsOnlineDialInConferencingUser</span> -Identity <span style=color:#41a1c0>$user</span>.Identity -ServiceNumber <span style=color:#41a1c0>$dialInNumber</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=source>Source<a hidden class=anchor aria-hidden=true href=#source>#</a></h2><p><a href=https://docs.microsoft.com/en-us/microsoftteams/set-the-phone-numbers-included-on-invites-in-teams#initial-assignment-of-phone-numbers-that-are-included-in-the-meeting-invites-for-new-users target=_blank>Initial assignment of phone numbers</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/en/tags/teams/>Teams</a></li><li><a href=https://diecknet.de/en/tags/microsoft-teams/>Microsoft Teams</a></li><li><a href=https://diecknet.de/en/tags/teams-dial-in-number/>Teams Dial in Number</a></li><li><a href=https://diecknet.de/en/tags/teams-audio-conferencing/>Teams Audio Conferencing</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>