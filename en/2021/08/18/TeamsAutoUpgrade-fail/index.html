<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Moving from Skype for Business to Teams sucks | diecknet</title>
<meta name=keywords content="MicrosoftTeams,SkypeForBusiness"><meta name=description content="The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: They had no issues using Teams until 2021-07-31.
Issue: Suddenly Skype Meetings are back in Outlook mobile One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.
That particular client manages their Microsoft 365 tenant themselves."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/2021/08/18/TeamsAutoUpgrade-fail/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://diecknet.de/en/2021/08/18/TeamsAutoUpgrade-fail/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Moving from Skype for Business to Teams sucks"><meta property="og:description" content="The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: They had no issues using Teams until 2021-07-31.
Issue: Suddenly Skype Meetings are back in Outlook mobile One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.
That particular client manages their Microsoft 365 tenant themselves."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/en/2021/08/18/TeamsAutoUpgrade-fail/"><meta property="og:image" content="https://diecknet.de/images/2021/2021-08-05_TeamsUpgradeInMinusOneDays.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-18T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-18T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2021/2021-08-05_TeamsUpgradeInMinusOneDays.png"><meta name=twitter:title content="Moving from Skype for Business to Teams sucks"><meta name=twitter:description content="The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: They had no issues using Teams until 2021-07-31.
Issue: Suddenly Skype Meetings are back in Outlook mobile One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.
That particular client manages their Microsoft 365 tenant themselves."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/en/posts/"},{"@type":"ListItem","position":2,"name":"Moving from Skype for Business to Teams sucks","item":"https://diecknet.de/en/2021/08/18/TeamsAutoUpgrade-fail/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Moving from Skype for Business to Teams sucks","name":"Moving from Skype for Business to Teams sucks","description":"The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: They had no issues using Teams until 2021-07-31.\nIssue: Suddenly Skype Meetings are back in Outlook mobile One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.\nThat particular client manages their Microsoft 365 tenant themselves.","keywords":["MicrosoftTeams","SkypeForBusiness"],"articleBody":"The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: They had no issues using Teams until 2021-07-31.\nIssue: Suddenly Skype Meetings are back in Outlook mobile One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.\nThat particular client manages their Microsoft 365 tenant themselves. They were already exclusively using Teams for quite a while (\u003e2 years), but never switched to “TeamsOnly” mode. I’m sure they don’t read their Message Center entries on a regular basis (if ever). Microsoft informs the client with a message like this, when the automatic upgrade fails:\nWe ran into a problem upgrading your organization to Microsoft Teams, so we paused your upgrade. We understand you were expecting this upgrade to happen soon, and we apologize for the delay.\nHow does this affect me? Your users should have the same Skype for Business experience they’re accustomed to using. It should appear as if nothing has changed.\nWhat do I need to do to prepare for this change? We’re working to fix the problem that caused us to pause your upgrade. We’ll notify you when we’re ready, once again, to upgrade your users to Teams.\nThere are no actions you need to take. Please click Additional Information below to learn more.\nAnd promptly after in another Message:\nAs part of the upcoming Skype for Business Online service retirement (originally announced in MC219641 of July ‘20), your organization has been scheduled for an assisted upgrade to help transition your Skype for Business Online users to Microsoft Teams. However, we paused your scheduled upgrade after detecting one or more DNS records that point to a domain in an on-premises Skype for Business deployment. These records are required if your organization includes on-premises Skype for Business users.\nIf your organization does not have any on-premises Skype for Business Server or Lync Server users, these DNS records must be updated to point to Microsoft 365 or removed by August 13, 2021.\nMicrosoft cannot take this step for you. If you do not remove stale DNS records, your assisted upgrade will still be rescheduled for a later date, but taking these steps gives you greater control over the upgrade experience.\nOkay, so the upgrade was halted. According to the Message the client had DNS entries pointing to an on-premises Skype for Business Server system. Thing is: The client does not have a S4B Server. And they never had one in the past. The upgrade process just assumes, that the client has one.\nThe actual issue The actual issue is, that this particular client has Wildcard DNS entries for their domains in public DNS. So when the Upgrade Process checks for the Skype DNS entries, it’ll receive the IP-Address of the client’s website. The upgrade process does not check if:\nthe domain uses wildcard DNS entries the provided DNS answer actually points to a running Skype for Business Server environment (or if it ever did in the past) The instructions in the error message (when manually trying to upgrade to Teams) is not really helpful: Microsoft assumes the client actually has a S4b deployment, so they only recommend to migrate the users with Move-CsUser. Side-note: A while ago this error message was only visible when trying to upgrade to TeamsOnly using PowerShell. The Teams Admin Center just showed an “unknown error”.\nThe solution After creating DNS entries in the customers DNS zone to point to Skype for Business Online, we could upgrade the tenant to Teams Only. The Skype Meeting option in Outlook for iOS went back to Teams Meeting soon afterwards.\nThese are the DNS entries (source):\nSRV records Type Service Protocol Port Weight Priority TTL Name Target SRV _sip _tls 443 1 100 1 hour sipdir.online.lync.com SRV _sipfederationtls _tcp 5061 1 100 1 hour sipfed.online.lync.com CNAME records Type Host name Destination TTL CNAME sip. sipdir.online.lync.com 1 hour CNAME lyncdiscover. webdir.online.lync.com 1 hour My thoughts on the issue First of all I wish the automatic/assisted Upgrade would do a better job on understanding the DNS configuration of a domain. Alternatively there should be atleast an option to just skip the DNS Check when upgrading to TeamsOnly mode. Something like a -Force Option for Grant-CsTeamsUpgradePolicy -Global.\nEither of those ways would make the transition to TeamsOnly mode way easier and smoother.\n","wordCount":"738","inLanguage":"en","image":"https://diecknet.de/images/2021/2021-08-05_TeamsUpgradeInMinusOneDays.png","datePublished":"2021-08-18T00:00:00Z","dateModified":"2021-08-18T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/en/2021/08/18/TeamsAutoUpgrade-fail/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/en/posts/>Posts</a></div><h1 class=post-title>Moving from Skype for Business to Teams sucks</h1><div class=post-meta><span title='2021-08-18 00:00:00 +0000 UTC'>2021-08-18</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/en/posts/2021/2021-08-18-TeamsAutoUpgrade-fail.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-08-05_TeamsUpgradeInMinusOneDays.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#issue-suddenly-skype-meetings-are-back-in-outlook-mobile aria-label="Issue: Suddenly Skype Meetings are back in Outlook mobile">Issue: Suddenly Skype Meetings are back in Outlook mobile</a></li><li><a href=#the-actual-issue aria-label="The actual issue">The actual issue</a></li><li><a href=#the-solution aria-label="The solution">The solution</a><ul><li><a href=#srv-records aria-label="SRV records">SRV records</a></li><li><a href=#cname-records aria-label="CNAME records">CNAME records</a></li></ul></li><li><a href=#my-thoughts-on-the-issue aria-label="My thoughts on the issue">My thoughts on the issue</a></li></ul></div></details></div><div class=post-content><p>The upgrade process from Skype for Business Online to Microsoft Teams is a disaster. I had several SMB clients reporting unnecessary errors regarding Teams/Skype. With unnecessary I mean: <strong>They had no issues using Teams until 2021-07-31.</strong></p><h2 id=issue-suddenly-skype-meetings-are-back-in-outlook-mobile>Issue: Suddenly Skype Meetings are back in Outlook mobile<a hidden class=anchor aria-hidden=true href=#issue-suddenly-skype-meetings-are-back-in-outlook-mobile>#</a></h2><p>One client reported, that they suddenly have Skype Meetings in Outlook on iOS again, instead of Teams Meetings.</p><p><img loading=lazy src=/images/2021/2021-08-11-TeamsUpgrade_SuddenlySkypeMeetings.png alt="Skype Meeting in Outlook on iOS" title="Skype Meeting in Outlook on iOS"></p><p>That particular client manages their Microsoft 365 tenant themselves. They were already exclusively using Teams for quite a while (>2 years), but never switched to &ldquo;TeamsOnly&rdquo; mode. I&rsquo;m sure they don&rsquo;t read their Message Center entries on a regular basis (if ever). Microsoft informs the client with a message like this, when the automatic upgrade fails:</p><blockquote><p>We ran into a problem upgrading your organization to Microsoft Teams, so we paused your upgrade. We understand you were expecting this upgrade to happen soon, and we apologize for the delay.</p><p><strong>How does this affect me?</strong> Your users should have the same Skype for Business experience they&rsquo;re accustomed to using. It should appear as if nothing has changed.</p><p><strong>What do I need to do to prepare for this change?</strong> We&rsquo;re working to fix the problem that caused us to pause your upgrade. We&rsquo;ll notify you when we&rsquo;re ready, once again, to upgrade your users to Teams.</p><p>There are no actions you need to take. Please click Additional Information below to learn more.</p></blockquote><p>And promptly after in another Message:</p><blockquote><p>As part of the upcoming Skype for Business Online service retirement (originally announced in MC219641 of July &lsquo;20), your organization has been scheduled for an <a href=https://docs.microsoft.com/en-us/microsoftteams/upgrade-assisted target=_blank>assisted upgrade</a> to help transition your Skype for Business Online users to Microsoft Teams. However, we paused your scheduled upgrade after detecting one or more DNS records that point to a domain in an on-premises Skype for Business deployment. These records are required if your organization includes on-premises Skype for Business users.</p><p>If your organization does not have any on-premises Skype for Business Server or Lync Server users, these DNS records must be updated to point to Microsoft 365 or removed by <strong>August 13, 2021</strong>.</p><p>Microsoft cannot take this step for you. If you do not remove stale DNS records, your assisted upgrade will still be rescheduled for a later date, but taking these steps gives you greater control over the upgrade experience.</p></blockquote><p>Okay, so the upgrade was halted. According to the Message the client had DNS entries pointing to an on-premises Skype for Business Server system. Thing is: <strong>The client does not have a S4B Server.</strong> And they never had one in the past. The upgrade process just assumes, that the client has one.</p><p><img loading=lazy src=/images/2021/2021-08-18_TeamsUpgradePaused.png alt="The Teams-Upgrade was paused!" title="The Teams-Upgrade was paused!"></p><h2 id=the-actual-issue>The actual issue<a hidden class=anchor aria-hidden=true href=#the-actual-issue>#</a></h2><p><img loading=lazy src=/images/2021/2021-08-18_TeamsUpgradeFailed.png alt="We can&amp;rsquo;t upgrade this organization to &amp;lsquo;Teams Only&amp;rsquo; mode." title="We can't upgrade this organization to 'Teams Only' mode."></p><p>The actual issue is, that this particular client has Wildcard DNS entries for their domains in public DNS. So when the Upgrade Process checks for the Skype DNS entries, it&rsquo;ll receive the IP-Address of the client&rsquo;s website. The upgrade process does not check if:</p><ul><li>the domain uses wildcard DNS entries</li><li>the provided DNS answer actually points to a running Skype for Business Server environment (or if it ever did in the past)</li></ul><p>The instructions in the error message (when manually trying to upgrade to Teams) is not really helpful: Microsoft assumes the client actually has a S4b deployment, so they only recommend to migrate the users with <code>Move-CsUser</code>.
Side-note: A while ago this error message was only visible when trying to upgrade to TeamsOnly using PowerShell. The Teams Admin Center just showed an &ldquo;unknown error&rdquo;.</p><h2 id=the-solution>The solution<a hidden class=anchor aria-hidden=true href=#the-solution>#</a></h2><p>After creating DNS entries in the customers DNS zone to point to Skype for Business Online, we could upgrade the tenant to Teams Only. The Skype Meeting option in Outlook for iOS went back to Teams Meeting soon afterwards.</p><p>These are the DNS entries (<a href=https://docs.microsoft.com/en-us/skypeforbusiness/troubleshoot/online-configuration/dns-configuration-issue target=_blank>source</a>):</p><h3 id=srv-records>SRV records<a hidden class=anchor aria-hidden=true href=#srv-records>#</a></h3><table><thead><tr><th>Type</th><th>Service</th><th>Protocol</th><th>Port</th><th>Weight</th><th>Priority</th><th>TTL</th><th>Name</th><th>Target</th></tr></thead><tbody><tr><td>SRV</td><td>_sip</td><td>_tls</td><td>443</td><td>1</td><td>100</td><td>1 hour</td><td><strong>&lt;DomainName></strong></td><td>sipdir.online.lync.com</td></tr><tr><td>SRV</td><td>_sipfederationtls</td><td>_tcp</td><td>5061</td><td>1</td><td>100</td><td>1 hour</td><td><strong>&lt;DomainName></strong></td><td>sipfed.online.lync.com</td></tr></tbody></table><h3 id=cname-records>CNAME records<a hidden class=anchor aria-hidden=true href=#cname-records>#</a></h3><table><thead><tr><th>Type</th><th>Host name</th><th>Destination</th><th>TTL</th></tr></thead><tbody><tr><td>CNAME</td><td>sip.<strong>&lt;DomainName></strong></td><td>sipdir.online.lync.com</td><td>1 hour</td></tr><tr><td>CNAME</td><td>lyncdiscover.<strong>&lt;DomainName></strong></td><td>webdir.online.lync.com</td><td>1 hour</td></tr></tbody></table><h2 id=my-thoughts-on-the-issue>My thoughts on the issue<a hidden class=anchor aria-hidden=true href=#my-thoughts-on-the-issue>#</a></h2><p>First of all I wish the automatic/assisted Upgrade would do a better job on understanding the DNS configuration of a domain. Alternatively there should be atleast an option to just skip the DNS Check when upgrading to TeamsOnly mode. Something like a <code>-Force</code> Option for <code>Grant-CsTeamsUpgradePolicy -Global</code>.<br>Either of those ways would make the transition to TeamsOnly mode way easier and smoother.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/en/tags/MicrosoftTeams/>MicrosoftTeams</a></li><li><a href=https://diecknet.de/en/tags/SkypeForBusiness/>SkypeForBusiness</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>