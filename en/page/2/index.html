<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.130.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>diecknet</title>
<meta name=description content><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://diecknet.de/en/feed.xml><link rel=alternate hreflang=de href=https://diecknet.de/de/><link rel=alternate hreflang=en href=https://diecknet.de/en/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="diecknet"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://diecknet.de/en/"><meta name=twitter:card content="summary"><meta name=twitter:title content="diecknet"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"diecknet","url":"https://diecknet.de/","description":"","thumbnailUrl":"https://diecknet.de/favicon.ico","sameAs":["https://youtube.com/@diecknet","https://linkedin.com/in/diecknet","https://ieji.de/@diecknet","https://github.com/diecknet/"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span class=active>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-AA-EXO.jpg alt></figure><header class=entry-header><h2>Automate Exchange Online with Azure Automation in 2024</h2></header><div class=entry-content><p>If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (this statement was last checked in June 2024).
Legacy approach In the past, RunAs Accounts or Plaintext Credentials (ü§¢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don‚Äôt have to say anything about plaintext passwords, do I? You could still use App Registrations in Entra ID, but if you really just want to automate some Exchange settings via Azure Automation, it‚Äôs not really necessary....</p></div><footer class=entry-footer><span title='2023-01-09 00:00:00 +0000 UTC'>2023-01-09</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Automate Exchange Online with Azure Automation in 2024" href=https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2022/2022-07-21_Azure-AD-Connect-Staging-mode-is-enabled.png alt></figure><header class=entry-header><h2>Set Azure AD Connect Staging Mode via PowerShell</h2></header><div class=entry-content><p>Here‚Äôs a quick tip on howto enable or disable the Staging Mode in Azure AD Connect via PowerShell. Sadly there is no native Cmdlet in the style of Set-ADSyncStagingMode or something like that.
In this article I‚Äôll first explain the approach and then later on list the full command block you can use. So feel free to skip below to the end of the post. The following PowerShell Cmdlets have to get executed on the Azure AD Connect Server....</p></div><footer class=entry-footer><span title='2022-07-21 00:00:00 +0000 UTC'>2022-07-21</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Set Azure AD Connect Staging Mode via PowerShell" href=https://diecknet.de/en/2022/07/21/Azure-AD-Connect-Staging-mode-PowerShell/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2022/2022-06-22_Exchange_Server_Incomplete_Installation_Detected_small.png alt></figure><header class=entry-header><h2>Exchange Server Setup Incomplete but fails to complete</h2></header><div class=entry-content><p>I had an issue with a broken Exchange Server 2016 CU23. Or rather it was not fully installed. It was just a test environment, but I thought it would be useful or interesting to drill down on that issue.
I‚Äôll guide you through my troubleshooting steps / thought process.
Try to continue Setup First I tried to resume the setup. The setup fails early - at Step 1 of 13: Stopping Services....</p></div><footer class=entry-footer><span title='2022-06-23 00:00:00 +0000 UTC'>2022-06-23</span>&nbsp;¬∑&nbsp;8 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Exchange Server Setup Incomplete but fails to complete" href=https://diecknet.de/en/2022/06/23/Exchange-Server-Setup-Incomplete-fail-stopping-services/></a></article><article class=post-entry><header class=entry-header><h2>How to remove all merged Git Branches on Windows</h2></header><div class=entry-content><p>Here‚Äôs a quick tip on howto remove Git Branches that were already merged (thus not necessary to keep around anymore) locally on Windows, using PowerShell. Assuming that you do have Git for Windows installed. Execute these commands on your own risk.
List all merged branches You can list all merged Git Branches by running:
1 git branch --merged Exclude current branch and ‚Äúmain‚Äù branch Then we |-pipe it into the following, to exclude the currently selected branch (marked with an asterisk *) and the main branch....</p></div><footer class=entry-footer><span title='2022-06-21 00:00:00 +0000 UTC'>2022-06-21</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to How to remove all merged Git Branches on Windows" href=https://diecknet.de/en/2022/06/21/Git-on-Windows-remove-all-merged-branches/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2022/2022-06-16-Graph_Explorer.png alt></figure><header class=entry-header><h2>How to get Group Membership count with Microsoft Graph API</h2></header><div class=entry-content><p>Apparently it‚Äôs not that easy to get the amount of members of a group with the Microsoft Graph API. We need to specify the additional header ConsistencyLevel: eventual to use the Advanced Query Capabilities. Then we can use the Query parameter $count. Alternatively I found that I could also add it as an URL query parameter instead. That would be &amp;ConsistencyLevel=eventual.
Example Queries Replace the Group ID (02bd9fd6-8f93-4758-87c3-1fb73740a315) with your desired Azure Active Directory Group ID....</p></div><footer class=entry-footer><span title='2022-06-16 00:00:00 +0000 UTC'>2022-06-16</span>&nbsp;¬∑&nbsp;1 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to How to get Group Membership count with Microsoft Graph API" href=https://diecknet.de/en/2022/06/16/Get-Group-membership-count-with-microsoft-graph-api/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2022/2022-02-02_thumbnail.png alt></figure><header class=entry-header><h2>How to configure MFA methods for Azure AD</h2></header><div class=entry-content><p>This post is outdated. The ‚Äúauthentcation methods policy‚Äù is now easily available in the Entra portal. You might still need to migrate from the legacy settings, read the whole article at Microsoft Learn.
OLD POST for reference In my opinion the official Microsoft Documentation lacks of any clear information on where to configure the allowed MFA methods for Azure AD. So if you‚Äôre also wondering on how to configure the allowed Multi-Factor-Authentication methods for Microsoft 365, you‚Äôve come to right place....</p></div><footer class=entry-footer><span title='2022-02-02 00:00:00 +0000 UTC'>2022-02-02</span>&nbsp;¬∑&nbsp;1 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to How to configure MFA methods for Azure AD" href=https://diecknet.de/en/2022/02/02/How-to-configure-M365-azure-ad-MFA-methods/></a></article><article class=post-entry><header class=entry-header><h2>List all Users with administrative roles in a Microsoft 365 environment</h2></header><div class=entry-content><p>Option 1: Use M365 Admin Portal There is finally a way in the main Microsoft 365 Admin Portal. Go to ‚ÄúRoles‚Äù -> ‚ÄúRole assignments‚Äù and click on ‚ÄúExport admin list‚Äù to get a CSV file with all admins and their roles.
Option 2: Use PowerShell / Azure AD Graph Module Just a short PowerShell snippet to list all users with administrative roles in a Microsoft 365 (or Azure AD) environment. Please note that this uses the older Azure AD Graph Module (already planned for deprecation)....</p></div><footer class=entry-footer><span title='2021-12-13 00:00:00 +0000 UTC'>2021-12-13</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to List all Users with administrative roles in a Microsoft 365 environment" href=https://diecknet.de/en/2021/12/13/How-to-list-all-users-with-admin-roles-m365/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-11-12_bookings-permissions.csv.png alt></figure><header class=entry-header><h2>List all Microsoft Booking Calendars</h2></header><div class=entry-content><p>If you‚Äôre using Microsoft Booking in your Microsoft 365 Tenant, you might want to list all of the Booking calendars. Booking uses Exchange Online Mailboxes in the background. Every Booking Calendar has a corresponding Mailbox of the type ‚ÄúSchedulingMailbox‚Äù. If an user gets assigned ‚ÄúAdministrator‚Äù for a Booking Calendar, they get ‚ÄúFullAccess‚Äù permissions for the Scheduling Mailbox.
List all Booking Calendars with permission I wrote a PowerShell script to list all the Booking Mailboxes with the users that have access....</p></div><footer class=entry-footer><span title='2021-11-12 00:00:00 +0000 UTC'>2021-11-12</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to List all Microsoft Booking Calendars" href=https://diecknet.de/en/2021/11/12/List-All-Microsoft-Booking-Mailboxes/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png alt></figure><header class=entry-header><h2>Verify Auto-Expanding Archives in Exchange Online</h2></header><div class=entry-content><p>If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.
In the Exchange Admin Center (EAC), open the info pane of the user‚Äôs mailbox. Click on ‚ÄúManage mailbox archive‚Äù.
An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage....</p></div><footer class=entry-footer><span title='2021-11-04 00:00:00 +0000 UTC'>2021-11-04</span>&nbsp;¬∑&nbsp;2 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Verify Auto-Expanding Archives in Exchange Online" href=https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-10-27_SimpleIP.de.update.png alt></figure><header class=entry-header><h2>The Downside of going serverless</h2></header><div class=entry-content><p>After creating SimpleIP.de as a serverless application (see my blog post My simple serverless journey was not that easy) I was kinda proud. Interesting technology, small and useful website. Nice.
Reality But after a while reality kicked in. I was playing around with some IPv6 systems, when it hit me. With the previous design, the site would show only the primary IP-Address of the client. If the client supports both IPv6 and IPv4, it would still only show one IP-Address....</p></div><footer class=entry-footer><span title='2021-10-27 00:00:00 +0000 UTC'>2021-10-27</span>&nbsp;¬∑&nbsp;3 min&nbsp;¬∑&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to The Downside of going serverless" href=https://diecknet.de/en/2021/10/27/My-simple-serverless-journey-part2/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://diecknet.de/en/>¬´&nbsp;Prev&nbsp;
</a><a class=next href=https://diecknet.de/en/page/3/>Next&nbsp;&nbsp;¬ª</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>