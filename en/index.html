<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.137.0"><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>diecknet</title>
<meta name=description content><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://diecknet.de/en/feed.xml><link rel=alternate hreflang=de href=https://diecknet.de/de/><link rel=alternate hreflang=en href=https://diecknet.de/en/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="diecknet"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://diecknet.de/en/"><meta name=twitter:card content="summary"><meta name=twitter:title content="diecknet"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"diecknet","url":"https://diecknet.de/","description":"","thumbnailUrl":"https://diecknet.de/favicon.ico","sameAs":["https://youtube.com/@diecknet","https://linkedin.com/in/diecknet","https://ieji.de/@diecknet","https://github.com/diecknet/"]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span class=active>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class="first-entry home-info"><header class=entry-header><h1>Moin.</h1></header><div class=entry-content>Andreas Dieckmann here. I work as an selfemployed IT consultant and have been in the industry for years. I'm sharing IT related blog posts here to help others.</div><footer class=entry-footer><div class=social-icons><a href=https://youtube.com/@diecknet target=_blank rel="noopener noreferrer me" title=Youtube><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78.0 00-1.94-2C18.88 4 12 4 12 4s-6.88.0-8.6.46a2.78 2.78.0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78.0 003.4 19c1.72.46 8.6.46 8.6.46s6.88.0 8.6-.46a2.78 2.78.0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/></svg>
</a><a href=https://linkedin.com/in/diecknet target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://ieji.de/@diecknet target=_blank rel="noopener noreferrer me" title=Mastodon><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.58 13.913c-.29 1.469-2.592 3.121-5.238 3.396-1.379.184-2.737.368-4.185.276-2.368-.092-4.237-.551-4.237-.551.0.184.014.459.043.643.308 2.294 2.317 2.478 4.22 2.57 1.922.0 3.633-.46 3.633-.46l.079 1.653s-1.344.734-3.738.918c-1.32.091-2.96-.092-4.869-.551-4.14-1.102-4.853-5.507-4.961-10.005-.034-1.285-.013-2.57-.013-3.58.0-4.589 3-5.966 3-5.966 1.513-.734 4.11-1.01 6.808-1.01h.067c2.699.0 5.296.276 6.81 1.01.0.0 3 1.377 3 5.967.0.0.037 3.304-.419 5.69" stroke="currentcolor"/><path d="M17.832 8.633v5h-1.978V8.78c0-1.023-.43-1.542-1.29-1.542-.95.0-1.427.616-1.427 1.834v2.655H11.17V9.072c0-1.218-.476-1.834-1.427-1.834-.86.0-1.29.52-1.29 1.542v4.852H6.475V8.633c0-1.022.26-1.834.782-2.434.538-.6 1.243-.909 2.118-.909 1.012.0 1.779.39 2.286 1.169l.492.827.493-.827c.507-.78 1.274-1.169 2.286-1.169.875.0 1.58.308 2.118.909.522.6.782 1.412.782 2.434" fill="currentcolor" stroke="none"/></svg>
</a><a href=https://github.com/diecknet/ target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></footer></article><article class=post-entry><header class=entry-header><h2>Retrieve infos about Active Directory Based Activation via PowerShell</h2></header><div class=entry-content><p>If you quickly want to retrieve infos about Active Directory Based Activation (ADBA) in your domain, you can use this PowerShell One-liner:
1 Get-ADDomain | %{Get-ADObject -SearchBase "CN=Activation Objects,CN=Microsoft SPP,CN=Services,CN=Configuration,$($_.DistinguishedName)" -LDAPFilter "(objectclass=msspp-activationobject)" -Properties * -ErrorAction SilentlyContinue | fl displayName,DistinguishedName,Name,msspp-csvlkpartialproductkey } I haven’t tested it in a multi-domain environment, but I think it should work.
Explanation The code uses aliases, which are not great in scripts, but neat in One-Liners. It uses Get-ADDomain to determine the Distinguished Name for the Domain. This should make the code portable.
...</p></div><footer class=entry-footer><span title='2024-11-25 00:00:00 +0000 UTC'>2024-11-25</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Retrieve infos about Active Directory Based Activation via PowerShell" href=https://diecknet.de/en/2024/11/25/powershell-show-adba-infos/></a></article><article class=post-entry><header class=entry-header><h2>TryHackMe Blueprint - Cyber Security Write-Up</h2></header><div class=entry-content><p>I decided to try a bit more Penetration Testing/Ethical Hacking. The following is a Write-Up regarding the TryHackMe room “Blueprint”.
Tasks The only info that we have is:
Do you have what is takes to hack into this Windows Machine?
And the questions:
“Lab” user NTLM hash decrypted root.txt So we can assume it’s a Windows machine.
Discovery I booted up my Kali linux machine and created a folder on my Desktop to use as a workspace.
...</p></div><footer class=entry-footer><span title='2024-09-24 00:00:00 +0000 UTC'>2024-09-24</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to TryHackMe Blueprint - Cyber Security Write-Up" href=https://diecknet.de/en/2024/09/24/tryhackme-blueprint/></a></article><article class=post-entry><header class=entry-header><h2>PowerShell NTFS Alternate Data Streams</h2></header><div class=entry-content><p>The NTFS file system is used by default in Windows. And normally a file has only one associated normal data stream with the name :$DATA. But there are also the so-called “Alternate Data Streams” (ADS), which can contain additional data. These ADS are not visible in the Windows Explorer or most other applications.
ADS are sometimes used by the system, but could also be used by attackers to hide data.
...</p></div><footer class=entry-footer><span title='2024-08-30 00:00:00 +0000 UTC'>2024-08-30</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell NTFS Alternate Data Streams" href=https://diecknet.de/en/2024/08/30/powershell-ntfs-alternate-data-streams/></a></article><article class=post-entry><header class=entry-header><h2>PowerShell Calculated Properties</h2></header><div class=entry-content><p>If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called “Calculated Properties” and the cmdlet Select-Object can be used for this.
This can be used, for example, to
Rename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter. However, the parameter usually does not have to be named explicitly.
...</p></div><footer class=entry-footer><span title='2024-08-21 00:00:00 +0000 UTC'>2024-08-21</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell Calculated Properties" href=https://diecknet.de/en/2024/08/21/powershell-calculated-properties/></a></article><article class=post-entry><header class=entry-header><h2>PowerShell: Filter Active Directory Computers</h2></header><div class=entry-content><p>I recently worked on a client project, where I had to do some work around Active Directory Computers. I used PowerShell and some light filtering and processing. And now I share those examples, and hopefully someone finds them interesting or helpful. Maybe it will be me, who finds it interesting in the future. In that case: Moin Andi! 👋
Example 1: Filter Computer by Operating System Version The AD attribute OperatingSystemVersion holds the OS version with the build number in a format like this: 10.0 (19041)
...</p></div><footer class=entry-footer><span title='2024-08-07 00:00:00 +0000 UTC'>2024-08-07</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to PowerShell: Filter Active Directory Computers" href=https://diecknet.de/en/2024/08/07/powershell-active-directory-computers-filtering/></a></article><article class=post-entry><header class=entry-header><h2>Migrating from 11ty to Hugo</h2></header><div class=entry-content><p>I recently upgraded this website to 11ty v2.0, but I needed more change. Initially I just wanted to create a basic Design with Terminal.css. But then I randomly stumbled over the Hugo Theme Gallery and found some beautiful themes! So I chose to use Hugo Papermod and migrate the Website to Hugo 🤓. Since I don’t really know JavaScript, so it doesn’t matter for me that Hugo uses Go instead. I never used Go as a programming language, but it sounds great.
I’ll just ramble a bit now what I did to migrate my blog.
...</p></div><footer class=entry-footer><span title='2024-02-22 00:00:00 +0000 UTC'>2024-02-22</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Migrating from 11ty to Hugo" href=https://diecknet.de/en/2024/02/22/Migrating-from-11ty-to-Hugo/></a></article><article class=post-entry><header class=entry-header><h2>OneDrive for Business - Delegation to Manager after employee leaves company</h2></header><div class=entry-content><p>Normally when a user leaves the Company their OneDrive for Business site gets automatically delegated to their manager. That means the manager gets SharePoint Site Collection admin rights to the OneDrive site of their subordinate.
Checking and Changing Access Delegation ⚠️ Access Delegation is enabled as default. The setting can be found and changed here:
Go to More features in the new SharePoint admin center, and sign in with an account that has admin permissions for your organization. […] Under User profiles, select Open. Under My Site Settings, select Setup My Sites. Next to My Site Cleanup, make sure Enable access delegation is selected. (Source: https://learn.microsoft.com/en-us/sharepoint/retention-and-deletion#configure-automatic-access-delegation)
...</p></div><footer class=entry-footer><span title='2023-09-25 00:00:00 +0000 UTC'>2023-09-25</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to OneDrive for Business - Delegation to Manager after employee leaves company" href=https://diecknet.de/en/2023/09/25/onedrive-for-business-auto-delegation-to-manager/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-05-21-ConstrainedLanguageModePerGPO.jpg alt></figure><header class=entry-header><h2>Set PowerShell ConstrainedLanguage Mode per Group Policy</h2></header><div class=entry-content><p>PowerShell Language Modes are a way to restrict the functionality of PowerShell to increase the security of a system. Of course, this is only one small piece in a larger security strategy, so this alone is not sufficient protection for a system.
At the same time, it’s also a double-edged sword:
Advantage: we remove a powerful tool from potential attackers.
Disadvantage: We as administrators can no longer use PowerShell properly on a system either.
...</p></div><footer class=entry-footer><span title='2023-05-20 00:00:00 +0000 UTC'>2023-05-20</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Set PowerShell ConstrainedLanguage Mode per Group Policy" href=https://diecknet.de/en/2023/05/20/powershell-constrainedlanguage-mode-per-gpo/></a></article><article class=post-entry><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-05-16-ExchangeEAC-Error500.jpg alt></figure><header class=entry-header><h2>Exchange EAC stopped working after decomissioning all Mailbox Databases</h2></header><div class=entry-content><p>I had this weird issue with a Exchange Server environment: The company had an Exchange Server 2016 DAG and migrated all User Mailboxes to Exchange Online. I then installed a fresh Exchange Server 2019 for Recipient Management and SMTP-Relay. To use the Exchange Server 2019 Hybrid License, I did not create a Mailbox Database. I removed all remaining System Mailboxes and Arbitration Mailboxes from the Exchange 2016 Servers. I decomissioned the DAG and uninstalled Exchange from the old Servers.
...</p></div><footer class=entry-footer><span title='2023-05-16 00:00:00 +0000 UTC'>2023-05-16</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Exchange EAC stopped working after decomissioning all Mailbox Databases" href=https://diecknet.de/en/2023/05/16/exchange-eac-not-working-after-decomissioning-all-databases/></a></article><article class=post-entry><header class=entry-header><h2>Use ntfy.sh with Home Assistant</h2></header><div class=entry-content><p>Just a quick note if you want to use ntfy.sh with Home Assistant.
Setup I added the following section to my /config/configuration.yaml file:
1 2 3 4 5 6 7 8 9 10 11 12 13 shell_command: ntfy: > curl -X POST --url 'https://ntfy.sh/{{ topic }}' --data '{{ message }}' --header 'X-Title: {{ title }}' --header 'X-Tags: {{ tags }}' --header 'X-Priority: {{ priority }}' --header 'X-Delay: {{ delay }}' --header 'X-Actions: {{ actions }}' --header 'X-Click: {{ click }}' --header 'X-Icon: {{ icon }}' Usage To send send a notification, I use this YAML action in an Automation. It’s not necessary to provide all parameters. I ran with these four. As far as I know: Theoretically only topic is required by ntfy. But this simple shell_command action does not check if you set a topic.
...</p></div><footer class=entry-footer><span title='2023-02-12 00:00:00 +0000 UTC'>2023-02-12</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Use ntfy.sh with Home Assistant" href=https://diecknet.de/en/2023/02/12/ntfy-sh-with-homeassistant/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://diecknet.de/en/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>