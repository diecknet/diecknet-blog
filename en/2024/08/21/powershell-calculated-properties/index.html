<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Calculated Properties | diecknet</title>
<meta name=keywords content="powershell"><meta name=description content="If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called &ldquo;Calculated Properties&rdquo; and the cmdlet Select-Object can be used for this.
This can be used, for example, to
Rename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter."><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/2024/08/21/powershell-calculated-properties/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/><link rel=alternate hreflang=en href=https://diecknet.de/en/2024/08/21/powershell-calculated-properties/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Calculated Properties"><meta property="og:description" content="If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called &ldquo;Calculated Properties&rdquo; and the cmdlet Select-Object can be used for this.
This can be used, for example, to
Rename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter."><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/en/2024/08/21/powershell-calculated-properties/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-21T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-21T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerShell Calculated Properties"><meta name=twitter:description content="If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called &ldquo;Calculated Properties&rdquo; and the cmdlet Select-Object can be used for this.
This can be used, for example, to
Rename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/en/posts/"},{"@type":"ListItem","position":2,"name":"PowerShell Calculated Properties","item":"https://diecknet.de/en/2024/08/21/powershell-calculated-properties/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Calculated Properties","name":"PowerShell Calculated Properties","description":"If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called \u0026ldquo;Calculated Properties\u0026rdquo; and the cmdlet Select-Object can be used for this.\nThis can be used, for example, to\nRename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter.","keywords":["powershell"],"articleBody":"If you export data via PowerShell (for example to a CSV file via Export-CSV), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called ‚ÄúCalculated Properties‚Äù and the cmdlet Select-Object can be used for this.\nThis can be used, for example, to\nRename properties Format property values Create completely custom properties (e.g. by calling additional cmdlets) Output objects normally As a reminder: The selection of object properties with Select-Object is possible with the -Property parameter. However, the parameter usually does not have to be named explicitly.\n1 2 3 4 5 # List all Windows services; only show the Name and Status properties Get-Service | Select-Object -Property Name, Status # Alternatively, without explicitly writing -Property Get-Service | Select-Object Name, Status Rename properties To rename a property, we need to specify a hashtable instead of a simple parameter name. The hashtable has two entries:\nEntry Meaning Name (or Label) Name of the new property Expression Script block that creates the value For example, to create the property ‚ÄúService name‚Äù, which contains the name of a Windows service:\n1 2 3 4 5 6 7 8 Get-Service | Select-Object @{Name = \"Service name\"; Expression = { $_.Name } }, Status # Return Service name Status ---------- ------ [...] wuauserv Stopped [...] Normal parameters can also still be used. In this example, I also output the ‚ÄúStatus‚Äù property.\nFormat string properties / combine several properties But we can not only rename properties, we can also format them as we wish. For example, if I want a property to display both the display name and the internal name of a Windows service combined.\n1 2 3 4 5 6 7 8 Get-Service | Select-Object -Property @{Name = \"Service name\"; Expression = { \"$($_.DisplayName) ($($_.Name))\" } }, Status # Return: Service name Status ---------- ------ [...] Windows Update (wuauserv) Stopped [...] Include If-Condition It is also possible to integrate logic with an If statement. For example, in this case it is checked whether an Active Directory user is a member of a security group that corresponds to the wildcard pattern *VIP-User*. If this is the case, ‚ÄúYes‚Äù is written to the new property ‚ÄúVIP‚Äù. If not, ‚ÄúNo‚Äù is written instead.\n1 2 3 4 5 6 7 8 9 10 11 12 $User = Get-ADUser -Property MemberOf -Filter * $User | Select-Object -Property UserPrincipalName, @{Name = \"VIP\"; Expression = { if ($_.MemberOf -like \"*VIP-User*\") { \"Yes\" } else { \"No\" } } } # Return UserPrincipalName VIP ----------------- --- [...] testuser12345@demotenant.de No alexw@demotenant.de Yes andreas.dieckmann@demotenant.de No soenderzoichuenss@demotenant.de Yes [...] Using additional Cmdlets Apart from If statements, we can also use entire cmdlets to retrieve additional information. In this example, I first use Get-ADUser to list all users in an organizational unit in my Active Directory. Then I want to list the corresponding manager of the users.\n1 2 3 4 5 6 7 8 9 10 11 12 $User = Get-ADUser -Property Manager -Filter * -Searchbase \"OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de\" # Normal listing of the managers $User | Select-Object -Property Name, Manager # Return Name Manager ---- ------- Adam Steward CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en Charles Walker CN=Andreas Dieckmann,OU=User,OU=DemoTenant,DC=lan,DC=demotenant... Alex Wilber CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en Andreas Dieckmann S√∂nd√®r Z√∂ich√ºn√ü CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en By default, the ‚ÄúDistinguished Name‚Äù (DN) of the managers are listed here. Not particularly presentable. But we can execute Get-ADUser again in the expression for the calculated property to get information about each manager.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $User = Get-ADUser -Property Manager -Filter * -Searchbase \"OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de\" $User | Select-Object -Property Name, @{Name = \"Manager\"; Expression = { if ($_.Manager) { (Get-ADUser $_.Manager).Name } else { \"*nobody*\" } } } # Return Name Manager ---- ------- Adam Steward Charles Walker Charles Walker Andreas Dieckmann Alex Wilber Charles Walker Andreas Dieckmann *nobody* S√∂nd√®r Z√∂ich√ºn√ü Charles Walker In this example, I have also split the expression over several lines. That‚Äôs no problem, as it is clearly recognizable and enclosed in {curly brackets}.\nBy the way: If you are working in the console, you can press [Shift] + [Enter] to continue writing on a new line without already executing the command.\nConvert Array to String If you want to export an object property that consists of an array, the export usually does not work well. In the console, the values in the array property are enclosed in {curly brackets}. For example, I query all domain controllers in my Active Directory here and list the FSMO roles.\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,OperationMasterRoles # Return Name OperationMasterRoles ---- -------------------- DC2 {SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster...} In my console, the output was even truncated a bit, so I can‚Äôt even see all the roles. When I try to export such an array via Export-CSV, the result is completely unusable by default:\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,OperationMasterRoles | Export-Csv c:\\diecknet\\ad.csv Get-Content C:\\diecknet\\ad.csv # Return \"Name\",\"OperationMasterRoles\" \"DC2\",\"Microsoft.ActiveDirectory.Management.ADPropertyValueCollection\" The array was not converted to a string, but instead it says Microsoft.ActiveDirectory.Management.ADPropertyValueCollection.\nThe solution: Calculated Properties and the -join operator. In the following example, the entries in the array are merged into a string and separated by a space and a comma (, ).\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,@{Label=\"FSMO-Roles\";Expression={$_.OperationMasterRoles -join \", \"}} # Return Name FSMO-Roles ---- ----------- DC2 SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster Further tips and advice Here are a few general tips and advice on Calculated Properties.\nName VS. Label You may have noticed in the last example that I suddenly used @{Label= instead of @{Name= in the hashtable. In fact, Name and Label are interchangeable in this case. It works both ways, makes no difference.\n1 2 3 # Both variants create the same result Get-ADDomainController | Select-Object Name,@{Label=\"FSMO-Roles\"; Expression={$_.OperationMasterRoles -join \", \"}} Get-ADDomainController | Select-Object Name,@{Name=\"FSMO-Roles\"; Expression={$_.OperationMasterRoles -join \", \"}} Increase readability by using hashtable splatting In the section ‚ÄúUsing additional Cmdlets‚Äù I had already split the expression script block into several lines. But another way to increase readability is splatting. The cmdlet parameters are written to a hashtable.\nIn the following example, I have also named the hashtable variable for formatting $Format for the sake of simplicity. However, the name is of course freely configurable. In the hashtable there is the key Property, which in turn is an array. This array must contain the properties that should be output. I have used two more sub-hashtables here (calculated properties) and a string (normal property of the object).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $Format = @{ Property = ( @{ Name = \"Service name\" Expression = { $_.Name } }, @{ Name = \"Service status\" Expression = { $_.Status } }, # Important: Normal properties must be in quotes in the hashtable! \"StartType\" # Example for a normal property (not a Calculated Property) ) } Get-Service | Select-Object @Format # Return Service name Service status StartType ---------- ------------ --------- [...] wuauserv Running Manual [...] Short-form of the hashtable names are allowed Instead of the fully written out hashtable keys Name/Label and Expression, the shortened syntax N, L and E can also be used.\n1 2 3 4 5 # Normal spelling Get-Service | Select-Object -Property @{Name = \"Service name\"; Expression = { $_.Name } }, Status # Short spelling (both variants work: N=Name, L=Label) Get-Service | Select-Object -Property @{N = \"Service name\"; E = { $_.Name } }, Status Get-Service | Select-Object -Property @{L = \"Service name\"; E = { $_.Name } }, Status The label is actually optional Actually, the label/name is optional. It would also be possible to not use a hashtable, but instead simply specify a script block for the calculated property. In this case, however, the calculated property is given the ScriptBlock as its name, which looks strange. I would not recommend this.\n1 2 3 4 5 6 Get-ADDomainController | Select-Object Name,{$_.OperationMasterRoles -join \", \"} # Return Name $_.OperationMasterRoles -join \", \" ---- ---------------------------------- DC2 SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster ","wordCount":"1357","inLanguage":"en","datePublished":"2024-08-21T00:00:00Z","dateModified":"2024-08-21T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/en/2024/08/21/powershell-calculated-properties/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/2024/08/21/powershell-calculated-properties/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;¬ª&nbsp;<a href=https://diecknet.de/en/posts/>Posts</a></div><h1 class=post-title>PowerShell Calculated Properties</h1><div class=post-meta><span title='2024-08-21 00:00:00 +0000 UTC'>2024-08-21</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<ul class=i18n_list>üåç&nbsp;Dieser Inhalt ist auch verf√ºgbar auf:&nbsp;<li><a href=https://diecknet.de/de/2024/08/21/powershell-calculated-properties/>Deutsch</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/en/posts/2024/2024-08-21-PowerShell-Calculated-Properties.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#output-objects-normally aria-label="Output objects normally">Output objects normally</a></li><li><a href=#rename-properties aria-label="Rename properties">Rename properties</a></li><li><a href=#format-string-properties--combine-several-properties aria-label="Format string properties / combine several properties">Format string properties / combine several properties</a></li><li><a href=#include-if-condition aria-label="Include If-Condition">Include If-Condition</a></li><li><a href=#using-additional-cmdlets aria-label="Using additional Cmdlets">Using additional Cmdlets</a></li><li><a href=#convert-array-to-string aria-label="Convert Array to String">Convert Array to String</a></li><li><a href=#further-tips-and-advice aria-label="Further tips and advice">Further tips and advice</a><ul><li><a href=#name-vs-label aria-label="Name VS. Label">Name VS. Label</a></li><li><a href=#increase-readability-by-using-hashtable-splatting aria-label="Increase readability by using hashtable splatting">Increase readability by using hashtable splatting</a></li><li><a href=#short-form-of-the-hashtable-names-are-allowed aria-label="Short-form of the hashtable names are allowed">Short-form of the hashtable names are allowed</a></li><li><a href=#the-label-is-actually-optional aria-label="The label is actually optional">The label is actually optional</a></li></ul></li></ul></div></details></div><div class=post-content><p>If you export data via PowerShell (for example to a CSV file via <code>Export-CSV</code>), the original property names of the PowerShell objects are used. However, if these are not fully fitting for your purpose, you can also customize them. So-called &ldquo;Calculated Properties&rdquo; and the cmdlet <code>Select-Object</code> can be used for this.</p><p>This can be used, for example, to</p><ul><li>Rename properties</li><li>Format property values</li><li>Create completely custom properties (e.g. by calling additional cmdlets)</li></ul><h2 id=output-objects-normally>Output objects normally<a hidden class=anchor aria-hidden=true href=#output-objects-normally>#</a></h2><p>As a reminder: The selection of object properties with <code>Select-Object</code> is possible with the <code>-Property</code> parameter. However, the parameter usually does not have to be named explicitly.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># List all Windows services; only show the Name and Status properties</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Alternatively, without explicitly writing -Property</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> Name, Status
</span></span></code></pre></td></tr></table></div></div><h2 id=rename-properties>Rename properties<a hidden class=anchor aria-hidden=true href=#rename-properties>#</a></h2><p>To rename a property, we need to specify a hashtable instead of a simple parameter name.
The hashtable has two entries:</p><table><thead><tr><th>Entry</th><th>Meaning</th></tr></thead><tbody><tr><td><code>Name</code> (or <code>Label</code>)</td><td>Name of the new property</td></tr><tr><td><code>Expression</code></td><td>Script block that creates the value</td></tr></tbody></table><p>For example, to create the property &ldquo;Service name&rdquo;, which contains the name of a Windows service:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> @{Name = <span style=color:#fc6a5d>&#34;Service name&#34;</span>; Expression = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Service name     Status
</span></span><span style=display:flex><span>----------       ------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>wuauserv         Stopped
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><p>Normal parameters can also still be used. In this example, I also output the &ldquo;Status&rdquo; property.</p><h2 id=format-string-properties--combine-several-properties>Format string properties / combine several properties<a hidden class=anchor aria-hidden=true href=#format-string-properties--combine-several-properties>#</a></h2><p>But we can not only rename properties, we can also format them as we wish. For example, if I want a property to display both the display name and the internal name of a Windows service combined.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{Name = <span style=color:#fc6a5d>&#34;Service name&#34;</span>; Expression = { <span style=color:#fc6a5d>&#34;</span>$(<span style=color:#41a1c0>$_</span>.DisplayName)<span style=color:#fc6a5d> (</span>$(<span style=color:#41a1c0>$_</span>.Name)<span style=color:#fc6a5d>)&#34;</span> } }, Status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return:</span>
</span></span><span style=display:flex><span>Service name                 Status
</span></span><span style=display:flex><span>----------                   ------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>Windows Update (wuauserv)    Stopped
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h2 id=include-if-condition>Include If-Condition<a hidden class=anchor aria-hidden=true href=#include-if-condition>#</a></h2><p>It is also possible to integrate logic with an If statement. For example, in this case it is checked whether an Active Directory user is a member of a security group that corresponds to the wildcard pattern <code>*VIP-User*</code>. If this is the case, &ldquo;Yes&rdquo; is written to the new property &ldquo;VIP&rdquo;. If not, &ldquo;No&rdquo; is written instead.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property MemberOf -Filter *
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property UserPrincipalName, @{Name = <span style=color:#fc6a5d>&#34;VIP&#34;</span>; Expression = { <span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$_</span>.MemberOf -like <span style=color:#fc6a5d>&#34;*VIP-User*&#34;</span>) { <span style=color:#fc6a5d>&#34;Yes&#34;</span> } <span style=color:#fc5fa3>else</span> { <span style=color:#fc6a5d>&#34;No&#34;</span> } } }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>UserPrincipalName                 VIP
</span></span><span style=display:flex><span>-----------------                 ---
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>testuser12345<span style=color:#41a1c0>@demotenant</span>.de       No
</span></span><span style=display:flex><span>alexw<span style=color:#41a1c0>@demotenant</span>.de               Yes
</span></span><span style=display:flex><span>andreas.dieckmann<span style=color:#41a1c0>@demotenant</span>.de   No
</span></span><span style=display:flex><span>soenderzoichuenss<span style=color:#41a1c0>@demotenant</span>.de   Yes
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h2 id=using-additional-cmdlets>Using additional Cmdlets<a hidden class=anchor aria-hidden=true href=#using-additional-cmdlets>#</a></h2><p>Apart from If statements, we can also use entire cmdlets to retrieve additional information.
In this example, I first use <code>Get-ADUser</code> to list all users in an organizational unit in my Active Directory. Then I want to list the corresponding manager of the users.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property Manager -Filter * -Searchbase <span style=color:#fc6a5d>&#34;OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de&#34;</span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Normal listing of the managers</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, Manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Name              Manager
</span></span><span style=display:flex><span>----              -------
</span></span><span style=display:flex><span>Adam Steward      CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en
</span></span><span style=display:flex><span>Charles Walker    CN=Andreas Dieckmann,OU=User,OU=DemoTenant,DC=lan,DC=demotenant...
</span></span><span style=display:flex><span>Alex Wilber       CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en
</span></span><span style=display:flex><span>Andreas Dieckmann
</span></span><span style=display:flex><span>S√∂nd√®r Z√∂ich√ºn√ü   CN=Charles Walker,OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=en
</span></span></code></pre></td></tr></table></div></div><p>By default, the &ldquo;Distinguished Name&rdquo; (DN) of the managers are listed here. Not particularly presentable. But we can execute <code>Get-ADUser</code> again in the expression for the calculated property to get information about each manager.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$User</span> = <span style=color:#d0a8ff>Get-ADUser</span> -Property Manager -Filter * -Searchbase <span style=color:#fc6a5d>&#34;OU=User,OU=DemoTenant,DC=lan,DC=demotenant,DC=de&#34;</span>
</span></span><span style=display:flex><span><span style=color:#41a1c0>$User</span> | <span style=color:#d0a8ff>Select-Object</span> -Property Name, @{Name = <span style=color:#fc6a5d>&#34;Manager&#34;</span>; Expression = {
</span></span><span style=display:flex><span>        <span style=color:#fc5fa3>if</span> (<span style=color:#41a1c0>$_</span>.Manager) {
</span></span><span style=display:flex><span>            (<span style=color:#d0a8ff>Get-ADUser</span> <span style=color:#41a1c0>$_</span>.Manager).Name
</span></span><span style=display:flex><span>        } <span style=color:#fc5fa3>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#fc6a5d>&#34;*nobody*&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Name              Manager
</span></span><span style=display:flex><span>----              -------
</span></span><span style=display:flex><span>Adam Steward      Charles Walker
</span></span><span style=display:flex><span>Charles Walker    Andreas Dieckmann
</span></span><span style=display:flex><span>Alex Wilber       Charles Walker
</span></span><span style=display:flex><span>Andreas Dieckmann *nobody*
</span></span><span style=display:flex><span>S√∂nd√®r Z√∂ich√ºn√ü   Charles Walker
</span></span></code></pre></td></tr></table></div></div><p>In this example, I have also split the expression over several lines. That&rsquo;s no problem, as it is clearly recognizable and enclosed in <code>{</code>curly brackets<code>}</code>.</p><p>By the way: If you are working in the console, you can press <code>[Shift] + [Enter]</code> to continue writing on a new line without already executing the command.</p><h2 id=convert-array-to-string>Convert Array to String<a hidden class=anchor aria-hidden=true href=#convert-array-to-string>#</a></h2><p>If you want to export an object property that consists of an array, the export usually does not work well. In the console, the values in the array property are enclosed in <code>{</code>curly brackets<code>}</code>. For example, I query all domain controllers in my Active Directory here and list the FSMO roles.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,OperationMasterRoles
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Name OperationMasterRoles
</span></span><span style=display:flex><span>---- --------------------
</span></span><span style=display:flex><span>DC2  {SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster...}
</span></span></code></pre></td></tr></table></div></div><p>In my console, the output was even truncated a bit, so I can&rsquo;t even see all the roles. When I try to export such an array via <code>Export-CSV</code>, the result is completely unusable by default:</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,OperationMasterRoles | <span style=color:#d0a8ff>Export-Csv</span> c:\diecknet\ad.csv
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Content</span> C:\diecknet\ad.csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;Name&#34;</span>,<span style=color:#fc6a5d>&#34;OperationMasterRoles&#34;</span>
</span></span><span style=display:flex><span><span style=color:#fc6a5d>&#34;DC2&#34;</span>,<span style=color:#fc6a5d>&#34;Microsoft.ActiveDirectory.Management.ADPropertyValueCollection&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>The array was not converted to a string, but instead it says <code>Microsoft.ActiveDirectory.Management.ADPropertyValueCollection</code>.</p><p>The solution: Calculated Properties and the <code>-join</code> operator. In the following example, the entries in the array are merged into a string and separated by a space and a comma (<code>, </code>).</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Label=<span style=color:#fc6a5d>&#34;FSMO-Roles&#34;</span>;Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Name <span style=color:#d0a8ff>FSMO-Roles</span>
</span></span><span style=display:flex><span>---- -----------
</span></span><span style=display:flex><span>DC2  SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster
</span></span></code></pre></td></tr></table></div></div><h2 id=further-tips-and-advice>Further tips and advice<a hidden class=anchor aria-hidden=true href=#further-tips-and-advice>#</a></h2><p>Here are a few general tips and advice on Calculated Properties.</p><h3 id=name-vs-label>Name VS. Label<a hidden class=anchor aria-hidden=true href=#name-vs-label>#</a></h3><p>You may have noticed in the last example that I suddenly used <code>@{Label=</code> instead of <code>@{Name=</code> in the hashtable. In fact, <code>Name</code> and <code>Label</code> are interchangeable in this case. It works both ways, makes no difference.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Both variants create the same result</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Label=<span style=color:#fc6a5d>&#34;FSMO-Roles&#34;</span>; Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,@{Name=<span style=color:#fc6a5d>&#34;FSMO-Roles&#34;</span>; Expression={<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}}
</span></span></code></pre></td></tr></table></div></div><h3 id=increase-readability-by-using-hashtable-splatting>Increase readability by using hashtable splatting<a hidden class=anchor aria-hidden=true href=#increase-readability-by-using-hashtable-splatting>#</a></h3><p><a href=#using-additional-cmdlets>In the section &ldquo;Using additional Cmdlets&rdquo;</a> I had already split the expression script block into several lines. But another way to increase readability is splatting. The cmdlet parameters are written to a hashtable.</p><p>In the following example, I have also named the hashtable variable for formatting <code>$Format</code> for the sake of simplicity. However, the name is of course freely configurable. In the hashtable there is the key <code>Property</code>, which in turn is an array. This array must contain the properties that should be output. I have used two more sub-hashtables here (calculated properties) and a string (normal property of the object).</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#41a1c0>$Format</span> = @{
</span></span><span style=display:flex><span>    Property = (
</span></span><span style=display:flex><span>        @{
</span></span><span style=display:flex><span>            Name       = <span style=color:#fc6a5d>&#34;Service name&#34;</span>
</span></span><span style=display:flex><span>            Expression = { <span style=color:#41a1c0>$_</span>.Name }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        @{
</span></span><span style=display:flex><span>            Name       = <span style=color:#fc6a5d>&#34;Service status&#34;</span>
</span></span><span style=display:flex><span>            Expression = { <span style=color:#41a1c0>$_</span>.Status }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#6c7986># Important: Normal properties must be in quotes in the hashtable!</span>
</span></span><span style=display:flex><span>        <span style=color:#fc6a5d>&#34;StartType&#34;</span> <span style=color:#6c7986># Example for a normal property (not a Calculated Property)</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> <span style=color:#41a1c0>@Format</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Service name Service status StartType
</span></span><span style=display:flex><span>----------   ------------   ---------
</span></span><span style=display:flex><span>[...]
</span></span><span style=display:flex><span>wuauserv     Running        Manual
</span></span><span style=display:flex><span>[...]
</span></span></code></pre></td></tr></table></div></div><h3 id=short-form-of-the-hashtable-names-are-allowed>Short-form of the hashtable names are allowed<a hidden class=anchor aria-hidden=true href=#short-form-of-the-hashtable-names-are-allowed>#</a></h3><p>Instead of the fully written out hashtable keys <code>Name</code>/<code>Label</code> and <code>Expression</code>, the shortened syntax <code>N</code>, <code>L</code> and <code>E</code> can also be used.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#6c7986># Normal spelling</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{Name = <span style=color:#fc6a5d>&#34;Service name&#34;</span>; Expression = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span><span style=color:#6c7986># Short spelling (both variants work: N=Name, L=Label)</span>
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{N = <span style=color:#fc6a5d>&#34;Service name&#34;</span>; E = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span><span style=display:flex><span><span style=color:#d0a8ff>Get-Service</span> | <span style=color:#d0a8ff>Select-Object</span> -Property @{L = <span style=color:#fc6a5d>&#34;Service name&#34;</span>; E = { <span style=color:#41a1c0>$_</span>.Name } }, Status
</span></span></code></pre></td></tr></table></div></div><h3 id=the-label-is-actually-optional>The label is actually optional<a hidden class=anchor aria-hidden=true href=#the-label-is-actually-optional>#</a></h3><p>Actually, the label/name is optional. It would also be possible to <strong>not</strong> use a hashtable, but instead simply specify a script block for the calculated property. In this case, however, the calculated property is given the ScriptBlock as its name, which looks strange. I would not recommend this.</p><div class=highlight><div style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#fff;background-color:#1f1f24;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#d0a8ff>Get-ADDomainController</span> | <span style=color:#d0a8ff>Select-Object</span> Name,{<span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6c7986># Return</span>
</span></span><span style=display:flex><span>Name <span style=color:#41a1c0>$_</span>.OperationMasterRoles -join <span style=color:#fc6a5d>&#34;, &#34;</span>
</span></span><span style=display:flex><span>---- ----------------------------------
</span></span><span style=display:flex><span>DC2  SchemaMaster, DomainNamingMaster, PDCEmulator, RIDMaster, InfrastructureMaster
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/en/tags/powershell/>Powershell</a></li></ul><div class=share-buttons></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>