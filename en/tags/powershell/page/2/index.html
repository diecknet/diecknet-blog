<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Powershell | diecknet</title>
<meta name=keywords content><meta name=description content><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/tags/powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://diecknet.de/en/tags/powershell/feed.xml><link rel=alternate hreflang=de href=https://diecknet.de/de/tags/powershell/><link rel=alternate hreflang=en href=https://diecknet.de/en/tags/powershell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Powershell"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://diecknet.de/en/tags/powershell/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Powershell"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/tags/powershell/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/tags/powershell/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/services/ title=Services><span>Services</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/en/tags/>Tags</a></div><h1>Powershell</h1></header><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-11-12_bookings-permissions.csv.png alt></figure><header class=entry-header><h2>List all Microsoft Booking Calendars</h2></header><div class=entry-content><p>If you’re using Microsoft Booking in your Microsoft 365 Tenant, you might want to list all of the Booking calendars. Booking uses Exchange Online Mailboxes in the background. Every Booking Calendar has a corresponding Mailbox of the type “SchedulingMailbox”. If an user gets assigned “Administrator” for a Booking Calendar, they get “FullAccess” permissions for the Scheduling Mailbox.
List all Booking Calendars with permission I wrote a PowerShell script to list all the Booking Mailboxes with the users that have access.
...</p></div><footer class=entry-footer><span title='2021-11-12 00:00:00 +0000 UTC'>2021-11-12</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to List all Microsoft Booking Calendars" href=https://diecknet.de/en/2021/11/12/List-All-Microsoft-Booking-Mailboxes/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-11-04_Get-AdditionalMailbox-AutoExpandingArchivesInfo.png alt></figure><header class=entry-header><h2>Verify Auto-Expanding Archives in Exchange Online</h2></header><div class=entry-content><p>If you have Auto-Expanding Archives for Exchange Online Mailboxes enabled, you might want to find out, if it actually provisions additional storage.
In the Exchange Admin Center (EAC), open the info pane of the user’s mailbox. Click on “Manage mailbox archive”.
An Auto-Expanding Archive provisions more Archive storage space, if needed. Default Archives have 100 GB of storage available. If the archive is already bigger than 100 GB, we must have additional storage.
...</p></div><footer class=entry-footer><span title='2021-11-04 00:00:00 +0000 UTC'>2021-11-04</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Verify Auto-Expanding Archives in Exchange Online" href=https://diecknet.de/en/2021/11/04/Exchange-Online-Auto-Expanding-Archives/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Using PowerShell Regular Expressions to match against filenames</h2></header><div class=entry-content><p>A short example for PowerShell Regular Expressions.
Scenario: Match filenames like ID1234_MyDocumentXYZ.pdf.lnk. We want go get the number after ID and the rest of the filename between the underscore _ and the file extension .lnk.
1 2 3 4 5 $oldLink = "ID1337_MyDocumentXYZ.pdf.lnk" if($oldLink -match 'ID(?&lt;id>\d+)_(?&lt;actualFilename>.+)\.lnk$') { Write-Output "ID: $($Matches.id)" Write-Output "Actual Filename: $($Matches.actualFilename)" } (?&lt;id>\d+) is a named regex capture group (initialized by ?&lt;groupname>). The group matches any numeric character (\d). The + afterwards is a multiplier, so we match against any amount of numeric characters. Since the Regular Expression matches successfully, the result is $true and we invoke the if section.
...</p></div><footer class=entry-footer><span title='2021-10-25 00:00:00 +0000 UTC'>2021-10-25</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Using PowerShell Regular Expressions to match against filenames" href=https://diecknet.de/en/2021/10/25/PowerShell-Regular-Expression/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-10-13_TaskScheduler_PowerShell_Script.png alt></figure><header class=entry-header><h2>Run PowerShell Script with Windows Task Scheduler</h2></header><div class=entry-content><p>More ore less quick note for myself - on how to run a PowerShell Script using Windows Task Scheduler.
Open Task Scheduler A quick way to open Task Scheduler: [WIN] + R, then run taskschd.msc.
Create New Task Open “Task Scheduler Library” → “Create New Task”. Set all the self-explanatory options like Name, Description, User Account, Triggers, etc.
Set Action Setting Value Action Start a program Program/script powershell.exe Add arguments (optional) -file "C:\Path\Script.ps1"</p></div><footer class=entry-footer><span title='2021-10-13 00:00:00 +0000 UTC'>2021-10-13</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Run PowerShell Script with Windows Task Scheduler" href=https://diecknet.de/en/2021/10/13/PowerShell-Task-Scheduler/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-07-09_ConvertSPOSiteTimezone.png alt></figure><header class=entry-header><h2>Retrieve the Timezone of a Sharepoint Online Site using PowerShell</h2></header><div class=entry-content><p>I’ve been looking for a way to retrieve the Timezone setting of a Sharepoint Online Site via PowerShell. Apparently there is not much good info publicly available. I looked for a way to use with the standard SPO PowerShell module named Microsoft.Online.SharePoint.PowerShell.
There are some infos online about using the PNPOnline Module, but that was not practical in my case. There are even some really annoying articles out, that claim to to provide a PowerShell way. But instead of retrieving the actual Timezone setting of a SPO site, they retrieve all available Timezones and then overwrite the current timezone with a valid one. Worst thing: They import Sharepoint .dll files, use plaintext authentication and use Client Context Object/CSOM (Microsoft.SharePoint.Client.ClientContext). 😵 Oof.
...</p></div><footer class=entry-footer><span title='2021-07-09 00:00:00 +0000 UTC'>2021-07-09</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Retrieve the Timezone of a Sharepoint Online Site using PowerShell" href=https://diecknet.de/en/2021/07/09/Sharepoint-Online-Timezones-by-PowerShell/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2021/2021-06-27-NAT-Gateway-Azure-Virtual-Desktop.png alt></figure><header class=entry-header><h2>Deploy an Azure NAT-Gateway for Azure Virtual Desktop by PowerShell</h2></header><div class=entry-content><p>I created a PowerShell script to automatically deploy an Azure NAT-Gateway into an Azure Virtual Desktop environment. That’s useful, if you to need one static IP-Address for your AVD machines. I created the script as a submission for the Nerdio Hackathon 2021. My first Hackathon attendance :^).
Update 2021-10-05 - I actually won first place, but apparently not many people participated in the contest. The Nerdio team are a bit disappointed, so they didn’t publish any announcements. Anyway I got a 1000 USD Amazon Gift Card 🤩.
...</p></div><footer class=entry-footer><span title='2021-06-27 00:00:00 +0000 UTC'>2021-06-27</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Deploy an Azure NAT-Gateway for Azure Virtual Desktop by PowerShell" href=https://diecknet.de/en/2021/06/27/Deploy-Azure-NAT-Gateway-Azure-Virtual-Desktop/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2020/2020-05-20_CheckProfileStoragePermissions.png alt></figure><header class=entry-header><h2>Check NTFS Permissions using Powershell</h2></header><div class=entry-content><p>So I needed a quick way to check a few folders for correct permissions. We had Windows Virtual Desktop/FSLogix user profile containers in an Azure Files share. Some of these profile folders had wrong permissions.
The correct storage permissions are:
User Account Folder Permissions Users This Folder Only Modify Creator / Owner Subfolders and Files Only Modify Administrator (optional) This Folder, Subfolders, and Files Full Control Official FSLogix documentation: Configure storage permissions for use with Profile Containers and Office Containers
...</p></div><footer class=entry-footer><span title='2020-05-20 00:00:00 +0000 UTC'>2020-05-20</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Check NTFS Permissions using Powershell" href=https://diecknet.de/en/2020/05/20/Check-NTFS-Permissions-Powershell/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2020/2020-01-25_MSExchWhenMailboxCreated_PowerShell.png alt></figure><header class=entry-header><h2>Exchange - When was that mailbox REALLY created?</h2></header><div class=entry-content><p>If you’re wondering when an Exchange mailbox got created, you will most likely stumble over the Active Directory user attribute MSExchWhenMailboxCreated. You can get the value using PowerShell or ADUC with advanced features enabled.
1 Get-ADUser -Properties MSExchMaiboxWhenCreated MSExchWhenMailboxCreated contains not the full truth That could almost be the end of the story. BUT that attribute is not what you might think. The attribute gets only propagated the FIRST time the user gets a mailbox. If that users mailbox was disabled and then recreated later, the timestamp of the first mailbox creation retains.
...</p></div><footer class=entry-footer><span title='2020-01-25 00:00:00 +0000 UTC'>2020-01-25</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Exchange - When was that mailbox REALLY created?" href=https://diecknet.de/en/2020/01/25/Exchange-Mailbox-Creation-Date/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2020-01-15_17_44_53-_CalendarPermission-Error-Outlook.png alt></figure><header class=entry-header><h2>Exchange Room Mailbox - Set Permissions</h2></header><div class=entry-content><p>By default, the “Calendar” folder in Exchange 2013 Room Mailboxes has the “LimitedDetails” permission for the “Standard” security principal. Therefore, if no other permissions are configured, users cannot view details for appointments in this room. For better usability in Outlook, the “Reviewer” permission is more suitable. This allows items to be listed and details to be displayed. If required, the CalendarProcessing can be adjusted so that details such as the description and subject of the appointment are not saved in the room mailbox. Whether all this makes sense always depends on the environment.
...</p></div><footer class=entry-footer><span title='2020-01-15 00:00:00 +0000 UTC'>2020-01-15</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann</footer><a class=entry-link aria-label="post link to Exchange Room Mailbox - Set Permissions" href=https://diecknet.de/en/2020/01/15/Exchange-Room-Mailbox-Standard-Permissions/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://diecknet.de/en/tags/powershell/>«&nbsp;Prev&nbsp;</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>