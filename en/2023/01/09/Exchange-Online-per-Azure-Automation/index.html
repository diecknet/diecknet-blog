<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automate Exchange Online with Azure Automation in 2023 | diecknet</title>
<meta name=keywords content="microsoft365,office365,exchangeonline,powershell,exo,azure,azureautomation"><meta name=description content="I&rsquo;ll try to keep it short: If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (as of early 2023).
Legacy approach In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don&rsquo;t have to say anything about plaintext passwords, do I?"><meta name=author content="Andreas Dieckmann"><link rel=canonical href=https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/><link crossorigin=anonymous href=/assets/css/stylesheet.75a517428f403193483801122d6350f6956c3bb6bf5c6504311f8c24e6bab3e7.css integrity="sha256-daUXQo9AMZNIOAESLWNQ9pVsO7a/XGUEMR+MJOa6s+c=" rel="preload stylesheet" as=style><link rel=icon href=https://diecknet.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://diecknet.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://diecknet.de/favicon-32x32.png><link rel=apple-touch-icon href=https://diecknet.de/apple-touch-icon.png><link rel=mask-icon href=https://diecknet.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=de href=https://diecknet.de/de/2023/01/09/Exchange-Online-per-Azure-Automation/><link rel=alternate hreflang=en href=https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Automate Exchange Online with Azure Automation in 2023"><meta property="og:description" content="I&rsquo;ll try to keep it short: If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (as of early 2023).
Legacy approach In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don&rsquo;t have to say anything about plaintext passwords, do I?"><meta property="og:type" content="article"><meta property="og:url" content="https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/"><meta property="og:image" content="https://diecknet.de/images/2023/2023-AA-EXO.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-09T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-09T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://diecknet.de/images/2023/2023-AA-EXO.jpg"><meta name=twitter:title content="Automate Exchange Online with Azure Automation in 2023"><meta name=twitter:description content="I&rsquo;ll try to keep it short: If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (as of early 2023).
Legacy approach In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don&rsquo;t have to say anything about plaintext passwords, do I?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://diecknet.de/en/posts/"},{"@type":"ListItem","position":2,"name":"Automate Exchange Online with Azure Automation in 2023","item":"https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automate Exchange Online with Azure Automation in 2023","name":"Automate Exchange Online with Azure Automation in 2023","description":"I\u0026rsquo;ll try to keep it short: If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (as of early 2023).\nLegacy approach In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don\u0026rsquo;t have to say anything about plaintext passwords, do I?","keywords":["microsoft365","office365","exchangeonline","powershell","exo","azure","azureautomation"],"articleBody":"I’ll try to keep it short: If you want to manage Exchange Online via Azure Automation, Managed Identities is what you should use (as of early 2023).\nLegacy approach In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don’t have to say anything about plaintext passwords, do I? You could still use App Registrations in Azure AD, but if you really just want to automate some Exchange settings via Azure Automation, it’s not really necessary.\nTL;DR Managed Identities + Exchange Online PowerShell A System Assigned Managed Identity assigns an identity to an Azure Resource. This identity can be assigned rights, e.g. for the administration of Exchange Online or specific Azure Resources. The management of the identity is done automatically, so there is no need to change a password regularly or anything like that. And if the associated resource (in this case the Azure Automation account) is deleted, the System Assigned Managed Identity is automatically deleted as well. The Exchange Online PowerShell module supports Managed Identities for authentication starting with version 3.\nHowto Video (German) I created a German Video showing how Exchange Online can be controlled via Azure Automation. This involves using a System Assigned Managed Identity for the Azure Automation account and assigning Exchange management rights to this identity. You can probably use the automatic translated Subtitles on YouTube, if you don’t speak German.\nFurther links The official Microsoft documentation for this can be found here: https://learn.microsoft.com/en-us/powershell/exchange/connect-exo-powershell-managed-identity?view=exchange-ps\n","wordCount":"261","inLanguage":"en","image":"https://diecknet.de/images/2023/2023-AA-EXO.jpg","datePublished":"2023-01-09T00:00:00Z","dateModified":"2023-01-09T00:00:00Z","author":{"@type":"Person","name":"Andreas Dieckmann"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/"},"publisher":{"@type":"Organization","name":"diecknet","logo":{"@type":"ImageObject","url":"https://diecknet.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://diecknet.de/en/ accesskey=h title="diecknet (Alt + H)">diecknet</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://diecknet.de/de/2023/01/09/Exchange-Online-per-Azure-Automation/ title=Deutsch aria-label=Deutsch>Deutsch</a></li><li><a href=https://diecknet.de/en/2023/01/09/Exchange-Online-per-Azure-Automation/ title=English aria-label=English><b>English</b></a></li></ul></div></div><ul id=menu><li><a href=https://diecknet.de/en/ title=Home><span>Home</span></a></li><li><a href=https://diecknet.de/en/about/ title=About><span>About</span></a></li><li><a href=https://diecknet.de/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://diecknet.de/en/archive/ title=Archive><span>Archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://diecknet.de/en/>Home</a>&nbsp;»&nbsp;<a href=https://diecknet.de/en/posts/>Posts</a></div><h1 class=post-title>Automate Exchange Online with Azure Automation in 2023</h1><div class=post-meta><span title='2023-01-09 00:00:00 +0000 UTC'>2023-01-09</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Andreas Dieckmann&nbsp;|&nbsp;<ul class=i18n_list>🌍&nbsp;Dieser Inhalt ist auch verfügbar auf:&nbsp;<li><a href=https://diecknet.de/de/2023/01/09/Exchange-Online-per-Azure-Automation/>Deutsch</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/diecknet/diecknet-blog/tree/main/content/en/posts/2023/2023-01-09-Exchange-Online-per-Azure-Automation.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><figure class=entry-cover><img loading=lazy src=https://diecknet.de/images/2023/2023-AA-EXO.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#legacy-approach aria-label="Legacy approach">Legacy approach</a></li><li><a href=#tldr-managed-identities--exchange-online-powershell aria-label="TL;DR Managed Identities + Exchange Online PowerShell">TL;DR Managed Identities + Exchange Online PowerShell</a></li><li><a href=#howto-video-german aria-label="Howto Video (German)">Howto Video (German)</a></li><li><a href=#further-links aria-label="Further links">Further links</a></li></ul></div></details></div><div class=post-content><p>I&rsquo;ll try to keep it short:
If you want to manage Exchange Online via Azure Automation, <strong>Managed Identities</strong> is what you should use (as of early 2023).</p><h2 id=legacy-approach>Legacy approach<a hidden class=anchor aria-hidden=true href=#legacy-approach>#</a></h2><p>In the past, RunAs Accounts or Plaintext Credentials (🤢) were also commonly used for this purpose, but this is now considered deprecated. RunAs accounts will be discontinued by fall 2023. And I don&rsquo;t have to say anything about plaintext passwords, do I?
You could still use App Registrations in Azure AD, but if you really just want to automate some Exchange settings via Azure Automation, it&rsquo;s not really necessary.</p><h2 id=tldr-managed-identities--exchange-online-powershell>TL;DR Managed Identities + Exchange Online PowerShell<a hidden class=anchor aria-hidden=true href=#tldr-managed-identities--exchange-online-powershell>#</a></h2><p>A <strong>System Assigned Managed Identity</strong> assigns an <em>identity</em> to an Azure Resource. This identity can be assigned rights, e.g. for the administration of Exchange Online or specific Azure Resources. The management of the identity is done automatically, so there is no need to change a password regularly or anything like that. And if the associated resource (in this case the Azure Automation account) is deleted, the System Assigned Managed Identity is automatically deleted as well.
The Exchange Online PowerShell module supports Managed Identities for authentication starting with version 3.</p><h2 id=howto-video-german>Howto Video (German)<a hidden class=anchor aria-hidden=true href=#howto-video-german>#</a></h2><p>I created a <a href="https://www.youtube.com/watch?v=unXf7ma1NR4" target=_blank>German Video</a> showing how Exchange Online can be controlled via Azure Automation. This involves using a System Assigned Managed Identity for the Azure Automation account and assigning Exchange management rights to this identity. You can probably use the automatic translated Subtitles on YouTube, if you don&rsquo;t speak German.</p><p><a href="https://www.youtube.com/watch?v=unXf7ma1NR4" target=_blank><img loading=lazy src=/images/2023/2023-01-09_Azure_Automation_Exchange_online_thumbnail.png alt="German Video: Manage Exchange Online via Azure Automation (YouTube)" title="German Video: Manage Exchange Online via Azure Automation (YouTube)"></a></p><h2 id=further-links>Further links<a hidden class=anchor aria-hidden=true href=#further-links>#</a></h2><p>The official Microsoft documentation for this can be found here: <a href="https://learn.microsoft.com/en-us/powershell/exchange/connect-exo-powershell-managed-identity?view=exchange-ps" target=_blank>https://learn.microsoft.com/en-us/powershell/exchange/connect-exo-powershell-managed-identity?view=exchange-ps</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://diecknet.de/en/tags/microsoft365/>Microsoft365</a></li><li><a href=https://diecknet.de/en/tags/office365/>Office365</a></li><li><a href=https://diecknet.de/en/tags/exchangeonline/>Exchangeonline</a></li><li><a href=https://diecknet.de/en/tags/powershell/>Powershell</a></li><li><a href=https://diecknet.de/en/tags/exo/>Exo</a></li><li><a href=https://diecknet.de/en/tags/azure/>Azure</a></li><li><a href=https://diecknet.de/en/tags/azureautomation/>Azureautomation</a></li></ul><div class=share-buttons></div></footer><script src=https://giscus.diecknet.de/client.js data-repo=diecknet/diecknet-blog data-repo-id="MDEwOlJlcG9zaXRvcnkyMDkzNDUzNzM=" data-category="Blog Discussions" data-category-id=MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyNjMwOTY0 data-mapping=specific data-term=Exchange-Online-per-Azure-Automation data-strict=1 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://diecknet.de/en/>diecknet</a></span>
&nbsp;|&nbsp;
<span><a href=https://diecknet.de/en/legal/>Imprint</a>
</span>&nbsp;|&nbsp;<span>
<a href=https://diecknet.de/en/privacy/>Privacy</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script type=text/javascript>var _paq=window._paq||[];_paq.push(["disableCookies"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){t="//nc.diecknet.de/mt/",_paq.push(["setTrackerUrl",t+"mdata"]),_paq.push(["setSiteId","1"]);var t,n=document,e=n.createElement("script"),s=n.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.defer=!0,e.src=t+"m.js",s.parentNode.insertBefore(e,s)}()</script><noscript><p><img src="https://nc.diecknet.de/mt/mdata?idsite=1&amp;rec=1" style=border:0 alt></p></noscript></body></html>